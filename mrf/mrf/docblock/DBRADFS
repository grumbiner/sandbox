C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C                .      .    .                                       .
C SUBPROGRAM:    RADFS       INTERFACE BETWIXT GLOOPR AND GFDL RADI8
C   PRGMMR: KENNETH CAMPANA  ORG: W/NMC23    DATE: 89-07-07
C           BERT B. KATZ     ORG: W/NMC23    DATE: 91-03-15
C
C ABSTRACT: PREPARES DATA FOR -SW- AND -LW- RADIATION CALCULATIONS.
C   E.G. FLIP VERTICAL COORDINATE (NMC K=1 IS LOWEST LAYER,WHILE FOR
C   GFDL K=1 IS TOPMOST LAYER),COMPUTE SFC ALBEDO OVER OPEN WATER,
C   PUT CLOUD DATA IN PROPER LOCATIONS,ETC..
C   RADFS THEN CALLS
C   SWR89  (-SW- CALCULATIONS) AND LWR88  (-LW- COMPUTATIONS).
C   FINALLY,RADIATIVE HEATING RATES AND BOUNDARY FLUXES ARE RETURNED
C   TO SUBROUTINE GLOOPR, ITSELF CALLED FROM THE MRF.
C
C PROGRAM HISTORY LOG:
C   84-01-01  GFDL
C   89-07-07  KENNETH CAMPANA - EXTENSIVE REVISIONS FOR
C                               PLUG COMPATIBILITY....
C   89-07-07  BERT KATZ (CENTEL CORP) - REVISION OF SEVERAL
C                               SECTIONS WITH VECTOR CODING.
C   89-10-19  KENNETH CAMPANA - USE-SLI-MASK IN PLACE OF TSEA TO
C                               DETERMINE OPEN WATER(SFC ALBEDO CALC)
C   89-11-29  KENNETH CAMPANA - INTERFACE WITH NEWEST VERSION OF GFDL
C                               LW RADIATION AND DEVECTORIZE FOR
C                               BENCHMARK.
C   91-03-15  BERT KATZ (CENTEL CORP) - MODIFIED FOR USE WITHIN
C                               THE MRF. MOST ASTRONOMICAL
C                               CALCULATIONS REMOVED AND ARE NOW
C                               IN THE NEW RADIATION DRIVER,
C                               SUBROUTINE GLOOPR. OTHER
C                               ONE-TIME CALCULATIONS MOVED
C                               TO SUBROUTINE GRADFS.
C                               ALL CODES AGAIN VECTORIZED,
C                               THIS TIME FOR THE CRAY Y-MP.
C
C USAGE:    CALL RADFS (QS,PP,QQH2O,TT,O3QO3,TSFC,SLMSK,ALBEDO,
C                       XLAT,XLON,COSZN,CLDS,CEMIS,MTOP,MBOT,CZMN,
C                       IBEG,IPTS,DTRAD,LAT,
C                       KDAPRX,KO3,KCZ,KEMIS,KALB,
C                       KCIRC,KMSK,ICHECK,IPT,JPOINT,
C                       SLMRF,SLYMRF,ITIMLW,ITIMSW,SWH,HLW,
C                       FLWUP,FSWUP,FSWDN,FSWDNS,FSWUPS,FLWDNS,FLWUPS)
C
C   INPUT ARGUMENT LIST:
C     QS      - SFC PRESSURE (CB)
C     PP      - LAYER PRESSURE (CB)-LYR 1 IS BOTTOMMOST LYR
C     QQH2O   - LAYER MOISTURE (G/G)
C     TT      - LAYER TEMPERATURE (DEG K)
C     TSFC    - SURFACE TEMPERATURE(DEG K)
C     SLMSK   - SEA(0),LAND(1),SEAICE(2) MASK
C     ALBEDO  - SFC ALBEDO(FRACTION) - ITS ASSUMED THAT SNOW
C               EFFECTS ON ALBEDO ARE ALREADY INCLUDED.
C     XLAT    - LATITUDE (DEG) FOR EACH POINT (S.HEMIS.=NEG)
C     XLON    - LONGITUDE(DEG) FOR EACH POINT
C     CLDS    - CLD FRACTION H,M,L (3 CLD TYPES)
C     MTOP    - CLD TOP(MODEL LYR)=H,M,L
C     MBOT    - CLD BOT(MODEL LYR)=H,M,L
C     IBEG    - STARTING POINT IN DOMAIN DEPENDENT INPUT, OUTPUT ARRAYS.
C     IPTS    - NUMBER OF POINTS FOR WHICH RADIATON IS TO BE PERFORMED.
C     LAT     - GRID ROW NUMBER
C     KDAPRX  - SW DIURNAL APPROX(=1),,=0 MEANS INSTANTANEOUS SW.
C     KO3     - O3 SWITCH(=1,USE INPUT QO3-=0,USE CLIMO INTERP)
C     KCZ     - COSZRO SWITCH (1,USE INPUT-=0,COMPUTE HEREIN-MRF)
C     KEMIS   - HI CLD EMISS SWTCH(=1,USE INPUT-=0,USE DEFAULT)
C     KALB    - OPEN WATER SFCALB(=1,USE INPUT-=0,USE PAYNE DATA)
C     KCIRC   - VALUE OF 1-5 REFERS TO MCCLATCHEY PROFILE OF O3
C               (1=TROPICAL)
C     KMSK    - 0=OPEN WATER, 1=LAND, 2=SEA ICE
C     IPT     - LONGITUDINAL INDEX OF DEBUG POINT. 0=NO DEBUG OUTPUT
C     JPOINT  - LATITUDINAL INDEX OF DEBUG POINT. 0=NO DEBUG OUTPUT
C     SLMRF   - SIGMA VALES AT INTERFACES
C     SLYMRF  - SIGMA VALES AT LAYERS
C     ITIMLW  - 1=PERFORM LONG WAVE CALCULATIONS, 0=DON'T DO LONG WAVE
C     ITIMSW  - 1=PERFORM SHORT WAVE CALCULATIONS, 0=DON'T DO SHORT WAVE
C    POSSIBLE INPUT:
C     O3QO3   - LAYER OZONE (G/G) - USED IF KO3=1
C     COSZN   - COSINE ZENITH ANGLE - USED IF KCZ=1
C     CEMIS   - HI CLD EMISSIVITY - USED IF KEMIS=1
C     CZMN    - LATITUDINAL DAYLIGHT MEAN OF COSINE ZENITH ANGLE-
C               USED IF KDAPRX=1.
C     DTRAD   - RADIATIVE TIMESTEP=NUM HRS BETWEEN CALLS TO SWR89.
C               NEEDED FOR CALL TO ZENITH - IF KCZ=0
C
C   OUTPUT ARGUMENT LIST:
C     SWH     - LAYER SW HEATING RATES (DEG/SEC)
C     HLW     - LAYER LW HEATING RATES (DEG/SEC)
C     FLWUP   - T.O.A. UPWARD LW FLUX (W/M2)
C     FSWUP   - T.O.A. UPWARD SW FLUX (W/M2)
C     FSWDN   - T.O.A. DNWARD SW FLUX (W/M2)
C     FSWDNS  - SFC    DNWARD SW FLUX (W/M2)
C     FSWUPS  - SFC    UPWARD SW FLUX (W/M2)
C     FLWDNS  - SFC    DNWARD LW FLUX (W/M2)
C     FLWUPS  - SFC    UPWARD LW FLUX (W/M2)
C
C   OUTPUT FILES:
C     OUTPUT   - PRINT FILE.
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN 200.
C   MACHINE:  CYBER 205.
C
C$$$
