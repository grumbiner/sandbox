C$$$     SUBPROGRAM DOCUMENTATION BLOCK
C
C SUBPROGRAM: MSTADB       COMPUTE MOIST ADIABATIC CLOUD SOUNDINGS
C
C   AUTHOR: N PHILLIPS    DATE: NOV 1983
C
C ABSTRACT: ATMOSPHERIC COLUMNS OF TEMPERATURE AND SPECIFIC HUMIDITY
C   ARE EXAMINED BY THIS ROUTINE FOR CONDITIONAL INSTABILITY.
C   THE TEST PARCEL IS CHOSEN FROM THE LAYER BETWEEN LAYERS K1 AND K2
C   THAT HAS THE WARMEST POTENTIAL WET-BULB TEMPERATURE.
C   EXCESS CLOUD TEMPERATURES AND SPECIFIC HUMIDITIES ARE RETURNED
C   WHERE THE LIFTED PARCEL IS FOUND TO BE BUOYANT.
C   FAST INLINABLE FUNCTIONS ARE INVOKED TO COMPUTE
C   DEWPOINT AND LIFTING CONDENSATION LEVEL TEMPERATURES,
C   EQUIVALENT POTENTIAL TEMPERATURE AT THE LCL, AND
C   TEMPERATURE AND SPECIFIC HUMIDITY OF THE ASCENDING PARCEL.
C
C PROGRAM HISTORY LOG:
C   83-11     PHILLIPS
C   91-05-07  IREDELL             ARGUMENTS CHANGED, CODE TIDIED
C
C USAGE:    CALL MSTADB(IM,KM,K1,K2,SL,SLK,PS,TENV,QENV,
C    &                  KLCL,KBOT,KTOP,TCLD,QCLD)
C
C   INPUT ARGUMENT LIST:
C     IM       - INTEGER NUMBER OF ATMOSPHERIC COLUMNS
C     KM       - INTEGER NUMBER OF SIGMA LEVELS IN A COLUMN
C     K1       - INTEGER LOWEST LEVEL FROM WHICH A PARCEL CAN ORIGINATE
C     K2       - INTEGER HIGHEST LEVEL FROM WHICH A PARCEL CAN ORIGINATE
C     SL       - REAL (KM) SIGMA VALUES
C     SLK      - REAL (KM) SIGMA VALUES TO THE KAPPA
C     PS       - REAL (IM) SURFACE PRESSURE IN KILOPASCALS (CB)
C     TENV     - REAL (IM,KM) ENVIRONMENT TEMPERATURES
C     QENV     - REAL (IM,KM) ENVIRONMENT SPECIFIC HUMIDITIES
C
C   OUTPUT ARGUMENT LIST:
C     KLCL     - INTEGER (IM) LEVEL JUST ABOVE LCL (KM+1 IF NO LCL)
C     KBOT     - INTEGER (IM) LEVEL JUST ABOVE CLOUD BOTTOM
C     KTOP     - INTEGER (IM) LEVEL JUST BELOW CLOUD TOP
C              - NOTE THAT KBOT(I) GT KTOP(I) IF NO CLOUD.
C     TCLD     - REAL (IM,KM) OF EXCESS CLOUD TEMPERATURES.
C                (PARCEL T MINUS ENVIRON T, OR 0. WHERE NO CLOUD)
C     QCLD     - REAL (IM,KM) OF EXCESS CLOUD SPECIFIC HUMIDITIES.
C                (PARCEL Q MINUS ENVIRON Q, OR 0. WHERE NO CLOUD)
C
C SUBPROGRAMS CALLED:
C     FPKAP    - FUNCTION TO COMPUTE PRESSURE TO THE KAPPA POWER
C     FTDP     - FUNCTION TO COMPUTE DEWPOINT TEMPERATURE
C     FTLCL    - FUNCTION TO COMPUTE LCL TEMPERATURE
C     FTHE     - FUNCTION TO COMPUTE EQUIVALENT POTENTIAL TEMPERATURE
C     FTMA     - FUNCTION TO COMPUTE PARCEL TEMPERATURE AND HUMIDITY
C
C REMARKS: ALL FUNCTIONS ARE INLINED BY FPP.
C          NONSTANDARD AUTOMATIC ARRAYS ARE USED.
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN 77.
C   MACHINE:  CRAY.
C
C$$$
