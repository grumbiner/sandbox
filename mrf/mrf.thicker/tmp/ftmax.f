C-----------------------------------------------------------------------
CFPP$ NOCONCUR R
CFPP$ EXPAND(FTMA,FTMAXG)
      FUNCTION FTMAX(THE,PK,QMA)
C$$$     SUBPROGRAM DOCUMENTATION BLOCK
C
C SUBPROGRAM: FTMAX        COMPUTE MOIST ADIABAT TEMPERATURE
C   AUTHOR: N PHILLIPS            W/NMC2X2   DATE: 30 DEC 82
C
C ABSTRACT: EXACTLY COMPUTE TEMPERATURE AND HUMIDITY OF A PARCEL
C   LIFTED UP A MOIST ADIABAT FROM EQUIVALENT POTENTIAL TEMPERATURE
C   AT THE LCL AND PRESSURE OVER 100 KPA TO THE KAPPA POWER.
C   AN APPROXIMATE PARCEL TEMPERATURE FOR FUNCTION FTMAXG
C   IS OBTAINED USING FTMA SO GTMA MUST BE ALREADY CALLED.
C   SEE DOCUMENTATION FOR FTMAXG FOR DETAILS.
C
C PROGRAM HISTORY LOG:
C   91-05-07  IREDELL             MADE INTO INLINABLE FUNCTION
C   94-12-30  IREDELL             EXACT COMPUTATION
C
C USAGE:   TMA=FTMAX(THE,PK,QMA)
C
C   INPUT ARGUMENT LIST:
C     THE      - REAL EQUIVALENT POTENTIAL TEMPERATURE IN KELVIN
C     PK       - REAL PRESSURE OVER 100 KPA TO THE KAPPA POWER
C
C   OUTPUT ARGUMENT LIST:
C     FTMAX    - REAL PARCEL TEMPERATURE IN KELVIN
C     QMA      - REAL PARCEL SPECIFIC HUMIDITY IN KG/KG
C
C SUBPROGRAMS CALLED:
C   (FTMA)   - INLINABLE FUNCTION TO COMPUTE PARCEL TEMPERATURE
C   (FTMAXG) - INLINABLE FUNCTION TO COMPUTE PARCEL TEMPERATURE
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN 77.
C   MACHINE:  CRAY.
C
C$$$
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      TG=FTMA(THE,PK,QG)
      FTMAX=FTMAXG(TG,THE,PK,QMA)
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      RETURN
      END
