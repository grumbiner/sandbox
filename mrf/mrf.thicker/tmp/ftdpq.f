C-----------------------------------------------------------------------
CFPP$ NOCONCUR R
      FUNCTION FTDPQ(PV)
C$$$     SUBPROGRAM DOCUMENTATION BLOCK
C
C SUBPROGRAM: FTDPQ        COMPUTE SATURATION VAPOR PRESSURE
C   AUTHOR: N PHILLIPS            W/NMC2X2   DATE: 30 DEC 82
C
C ABSTRACT: COMPUTE DEWPOINT TEMPERATURE FROM VAPOR PRESSURE.
C   A QUADRATIC INTERPOLATION IS DONE BETWEEN VALUES IN A LOOKUP TABLE
C   COMPUTED IN GTDP. SEE DOCUMENTATION FOR FTDPXG FOR DETAILS.
C   INPUT VALUES OUTSIDE TABLE RANGE ARE RESET TO TABLE EXTREMA.
C   THE INTERPOLATION ACCURACY IS BETTER THAN 0.00001 KELVIN
C   FOR DEWPOINT TEMPERATURES GREATER THAN 250 KELVIN,
C   BUT DECREASES TO 0.002 KELVIN FOR A DEWPOINT AROUND 230 KELVIN.
C   ON THE CRAY, FTDPQ IS ABOUT 60 TIMES FASTER THAN EXACT CALCULATION.
C   THIS FUNCTION SHOULD BE EXPANDED INLINE IN THE CALLING ROUTINE.
C
C PROGRAM HISTORY LOG:
C   91-05-07  IREDELL             MADE INTO INLINABLE FUNCTION
C   94-12-30  IREDELL             QUADRATIC INTERPOLATION
C
C USAGE:   TDP=FTDPQ(PV)
C
C   INPUT ARGUMENT LIST:
C     PV       - REAL VAPOR PRESSURE IN KILOPASCALS (CB)
C
C   OUTPUT ARGUMENT LIST:
C     FTDPQ    - REAL DEWPOINT TEMPERATURE IN KELVIN
C
C COMMON BLOCKS:
C   COMTDP   - SCALING PARAMETERS AND TABLE COMPUTED IN GTDP.
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN 77.
C   MACHINE:  CRAY.
C
C$$$
      PARAMETER(NX=5001)
      DIMENSION TBTDP(NX)
      COMMON/COMTDP/ C1XTDP,C2XTDP,TBTDP
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      XJ=MIN(MAX(C1XTDP+C2XTDP*PV,1.),FLOAT(NX))
      JX=MIN(MAX(NINT(XJ),2),NX-1)
      DXJ=XJ-JX
      FJ1=TBTDP(JX-1)
      FJ2=TBTDP(JX)
      FJ3=TBTDP(JX+1)
      FTDPQ=(((FJ3+FJ1)/2-FJ2)*DXJ+(FJ3-FJ1)/2)*DXJ+FJ2
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      RETURN
      END
