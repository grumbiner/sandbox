C-----------------------------------------------------------------------
CFPP$ NOCONCUR R
      FUNCTION FPKAP(P)
C$$$   SUBPROGRAM  DOCUMENTATION  BLOCK
C
C SUBPROGRAM: FPKAP        RAISE SURFACE PRESSURE TO THE KAPPA POWER.
C   AUTHOR: PHILLIPS         ORG: W/NMC2X2   DATE: 29 DEC 82
C
C ABSTRACT: RAISE SURFACE PRESSURE OVER 100 KPA TO THE KAPPA POWER
C   USING A RATIONAL WEIGHTED CHEBYSHEV APPROXIMATION.
C   THE NUMERATOR IS OF ORDER 2 AND THE DENOMINATOR IS OF ORDER 4.
C   THE PRESSURE RANGE IS 40-110 KPA AND KAPPA IS DEFINED IN FPKAPX.
C   THE COEFFIECIENTS ARE SET BY CALLING GPKAP OR INCLUDING BDPKAP.
C   THE ACCURACY OF THIS APPROXIMATION IS ALMOST 8 DECIMAL PLACES.
C   ON THE CRAY, FPKAP IS OVER 10 TIMES FASTER THAN EXACT CALCULATION.
C   THIS FUNCTION SHOULD BE EXPANDED INLINE IN THE CALLING ROUTINE.
C
C PROGRAM HISTORY LOG:
C   91-05-07  IREDELL             MADE INTO INLINABLE FUNCTION
C   94-12-30  IREDELL             STANDARDIZED KAPPA,
C                                 INCREASED RANGE AND ACCURACY
C
C USAGE:  PKAP=FPKAP(P)
C
C   INPUT ARGUMENT LIST:
C     P        - REAL SURFACE PRESSURE IN KILOPASCALS (CB)
C                P SHOULD BE IN THE RANGE 40. TO 110.
C
C   OUTPUT ARGUMENT LIST:
C     FPKAP    - REAL P/100 TO THE KAPPA POWER
C
C COMMON BLOCKS:
C   COMPKAP  - COEFFICIENTS FOR FUNCTION FPKAP
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN 77.
C   MACHINE:  CRAY.
C
C$$$
      COMMON/COMPKAP/ CN0,CN1,CN2,CD0,CD1,CD2,CD3,CD4
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      FPKAP=(CN0+P*(CN1+P*CN2))/(CD0+P*(CD1+P*(CD2+P*(CD3+P*CD4))))
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      RETURN
      END
