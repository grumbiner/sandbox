      SUBROUTINE TWRITE(N,FHOUR,IDATE,Z,Q,TE,DI,ZE,RQ,SL,SI,GZ,Z00,NZ)
C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C                .      .    .                                       .
C SUBPROGRAM:    TWRITE      WRITES SIGMA LEVEL SPECTRAL COEFFICIENTS.
C   PRGMMR: JOSEPH SELA      ORG: W/NMC23    DATE: 88-04-29
C
C ABSTRACT: WRITES A COMPLETE SET OF FORECAST SIGMA LEVEL
C   SPECTRAL COEFFICIENTS FOR ALL MODEL VARIABLES.
C
C PROGRAM HISTORY LOG:
C   88-04-29  JOSEPH SELA
C   88-11-02  MARK ROZWODOSKI  CHANGED SECOND RECORD TO SELALABEL.
C
C USAGE:    CALL TWRITE (N,FHOUR,IDATE,Z,Q,TE,DI,ZE,RQ,SL,SI,GZ,Z00)
C   INPUT ARGUMENT LIST:
C     N        - FORTRAN UNIT NUMBER FOR FILE TO BE WRITTEN TO.
C     FHOUR    - FORECAST HOUR OF THE SET OF COEFFICIENTS.
C     IDATE    - IDATE(1)=INITIAL HOUR (GMT) OF FORECAST.
C                IDATE(2)=MONTH (1-12).
C                IDATE(3)=DAY OF THE MONTH.
C                IDATE(4)=YEAR OF THE CENTURY.
C     Q        - LN(PSFC)          COEFFICIENTS.
C     TE       - TEMPERATURE       COEFFICIENTS.
C     DI       - DIVERGENCE        COEFFICIENTS.
C     ZE       - VORTICITY         COEFFICIENTS.
C     RQ       - SPECIFIC HUMIDITY COEFFICIENTS.
C     SL       - SIGMA LAYERS     COMPUTED IN SETSIG.
C     SI       - SIGMA INTERFACES COMPUTED IN SETSIG.
C     GZ       - LAPLACIAN OF TOPOGRAPHY.
C     Z00      - MEAN TOPOGRAPHY.
C
C   OUTPUT ARGUMENT LIST:
C     Z        - TOPOGRAPHY SPECTRAL COEFFICIENTS.
C
C   OUTPUT FILES:
C     UNIT N   - COMPLETE SET OF FORECAST SIGMA LEVEL SPECTRAL
C                COEFFICIENTS.
C     OUTPUT   - PRINT FILE.
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN 200.
C   MACHINE:  CYBER 205.
C
C$$$
      COMMON/COMBIT/NDEX( 4032 ),SNNP1( 4032 )
      COMMON/COMBIT/LAB(4),IFIN,ICEN,IGEN,ICEN2,IENST,IENSI,RUNID,USRID
      CHARACTER*8 LAB
      DIMENSION
     1  Z( 4033 ),GZ( 4033 ),Q( 4033 ),
     2 TE( 4033 , 28 ),DI( 4033 , 28 ),ZE( 4033 , 28 ),
     3 RQ( 4033 , 28 )
      DIMENSION IDATE(4),SI( 29 ),SL( 28 )
C
      DIMENSION DUMMY(201- 29 - 28 )
      DIMENSION ENSEMBLE(2),DUMMY2(21)
C
C
      WRITE(N)LAB
C     PRINT 3000,LAB,N
3000  FORMAT(1H0,'GWRITE LAB ',4A10,' N=',I3)
      DUMMY=0.
      WAVES= 62
      XLAYERS= 28
      TRUN=1.
      ORDER=2.
      REALFORM=1.
      GENCODE=IGEN
      RLOND= 192
      RLATD= 94
      RLONP= 192
      RLATP= 94
      RLONR= 128
      RLATR= 62
      TRACERS= 1
      SUBCEN=ICEN2
      ENSEMBLE(1)=IENST
      ENSEMBLE(2)=IENSI
      PPID=0
      SLID=0
      VCID=0
      VMID=0
      VTID=0
      DUMMY2=0
      WRITE(N)FHOUR,IDATE,SI,SL
     &       ,DUMMY,WAVES,XLAYERS,TRUN,ORDER,REALFORM,GENCODE
     &       ,RLOND,RLATD,RLONP,RLATP,RLONR,RLATR,TRACERS
     &       ,SUBCEN,ENSEMBLE,PPID,SLID,VCID,VMID,VTID,RUNID,USRID
     &       ,DUMMY2
C
C...  COMPUTE TOPOG. FROM ITS LAPLACIAN
CMI-CHANGED TO READ OROG FROM INPUT (OCT 92)
C     ASQ= 6.3712E+6 * 6.3712E+6 / 9.8000E+0
C     DO 200 J=3, 4032
C     Z(J)=GZ(J)*ASQ/SNNP1(J)
200   CONTINUE
C     Z(1)=Z00
C     Z(2)=0. E 0
      REWIND NZ
      READ(NZ)
      READ(NZ)
      READ(NZ)( Z(I),I=1, 4032 )
C
      WRITE(N)( Z(I),I=1, 4032 )
      WRITE(N)( Q(I),I=1, 4032 )
      DO 15 K=1, 28
      WRITE(N)(TE(I,K),I=1, 4032 )
15    CONTINUE
      DO 20 K=1, 28
      WRITE(N)(DI(I,K),I=1, 4032 )
      WRITE(N)(ZE(I,K),I=1, 4032 )
20    CONTINUE
      DO 25 K=1, 28
      WRITE(N)(RQ(I,K),I=1, 4032 )
25    CONTINUE
      PRINT 3001,FHOUR,IDATE,N
3001  FORMAT(1H0,'GWRITE FHOUR=',F6.2,2X,4I4,2X,'N=',I2)
      RETURN
      END
