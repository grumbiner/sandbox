      SUBROUTINE GG2LL(CGG,IN,JN,FN,IO,JO,FO)
C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C                .      .    .                                       .
C SUBPROGRAM:    GG2LL       INTERPOLATE GAUSSIAN TO LAT-LON GRID.
C   PRGMMR: MARK IREDELL     ORG: W/NMC23    DATE: 91-12-18
C
C ABSTRACT: A HORIZONTAL FIELD IS LINEARLY INTERPOLATED
C           FROM A GAUSSIAN GRID TO A LATITUDE-LONGITUDE GRID.
C           THE GAUSSIAN COLATITUDES MUST BE PASSED.
C           BOTH INPUT AND OUTPUT FIELDS MUST RUN FIRST EASTWARD
C           THEN SOUTHWARD AND START AT THE SAME LONGITUDE.
C
C PROGRAM HISTORY LOG:
C   91-12-18  MARK IREDELL
C
C USAGE:    CALL GG2LL(CGG,IN,JN,FN,IO,JO,FO)
C   INPUT ARGUMENT LIST:
C     CGG      - JN/2 GAUSSIAN COLATITUDES IN RADIANS
C     IN       - INPUT LONGITUDE (FIRST) DIMENSION
C     JN       - OUTPUT LATITUDE (SECOND) DIMENSION
C     FN       - FIELD TO INTERPOLATE
C     IO       - OUTPUT LONGITUDE (FIRST) DIMENSION
C     JO       - OUTPUT LATITUDE (SECOND) DIMENSION
C
C   OUTPUT ARGUMENT LIST:
C     FO       - INTERPOLATED FIELD
C
C REMARKS: THE CURRENT CODE IS OPTIMIZED FOR MULTIPROCESSING
C          OVER NCPU CPUS ON THE CRAY.
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN 77.
C   MACHINE:  CRAY YMP.
C
C$$$
      PARAMETER(NCPU= 6 )
C-WAV PARAMETER(PI=3.141593)
C-WAV DIMENSION CGG(*),FN(IN,JN),FO(IO,JO)
C-WAV DIMENSION CN(JN),CO(JO)
C
C-WAV JGG=JN
C-WAV DO 10 J=1,JGG/2
C-WAV   CN(J)=CGG(J)
10    CONTINUE
C-WAV DO 20 J=JGG/2+1,JGG
C-WAV   CN(J)=PI-CGG(JGG+1-J)
20    CONTINUE
C-WAV JLL=JO
C-WAV CF=PI/(JLL-1)
C-WAV DO 30 J=1,JLL
C-WAV   CO(J)=CF*(J-1)
30    CONTINUE
C
C-WAV XF=FLOAT(IN)/FLOAT(IO)
CMIC$ DO ALL SHARED(NCPU,JO,JN,CO,CN,IO,IN,FO,FN,XF)
CMIC$1       PRIVATE(N,J1,J2,J,WJ1,WJ2,I,X,I1,I2,WI1,WI2)
      DO 60 N=1,NCPU
C-WAV J1=1
C-WAV J2=2
C-WAV DO 60 J=(N-1)*JO/NCPU+1,MIN(N*JO/NCPU,JO)
40      CONTINUE
C-WAV   IF(CO(J).GT.CN(J2).AND.J2.LT.JN) THEN
C-WAV     J1=J2
C-WAV     J2=J2+1
C-WAV     GOTO 40
C-WAV   ENDIF
C-WAV   WJ1=(CN(J2)-CO(J))/(CN(J2)-CN(J1))
C-WAV   WJ2=1.-WJ1
C-WAV   DO 50 I=1,IO
C-WAV     X=XF*(I-1)+1.
C-WAV     I1=X
C-WAV     I2=MOD(I1,IN)+1
C-WAV     WI2=X-I1
C-WAV     WI1=1.-WI2
C-WAV     FO(I,J)=WJ1*(WI1*FN(I1,J1)+WI2*FN(I2,J1))
C-WAV&           +WJ2*(WI1*FN(I1,J2)+WI2*FN(I2,J2))
50      CONTINUE
60    CONTINUE
      RETURN
      END
