      SUBROUTINE FCSTIM(FHOUR,IMON,IDAY,IZTIM,JDNMC,FJDNMC,RLAG,YEAR,
     1                  RSIN1,RCOS1,RCOS2,JD,FJD)
      PARAMETER (TPI=2. E 0* 3.141593E+0 )
      DIMENSION JMON(12)
      DATA JMON/31,28,31,30,31,30,31,31,30,31,30,31/
      DATA TWO/2. E 0/
      SAVE JMON,TWO
C....    FIRST GET NUMBER OF DAYS SINCE BEGINNING OF YEAR (NO LEAP YRS)
      NNDAY =0
      IMO = IMON - 1
      IF (IMO.GT.0) THEN
        DO 150 I=1,IMO
          NNDAY = NNDAY + JMON(I)
  150   CONTINUE
      ENDIF
      NNDAY = NNDAY + IDAY
      PRINT 1002,NNDAY
 1002 FORMAT(1H ,'*************** NNDAY OF YEAR = ',I4,'******')
C....    GET NUMBER OF DAYS INTO FCST (DYFCST)
C....   FOLLOWING TWO CARDS CHANGED ON 10 APR 86 TO FIX SLIGHT ERROR
C         IN SOLAR DECLINATION CALC IF INITIAL HR NOT 00Z OR 12Z.....
      DAYINI = NNDAY + FLOAT(IZTIM)/24. E 0
      SOLTIM = FHOUR + IZTIM
C...     RESET TO 24 HOUR CLOCK
      FDAY = SOLTIM / 24. E 0
C>YH  SOLTIM = SOLTIM - INT(FDAY) * 24. E 0
      DYFCST = NNDAY + FDAY
      PRINT 1003,JDNMC,FJDNMC,FHOUR,DAYINI,DYFCST
 1003 FORMAT(1H0,'FROM HEATL3 JDNMC ETC',I9,2X,4(2X,F6.2))
      RANG=TPI*(DYFCST-RLAG)/YEAR
      RSIN1=SIN(RANG)
      RCOS1=COS(RANG)
      RCOS2=COS(TWO*RANG)
C....    UPDATE THE JULIAN DATE (INITIAL IN JDNMC,FJDNMC)
      DYINC = DYFCST - DAYINI
      IDYIN = DYINC
      FDYIN = DYINC - IDYIN
      JD = JDNMC + IDYIN
      FJD = FJDNMC + FDYIN
C.......NEED TO RESET IF FRACTION (FJD) GT 1.
      IFJD = FJD
      IF (IFJD.GT.0) THEN
        JD = JD + IFJD
        FJD = FJD - IFJD
      ENDIF
      RETURN
      END
