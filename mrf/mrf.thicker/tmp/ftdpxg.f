C-----------------------------------------------------------------------
CFPP$ NOCONCUR R
      FUNCTION FTDPXG(TG,PV)
C$$$     SUBPROGRAM DOCUMENTATION BLOCK
C
C SUBPROGRAM: FTDPXG       COMPUTE SATURATION VAPOR PRESSURE
C   AUTHOR: N PHILLIPS            W/NMC2X2   DATE: 30 DEC 82
C
C ABSTRACT: EXACTLY COMPUTE DEWPOINT TEMPERATURE FROM VAPOR PRESSURE.
C   A GUESS DEWPOINT TEMPERATURE MUST BE PROVIDED.
C   THE WATER MODEL ASSUMES A PERFECT GAS, CONSTANT SPECIFIC HEATS
C   FOR GAS AND LIQUID, AND NEGLECTS THE VOLUME OF THE LIQUID.
C   THE MODEL DOES ACCOUNT FOR THE VARIATION OF THE LATENT HEAT
C   OF CONDENSATION WITH TEMPERATURE.  THE ICE OPTION IS NOT INCLUDED.
C   THE CLAUSIUS-CLAPEYRON EQUATION IS INTEGRATED FROM THE TRIPLE POINT
C   TO GET THE FORMULA
C       PVS=PSATK*(TR**XA)*EXP(XB*(1.-TR))
C   WHERE TR IS TTP/T AND OTHER VALUES ARE PHYSICAL CONSTANTS
C   THE FORMULA IS INVERTED BY ITERATING NEWTONIAN APPROXIMATIONS
C   FOR EACH PVS UNTIL T IS FOUND TO WITHIN 1.E-6 KELVIN.
C   THIS FUNCTION CAN BE EXPANDED INLINE IN THE CALLING ROUTINE.
C
C PROGRAM HISTORY LOG:
C   91-05-07  IREDELL             MADE INTO INLINABLE FUNCTION
C   94-12-30  IREDELL             EXACT COMPUTATION
C
C USAGE:   TDP=FTDPXG(TG,PV)
C
C   INPUT ARGUMENT LIST:
C     TG       - REAL GUESS DEWPOINT TEMPERATURE IN KELVIN
C     PV       - REAL VAPOR PRESSURE IN KILOPASCALS (CB)
C
C   OUTPUT ARGUMENT LIST:
C     FTDPXG   - REAL DEWPOINT TEMPERATURE IN KELVIN
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN 77.
C   MACHINE:  CRAY.
C
C$$$
      PARAMETER(CP= 1.0046E+3 ,RD= 2.8705E+2 ,RV= 4.6150E+2 ,
     &          TTP= 2.7316E+2 ,HVAP= 2.5000E+6 ,PSAT= 6.1078E+2 ,
     &          CLIQ= 4.1855E+3 ,CVAP= 1.8460E+3 )
      PARAMETER(PSATK=PSAT*1.E-3)
      PARAMETER(DLDT=CVAP-CLIQ,XA=-DLDT/RV,XB=XA+HVAP/(RV*TTP))
      PARAMETER(TERRM=1.E-6)
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      T=TG
      TR=TTP/T
      PVT=PSATK*(TR**XA)*EXP(XB*(1.-TR))
      EL=HVAP+DLDT*(T-TTP)
      DPVT=EL*PVT/(RV*T**2)
      TERR=(PVT-PV)/DPVT
      T=T-TERR
      DOWHILE(ABS(TERR).GT.TERRM)
        TR=TTP/T
        PVT=PSATK*(TR**XA)*EXP(XB*(1.-TR))
        EL=HVAP+DLDT*(T-TTP)
        DPVT=EL*PVT/(RV*T**2)
        TERR=(PVT-PV)/DPVT
        T=T-TERR
      ENDDO
      FTDPXG=T
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      RETURN
      END
