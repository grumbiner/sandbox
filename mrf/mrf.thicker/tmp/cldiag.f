      SUBROUTINE CLDIAG(AVECLA,CLDLA,AVECLB,CLDLB,CLD,CLDARY)
CFPP$ NOCONCUR R
      PARAMETER (IDIM= 256 ,KDIM= 28 )
      PARAMETER (IDIMH=IDIM/2)
      DIMENSION AVECLA(KDIM),CLDLA(4)
      DIMENSION AVECLB(KDIM),CLDLB(4)
      DIMENSION CLDARY(IDIM,KDIM),CLDSUM(IDIM,KDIM)
      DIMENSION CLD(IDIM,4)
      DATA NUMPTS / IDIMH /
C...     UNPACK CLDAMT AND CONV CLDAMT FROM CLDARY..(STRATUS IS +2)
C.        RADIATION SEES STRATIFORM OR CONVECTIVE...NOT MERGED.....
C.        SO CLDSUM REFLECTS THIS BELOW
C...  NOTE:CLDARY 2-4 DIGITS TO LEFT OF DECIMAL=CV CLOUD
C.         CLDARY 1 DIGIT TO LEFT OF DECIMAL+FRACTIONAL PART=STRAT CLD
C.              THOUGH ANVIL CI IS CONSIDERED STRATIFORM
      DO 10 K=1,KDIM
        DO 10 I=1,IDIM
          CSTLYR = AMOD(CLDARY(I,K),2. E 0)
          CST    = AMOD(CLDARY(I,K),10. E 0)
          CCVLYR = 1. E -4 * (CLDARY(I,K)-CST)
          CLDSUM(I,K) = CSTLYR
          IF (CCVLYR.GT.0. E 0) CLDSUM(I,K) = CCVLYR
   10 CONTINUE
      DO 20 K=1,KDIM
        AVECLA(K) = 0. E 0
        AVECLB(K) = 0. E 0
   20 CONTINUE
      DO 30 K=1,4
        CLDLA(K) = 0. E 0
        CLDLB(K) = 0. E 0
   30 CONTINUE
      DO 40 K=1,KDIM
        DO 40 I=1,IDIMH
          AVECLA(K) = AVECLA(K) + CLDSUM(I,K)
          AVECLB(K) = AVECLB(K) + CLDSUM(I+IDIMH,K)
   40 CONTINUE
      DO 50 K=1,4
        DO 50 I=1,IDIMH
          CLDLA(K) = CLDLA(K) + CLD(I,K)
          CLDLB(K) = CLDLB(K) + CLD(I+IDIMH,K)
   50 CONTINUE
      DO 60 K=1,KDIM
        AVECLA(K) = AVECLA(K) / NUMPTS
        AVECLB(K) = AVECLB(K) / NUMPTS
   60 CONTINUE
      DO 70 K=1,4
        CLDLA(K) = CLDLA(K) / NUMPTS
        CLDLB(K) = CLDLB(K) / NUMPTS
   70 CONTINUE
      RETURN
      END
