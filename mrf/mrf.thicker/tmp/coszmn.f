      SUBROUTINE COSZMN(DTSWAV,SOLHR,SINLAT,COSLAT,SDEC,CDEC,SLAG,
     1                  XLON,NLON2,NLAT2,COSZEN,LDG,COSZDG)
CFPP$ NOCONCUR R
C
C===>  COMPUTE MEAN COS SOLAR ZEN ANGL OVER DTSWAV HRS
C....   COSINE OF SOLAR ZEN ANGL FOR BOTH N. AND S. HEMISPHERES.
C        SOLHR=TIME(HRS) AFTER 00Z (GREENWICH TIME)..
C        XLON IS EAST LONG(RADIANS)..
C        SINLAT, COSLAT ARE SIN AND COS OF LATITUDE (N. HEMISPHERE)
C        SDEC, CDEC = THE SINE AND COSINE OF THE SOLAR DECLINATION.
C        SLAG = EQUATION OF TIME
      DIMENSION XLON(NLON2,NLAT2),COSZEN(NLON2,NLAT2)
      LOGICAL LDG
      DIMENSION COSZDG(NLON2,NLAT2)
      DIMENSION SINLAT(NLON2,NLAT2),COSLAT(NLON2,NLAT2)
      DIMENSION COSZN(NLON2),ISTSUN(NLON2)
      NSTP = 6
      ISTP = NSTP*DTSWAV
      PID12 = (2. E 0 * ASIN(1. E 0)) / 12. E 0
C----
      DO 2000 J=1,NLAT2
        DO 20 I=1,NLON2
          COSZEN(I,J) = 0. E 0
          ISTSUN(I) = 0
   20   CONTINUE
      DO 1000 IT=1,ISTP
       CNS = PID12 * (SOLHR-12. E 0+(IT-1)*1. E 0/NSTP) +SLAG
       DO 40 I=1,NLON2
         SS=SINLAT(I,J)*SDEC
         CC=COSLAT(I,J)*CDEC
         COSZN(I) = SS + CC * COS(CNS + XLON(I,J))
CX       COSZN(I) = SINLAT(I,J)*SDEC +
CX   1              COSLAT(I,J)*CDEC * COS(CNS + XLON(I,J))
         COSZEN(I,J) = COSZEN(I,J) + AMAX1(0. E 0, COSZN(I))
         IF(COSZN(I).GT.0. E 0) ISTSUN(I) = ISTSUN(I) + 1
   40  CONTINUE
 1000 CONTINUE
       DO 1500 I=1,NLON2
        IF(LDG) COSZDG(I,J) = COSZEN(I,J) / ISTP
        IF(ISTSUN(I).GT.0) COSZEN(I,J) = COSZEN(I,J) / ISTSUN(I)
 1500  CONTINUE
 2000 CONTINUE
      RETURN
      END
