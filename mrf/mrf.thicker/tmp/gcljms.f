      SUBROUTINE GCLJMS (SI)
      PARAMETER (KDIM= 28 , KDIMP=KDIM+1)
      COMMON /COMCD1/ ROCP,PTOPC(4,2),CVTOP,VVCLD(2),CLAPSE
     1,               CRHRH,KLOWT,KLOWB,PSTRT
     2,               LLYR,CLAPKC,DCLPS,CLPSE
      DIMENSION SI(KDIMP), PPPTOP(4,2)
C --- PRESSURE LIMITS FOR SFC AND TOP OF EACH CLOUD DOMAIN (L,M,H)
C     IN MB, MODEL LAYERS FOR CLD TOPS ARE L=7,M=11,H=15 AT LOW
C     LATITUDES AND L= ,M= ,H=  , AT POLE REGION.
C....     PTOP ABOVE H CHANGED FROM 150 TO 100, CAUSE
CC    DATA PPPTOP /1050.,642.,350.,150., 1050.,750.,500.,150./
C          CODE WAS TRUNCATING TOPS OF CONVECTIVE CLOUDS
      DATA PPPTOP /1050.,642.,350.,100., 1050.,750.,500.,100./
C
      ROCP =  2.8705E+2  /  1.0046E+3
C --- INVERSON TYPE CLD CRITICAL VALUE-ISTRAT=0
CYH94 CLAPSE = -0.055 E 0
      CLAPSE = -0.06 E 0
C --- INVERSON TYPE CLD CRITICAL VALUE-ISTRAT=1
      CLAPKC = -0.05 E 0
C....CRITICAL DTHETA/DP FOR OCEAN STRATUS(WGT VARIES 0 TO 1
C                LINEARLY FROM CLAPSE TO CLPSE)
      DCLPS = -0.01 E 0
      CLPSE = CLAPKC + DCLPS
      CVTOP = 400.0 E 0
      PSTRT = 800.0 E 0
C --- LOW CLD BOTTOM (AT SIGMA=0.95) AND TOP SIGMA LEVEL
      DO 5 K=1,KDIM
        KK=K
        IF (SI(KK) .LE. 0.95 E 0) GO TO 10
   5  CONTINUE
  10  KLOWB = KK - 1
      SILOW = PPPTOP(2,1) * 1.0 E -3
      DO 20 K=1,KDIM
        KK=K
        IF (SI(KK) .LT. SILOW) GO TO 30
  20  CONTINUE
  30  KLOWT = KK
C --- PRESURE LIMIT AT SFC AND AT TOP OF CLOUD DOMAINS (L,M,H) IN MB
      DO 40 J=1,2
      DO 40 I=1,4
       PTOPC(I,J) = PPPTOP(I,J)
  40  CONTINUE
C --- L CLD VERTICAL VEL ADJ BOUNDARIES
      VVCLD(1) =  0.0003 E 0
      VVCLD(2) = -0.0005 E 0
      CRHRH = 0.60 E 0
C--- COMPUTE LLYR--WHICH IS TOPMOST NON CLD(LOW) LAYER, FOR STRATIFORM
      XTHK = 0. E 0
C....   DEFAULT LLYR
      KL = KDIMP
C....   TOPMOST NONCLOUD LAYER WILL BE THE ONE AT OR ABOVE LOWEST
C         0.1 OF THE ATMOSPHERE..
      DO 202 K=1,KDIM
C       XTHK = XTHK + SI(K) - SI(K+1)
C       IF (XTHK.LT.0.1 E 0) GO TO 202
        KL = K
C       GO TO 204
        IF (SI(K).LT.0.9 E 0) GO TO 204
  202 CONTINUE
  204 LLYR = KL-1
      PRINT 205,LLYR,KLOWB
  205 FORMAT(1H ,'-------LLYR,KLOWB =',2I5)
      RETURN
      END
