CFPP$ NOCONCUR R
      SUBROUTINE GOZRIM(QLNT,QLNV,QDERT,EPSI,LAT,RCS2,WGTL)
C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C                .      .    .                                       .
C SUBPROGRAM:    GOZRMT      COMPUTES DERIVATIVES OF LEGENDRES.
C   PRGMMR: JOSEPH SELA      ORG: W/NMC23    DATE: 88-11-02
C
C ABSTRACT: COMPUTES DERIVATIVES OF ASSOCIATED LEGENDRE FUNCTIONS
C   AND FOR CONVENIENCE, OTHER REQUIRED PRODUCTS OF
C   LEGENDRES AND FACTORS INVOLVING WAVE NUMBER AND LATITUDE.
C   THE RESULTING ARRAYS ARE REQUIRED FOR THE APPLICATION
C   OF DIVERGENCE AND CURL OPERATORS IN MSU22 AND PSU22.
C
C PROGRAM HISTORY LOG:
C   88-11-02  JOSEPH SELA
C
C USAGE:    CALL GOZRMT (QLNT,QLNV,QDERT,EPS,LAT,QLNWCT,RCS2,WGTL)
C   INPUT ARGUMENT LIST:
C     QLNT     - DOUBLED SCALAR TRIANGULAR
C                ARRAY OF ASSOCIATED LEGENDRE FUNCTIONS AT
C                A GIVEN LATITUDE.
C                ON INPUT, VALUES OF QLNT ARE A SUBSET OF QLNV.
C     QLNV     - DOUBLED VECTOR TRIANGULAR
C                ARRAY OF ASSOCIATED LEGENDRE FUNCTIONS AT
C                A GIVEN LATITUDE.
C     EPS      - ARRAY OF FUNCTION OF WAVE NUMBER COMPUTED IN EPSLON.
C                EPS IS USED ONLY DURING FIRST CALL TO GOZRMT.
C     LAT      - LATITUDE INDEX.
C     RCS2     - ARRAY OF CONSTANTS COMPUTED IN GLATS (1/SIN(LAT)**2).
C     WGTL     - WEIGHT AT GAUSSIAN LATITUDE.
C                MULTIPLIER OF OUTPUT ARRAYS QLNT, QDERT, QLNWCT.
C
C   OUTPUT ARGUMENT LIST:
C     QLNT     - DOUBLED SCALAR TRIANGULAR
C                ARRAY OF QLNT*N*(N+1)*1/A**2   TIMES WGTL.
C     QDERT    - DOUBLED SCALAR TRIANGULAR
C                ARRAY OF LEGENDRE DERIVATIVES  TIMES WGTL.
C     QLNWCT   - DOUBLED SCALAR TRIANGULAR
C                ARRAY OF QLNT*L*RCS2(LAT)/A    TIMES WGTL.
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN 200.
C   MACHINE:  CYBER 205.
C
C$$$
CRAY       SAVE
CC
      DIMENSION          QLNT( 4032 )
      DIMENSION          QLNV( 4158 )
      DIMENSION         QDERT( 4032 )
      DIMENSION          EPSI( 64 , 63 )
      DIMENSION          RCS2( 47 )
CC
      COMMON /GOZCOM/ DXA( 4032 ),DXB( 4032 )
CC
CCC         PART BETWEEN GUARDS MADE INTO SR GGOZRI.
CCC         7 DEC 1990      M. ROZWODOSKI
CC
CC    COMPUTE PLN DERIVATIVES IN IBM ORDER.
      WCSA=RCS2(LAT)*WGTL/ 6.3712E+6
CC
      LP0 = 0
      LP1 = 2
      LEN =  126
      DO 640  I=1, 63
      DO 620 LL=1,LEN
             QDERT(LL+LP0) = QLNV(LL+LP1) * DXB(LL+LP0)
  620 CONTINUE
      LP1 = LP1 + LEN + 2
      LP0 = LP0 + LEN
      LEN = LEN - 2
  640 CONTINUE
CC
                  LEND =  4032  - 4
      DO 720 LL=1,LEND
             QDERT(LL+2) = QDERT(LL+2) + QLNT(LL) * DXA(LL+2)
  720 CONTINUE
CC
      DO 760 LL=1, 4032
             QDERT(LL) = QDERT(LL) * WCSA
  760 CONTINUE
CC
CC
CC
      RETURN
      END
