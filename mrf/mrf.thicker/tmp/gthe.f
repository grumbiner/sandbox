C-----------------------------------------------------------------------
CFPP$ EXPAND(FTHEX)
      SUBROUTINE GTHE
C$$$     SUBPROGRAM DOCUMENTATION BLOCK
C
C SUBPROGRAM: GTHE        COMPUTE EQUIVALENT POTENTIAL TEMPERATURE TABLE
C   AUTHOR: N PHILLIPS            W/NMC2X2   DATE: 30 DEC 82
C
C ABSTRACT: COMPUTE EQUIVALENT POTENTIAL TEMPERATURE TABLE
C   AS A FUNCTION OF LCL TEMPERATURE AND PRESSURE OVER 100 KPA
C   TO THE KAPPA POWER FOR FUNCTION FTHE.
C   EQUIVALENT POTENTIAL TEMPERATURES ARE CALCULATED IN SUBPROGRAM FTHEX
C   THE CURRENT IMPLEMENTATION COMPUTES A TABLE WITH A FIRST DIMENSION
C   OF 241 FOR TEMPERATURES RANGING FROM 183.16 TO 303.16 KELVIN
C   AND A SECOND DIMENSION OF 151 FOR PRESSURE OVER 100 KPA
C   TO THE KAPPA POWER RANGING FROM 0.04**ROCP TO 1.10**ROCP.
C
C PROGRAM HISTORY LOG:
C   91-05-07  IREDELL
C   94-12-30  IREDELL             EXPAND TABLE
C
C USAGE:  CALL GTHE
C
C SUBPROGRAMS CALLED:
C   (FTHEX)  - INLINABLE FUNCTION TO COMPUTE EQUIV. POT. TEMPERATURE
C
C COMMON BLOCKS:
C   COMTHE   - SCALING PARAMETERS AND TABLE FOR FUNCTION FTHE.
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN 77.
C   MACHINE:  CRAY.
C
C$$$
      PARAMETER(CP= 1.0046E+3 ,RD= 2.8705E+2 ,TTP= 2.7316E+2 )
      PARAMETER(ROCP=RD/CP)
      PARAMETER(NX=241,NY=151)
      DIMENSION TBTHE(NX,NY)
      COMMON/COMTHE/ C1XTHE,C2XTHE,C1YTHE,C2YTHE,TBTHE
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      XMIN=TTP-90.
      XMAX=TTP+30.
      XINC=(XMAX-XMIN)/(NX-1)
      C1XTHE=1.-XMIN/XINC
      C2XTHE=1./XINC
      YMIN=0.04**ROCP
      YMAX=1.10**ROCP
      YINC=(YMAX-YMIN)/(NY-1)
      C1YTHE=1.-YMIN/YINC
      C2YTHE=1./YINC
      DO JY=1,NY
        Y=YMIN+(JY-1)*YINC
        PK=Y
        DO JX=1,NX
          X=XMIN+(JX-1)*XINC
          T=X
          TBTHE(JX,JY)=FTHEX(T,PK)
        ENDDO
      ENDDO
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
      RETURN
      END
