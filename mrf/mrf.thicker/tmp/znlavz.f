      SUBROUTINE ZNLAVZ(LATB2,LONB2,SECPHY,SECRAD,
     &                  DUMTN,SLMSK,SHELEG,DSWSFC,USWSFC)
CFPP$ EXPAND(ZNLAIS)
C
      DIMENSION DUMTN(LONB2,LATB2)
      DIMENSION SLMSK(LONB2,LATB2),SHELEG(LONB2,LATB2)
      DIMENSION DSWSFC(LONB2,LATB2),USWSFC(LONB2,LATB2)
C
      PARAMETER(NRM=23,NRS=32)
      PARAMETER(NLB=6,NST=6)
      PARAMETER(NMU=1,NMV=2,NMTV=3,NMQ=4,NMVOT2=5,
     &          NMDIV2=6,NMOMEGA=7,NMT=8,NMRH=9,NMKE=10,
     &          NMTCONV=11,NMTLARG=12,NMTSHAL=13,NMTVRDF=14,NMQCONV=15,
     &          NMQSHAL=16,NMQVRDF=17,NMUVRDF=18,NMVVRDF=19,NMTHSW=20,
     &          NMTHLW=21,NMTCLD=22,NMTCCV=23)
      PARAMETER(NSRAIN=1,NSRAINC=2,NSTSFC=3,NSQSFC=4,NSUSFC=5,
     &          NSVSFC=6,NSRCOV=7,NSRCOVC=8,NSPS=9,NSTSKIN=10,
     &          NSWET=11,NSSNOW=12,NSTG1=13,NSTG2=14,NSTG3=15,
     &          NSSFCSW=16,NSSFCLW=17,NSRHS=18,NSTVS=19,NSTS=20,
     &          NSQS=21,NSZORL=22,NSSLMSK=23,NSUGWD=24,NSVGWD=25,
     &          NSUASFC=26,NSUAGWD=27,NSUAMTN=28,NSUA=29,NSUAP=30,
     &          NSEP=31,NSCLDWRK=32)
      COMMON /COMZNL/ ZDM(2, 28 ,NRM, 47 ),ZWM(2, 47 ),ZHM(NRM)
      COMMON /COMZNL/ ZDS(2,NST,NRS, 47 ),ZWS(2,NST, 47 )
C
      DIMENSION IST(LONB2)
      DIMENSION WORK1(LONB2)
C
CFPP$ PRIVATEARRAY
      DO LAT=1,LATB2
C
        DO I=1,LONB2
          IF(SLMSK(I,LAT).EQ.0.) THEN
            IST(I)=6
          ELSEIF(SLMSK(I,LAT).EQ.1.) THEN
            IST(I)=2
            IF(SHELEG(I,LAT).GT.1.E-3) IST(I)=3
          ELSE
            IST(I)=4
            IF(SHELEG(I,LAT).GT.1.E-3) IST(I)=5
          ENDIF
        ENDDO
C
        IF(SECRAD.GT.0.) THEN
          DO I=1,LONB2
            WORK1(I)=USWSFC(I,LAT)-DSWSFC(I,LAT)
          ENDDO
          CALL ZNLAIS(WORK1,IST,1./SECRAD,NSSFCSW,LAT)
        ENDIF
C
        IF(SECPHY.GT.0.) THEN
          CALL ZNLAIS(DUMTN(1,LAT),IST,1./SECPHY,NSUAMTN,LAT)
        ENDIF
C
      ENDDO
C
      RETURN
      END
