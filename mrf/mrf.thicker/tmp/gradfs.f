      SUBROUTINE GRADFS(SIGL,KCCO2,NFILE)
C     PARAMETER SETTINGS FOR THE LONGWAVE AND SHORTWAVE RADIATION CODE:
C          IMAX   =  NO. POINTS ALONG THE LAT. CIRCLE USED IN CALCS.
C          L      =  NO. VERTICAL LEVELS (ALSO LAYERS) IN MODEL
C***NOTE: THE USER NORMALLY WILL MODIFY ONLY THE IMAX AND L PARAMETERS
C          NBLW   =  NO. FREQ. BANDS FOR APPROX COMPUTATIONS. SEE
C                      BANDTA FOR DEFINITION
C          NBLX   =  NO. FREQ BANDS FOR APPROX CTS COMPUTATIONS
C          NBLY   =  NO. FREQ. BANDS FOR EXACT CTS COMPUTATIONS. SEE
C                      BDCOMB FOR DEFINITION
C          INLTE  =  NO. LEVELS USED FOR NLTE CALCS.
C          NNLTE  =  INDEX NO. OF FREQ. BAND IN NLTE CALCS.
C          NB,KO2 ARE SHORTWAVE PARAMETERS; OTHER QUANTITIES ARE DERIVED
C                    FROM THE ABOVE PARAMETERS.
      PARAMETER (L= 28 )
      PARAMETER (IMAX= 64 )
      PARAMETER (IMBX=IMAX+1)
      PARAMETER (NBLW=163,NBLX=47,NBLY=15)
      PARAMETER (NBLM=NBLY-1)
      PARAMETER (LP1=L+1,LP2=L+2,LP3=L+3)
      PARAMETER (LM1=L-1,LM2=L-2,LM3=L-3)
      PARAMETER (LL=2*L,LLP1=LL+1,LLP2=LL+2,LLP3=LL+3)
      PARAMETER (LLM1=LL-1,LLM2=LL-2,LLM3=LL-3)
      PARAMETER (LP1M=LP1*LP1,LP1M1=LP1M-1)
      PARAMETER (LP1V=LP1*(1+2*L/2))
      PARAMETER (LP121=LP1*NBLY)
      PARAMETER (LL3P=3*L+2)
      PARAMETER (NB=12)
      PARAMETER (INLTE=3,INLTEP=INLTE+1,NNLTE=56)
      PARAMETER (NB1=NB-1)
      PARAMETER (KO2=12)
      PARAMETER (KO21=KO2+1,KO2M=KO2-1)
      PARAMETER (LNGTH=37*L)
      PARAMETER (NL=81,NLP1=NL+1,NLGTH=37*NL)
      DIMENSION PSTD(NLP1)
      COMMON /RDFSAV/ EMISP,EMIST,XLATT,XLATP,Q19001,HP98,H3M6,
     *     HP75,H6M2,HP537,H74E1,H15E1,Q14330,HP2,TWENTY,HNINE,
     *     DEGRAD,HSIGMA,DAYSEC,RCO2
C...    **************************************************************
C--     SEASONAL CLIMATOLOGIES OF O3 (OBTAINED ON USER VERTICAL COORD)
C         DEFINED AS 5 DEG LAT MEANS N.P.->S.P.
      COMMON /SAVMEM/
C-       ...WINTER....  ...SPRING....  ...SUMMER....  ....FALL.....
     1   DDUO3N(37,L), DDO3N2(37,L), DDO3N3(37,L), DDO3N4(37,L)
      DIMENSION RAD1(LNGTH), RAD2(LNGTH), RAD3(LNGTH), RAD4(LNGTH)
      EQUIVALENCE (RAD1(1),DDUO3N(1,1)),(RAD2(1),DDO3N2(1,1))
      EQUIVALENCE (RAD3(1),DDO3N3(1,1)),(RAD4(1),DDO3N4(1,1))
C--   SEASONAL CLIMATOLOGIES OF O3 ON THE DETAILED GFDL COORDINATE...
C         INTERPOLATION TO EACH POINT PRESSURE PROFILE DONE IN OZON2D
C          (SEE GLOOPR)
      COMMON /SEASO3/
C-       ...WINTER....  ...SPRING....  ...SUMMER....  ....FALL.....
     1   XDUO3N(37,NL), XDO3N2(37,NL), XDO3N3(37,NL), XDO3N4(37,NL)
     2  , PRGFDL(NL)
      DIMENSION XRAD1(NLGTH),XRAD2(NLGTH),XRAD3(NLGTH),XRAD4(NLGTH)
      EQUIVALENCE (XRAD1(1),XDUO3N(1,1)),(XRAD2(1),XDO3N2(1,1))
      EQUIVALENCE (XRAD3(1),XDO3N3(1,1)),(XRAD4(1),XDO3N4(1,1))
C====>    **************************************************************
      DIMENSION SIGL(L)
CYH94 DIMENSION XAO3SW(5),XAH2SW(5),XBSW(5)
CYH94 DATA
CYH941   XAO3SW / 0., .690, .480, .210, 0./ ,
CYH942   XAH2SW / 0., .690, .480, .210, 0./ ,
CYH943   XBSW   / 0., .035, .020, .005, 0./
CCCCCCMIC$ GUARD 0004
C..**************************
C..**************************
C      ********************************************************
C      *      ONE TIME COMPUTATION OF NECESSARY QUANTITIES    *
C      ********************************************************
C....    INITIALIZE ARRAYS,GET CONSTANTS,ETC...
      Q19001=19.001 E 0
      HP98=0.98 E 0
      H3M6=3.0 E -6
      HP537=0.537 E 0
      H74E1=74.0 E 0
      H15E1=15.0 E 0
      Q14330=1.43306 E -6
      HP2=0.2 E 0
      TWENTY=20.0 E 0
      HNINE=9.0 E 0
      DEGRAD=180.0 E 0/ 3.141593E+0
      HSIGMA=5.673 E -5
      DAYSEC=1.1574 E -5
C  ATMOSPERIC CARBON DIOXIDE CONCENTRATION IS NOW READ BY CONRAD,
C  BUT IT DEFAULTS TO 330 PPM FOR BACKWARD COMPATIBILITY.
      RCO2=3.3 E -4
      CALL HCONST
CNAS  IF(KCCO2.GT.0) CALL CO2O3(SLMRF,SLYMRF)
C.... INTERPOLATE CLIMO O3 TO THE CURRENT VERTICAL COORDINATE...
C..      NEED LAYER SIGMA, GET FROM PSFC AND LAYER P FOR I=1.....
      CALL O3INT(DDUO3N,SIGL)
C ...  COMPUTE DETAILED O3 PROFILE FROM THE ORIGINAL GFDL PRESSURES
C              WHERE OUTPUT FROM O3INT (PSTD) IS TOP DOWN IN MB*1.E3
C                    AND PSFC=1013.25 MB    ......K.A.C. DEC94
      CALL O3INTN(XDUO3N,PSTD)
      CALL CONRAD(NFILE,RCO2)
C....  AVERAGE CLIMATOLOGICAL VALUS OF O3 FROM 5 DEG LAT MEANS, SO THAT
C      TIME AND SPACE INTERPOLATION WILL WORK (DONE ELSEWHERE IN RADFS)
      DO 5 I=1,LNGTH
      AVG=.25 E 0*(RAD1(I)+RAD2(I)+RAD3(I)+RAD4(I))
      A1=.5 E 0*(RAD2(I)-RAD4(I))
      B1=.5 E 0*(RAD1(I)-RAD3(I))
      B2=.25 E 0*((RAD1(I)+RAD3(I))-(RAD2(I)+RAD4(I)))
      RAD1(I)=AVG
      RAD2(I)=A1
      RAD3(I)=B1
      RAD4(I)=B2
    5 CONTINUE
C....  AVERAGE CLIMATOLOGICAL VALUS OF O3 FROM 5 DEG LAT MEANS, SO THAT
C      TIME AND SPACE INTERPOLATION WILL WORK (SEE SUBR OZON2D)
      DO 10 I=1,NLGTH
       AVG=.25 E 0*(XRAD1(I)+XRAD2(I)+XRAD3(I)+XRAD4(I))
       A1=.5 E 0*(XRAD2(I)-XRAD4(I))
       B1=.5 E 0*(XRAD1(I)-XRAD3(I))
       B2=.25 E 0*((XRAD1(I)+XRAD3(I))-(XRAD2(I)+XRAD4(I)))
       XRAD1(I)=AVG
       XRAD2(I)=A1
       XRAD3(I)=B1
       XRAD4(I)=B2
   10 CONTINUE
C...     GET GFDL PRESSURE IN CB (FLIP VERTICAL COORDINATE)
      DO 20 N=1,NL
       PRGFDL(N) = PSTD(NL+1-N)*1. E -4
   20 CONTINUE
CYH94 EMIST = .6 E 0
CYH94 EMISP = .3 E 0
      XLATP = 60. E 0
      XLATT = 30. E 0
CCC15 CONTINUE
CCCCCCMIC$ END GUARD 0004
      RETURN
      END
