       SUBROUTINE VVEL
C$$$   SUBPROGRAM  DOCUMENTATION  BLOCK
C
C SUBPROGRAM: VVEL           COMPUTES TWO HOUR AVERAGE OMEGA
C   AUTHOR: DENNIS DEAVEN    ORG: W/NMC23    DATE: 22 JUN 83
C
C ABSTRACT: COMPUTES OMEGA (VERT VEL) DURING TWO HOURS PRIOR TO
C   POSTING THE OUTPUT FILES.  OMEGAS ARE AVERAGED OVER THE TWO HOUR
C   PERIOD EVERY OTHER (EVEN) TIME STEP.
C USAGE:  CALL VVEL
C - - - - - - - - - I N P U T   V A R I A B L E S  - - - - - - - - -
C     NAMES       MEANING/CONTENT/PURPOSE/UNITS/TYPE        INTERFACE
C     -----       ----------------------------------        ---------
C     (COL 7-15)           (COL 19-57)                      (COL 61-71)
C     PSIG        TENDENCIES AT TAU+1 STEP (IN LNEW)        /DEABLK/
C     SIGDOT      D(SIGMA)/DT                               /VTEMP/
C 
C - - - - - - - - - O U T P U T   V A R I A B L E S - - - - - - - - - -
C     NAMES       MEANING/CONTENT/PURPOSE/UNITS/TYPE        INTERFACE
C     -----       ----------------------------------        ---------
C     IVVEL       SCALED VERTICAL VELOCITIES (INTEGER)      /VERTV/
C 
C - - - - - - - - - S U B P R O G R A M S   C A L L E D - - - - - - - -
C     NAME(S)                                               LIBRARY
C     -------                                               -------
C     TENXY                                                 LFM LIB
C
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C ATTRIBUTES:
C   LANGUAGE: SiliconGraphics 3.5 FORTRAN 77
C   MACHINE:  SiliconGraphics IRIS-4D/25, 35, INDIGO
C$$$
C
      IMPLICIT    REAL (A-H,O-Z)
      REAL        HOUR1
      REAL        ICE, MF
      REAL        PTEN1( 53 , 45 ), PTEN2( 53 , 45 )
      CHARACTER*4 LABSIN,LABBND,LABS00,LABS06,LABS12,LABV06,LABV12
      SAVE PTEN1,PTEN2
      COMMON /DEABLK/ US( 53 , 45 , 21 ),
     A     VS( 53 , 45 , 21 ),
     1     TS( 53 , 45 , 21 ), PSIG( 53 , 45 ,6 ),
     2     ST( 53 , 45 ),ICE( 53 , 45 ),
     3     COSZEN( 53 , 45 ),XM( 53 , 45 ),
     4     F( 53 , 45 ),CD( 53 , 45 ),
     5     SATW( 53 , 45 ,3),WS( 53 , 45 , 9 ),
     6     PREC( 53 , 45 ),ZSTAR( 53 , 45 ),
     7     ALON( 53 , 45 ),ALAT( 53 , 45 ),
     8     MF( 53 , 45 ),H2( 53 , 45 , 3 )
      COMMON /VERTV/ IVVEL( 53 , 45 , 8 )
      COMMON /INDEX/ LI,LJ,LK,LI1,LJ1,LK1,LI2,NIJ,LOLD,LMID,LNEW,
     1     K7OLD,K7MID,K7NEW,K3OLD,K3MID,K3NEW,K2OLD,K2MID,K2NEW,
     2     K,K1,K2,K3,KL,KH
      COMMON /FDATE/  IYEAR, IMO, IDAYMO, IZTIME, IHR1, IOUT
      COMMON /SVHOUR/ NWDS, IHOUR1( 1205 ), HOUR1(8)
      COMMON /TTME/   MNSTEP,IODD,IHOUR,IMONTH,ITSW,IVEL,NPHOUR,
     1                SSLDC,CSLDC,SSLHR,CSLHR,SHR,CHR,
     2                ALP,XDAYMO
      COMMON /FORTAP/ LUNBND,LUNSIN,LUNS00,LUNS06,LUNS12,LUNV06,LUNV12,
     A                LABSIN(8),LABBND(8),LABS00(8),LABS06(8),LABS12(8),
     B                LABV06(8),LABV12(8),PARM(25)
      COMMON /PBNDPE/ ALARGE( 53 ,12, 23 ), BLARGE( 12, 33 ,23 )
      COMMON /PBNDRY/ AA( 53 ,12, 23 ), BB( 12, 33 ,23 )
      COMMON /CNST/ BTHICK,BTHIK1,BTHK3,DT,RDELX,
     1              DTDS0,DTDS1,DTDS2,DTDX,DS1DX,DS2DX,
     2              CP,R,ROCP,TSTRAT,CPTS,SATRH,RSAT60,
     3              RDT,BTHICH,BTHK3H,BTK398,RBT,A1BRN,
     4              A2BRN,TDTDX4,RPK,VVCNST
      COMMON /DIAG/ SUMK(8),SUMP1(8),SUMP2(8),SUMS(8),SUMF(8),SUMFD(8),
     1     SUMVOR(8),SUMDIV(8),DP(8),SUMP(8),SUMTS(8),SUMZ(8),
     2     SIGB1,SIGT1,SIGT2,SIGS1,SIGS2,RMSSFC,RMSTRP
      COMMON /FASTER/ PIE(1100),AX(120)
      COMMON /VTEMP/  SIGDOT( 53, 45, 5 ), VT( 53, 45, 25 )
      SAVE
C
C    PSIG TENDENCIES INTO PTEN1 & PTEN2 WHEN K = 1 FOR USE LATER
C
       IF( K.GT.1 ) GO TO 200
      DO 88890 IQ2W6E=1,NIJ
         PTEN1(IQ2W6E,1)=PSIG(IQ2W6E,1,K2NEW)
         PTEN2(IQ2W6E,1)=PSIG(IQ2W6E,1,K2NEW+1)
88890 CONTINUE
200    CONTINUE
      DO 88910 IQ2W6E=1,NIJ
         VT(IQ2W6E,1,23)=RDELX*VT(IQ2W6E,1,1)
88910 CONTINUE
       GO TO (10,20,30,40,50,60,70),K
10     CONTINUE
      DO 88920 IQ2W6E=1,NIJ
         VT(IQ2W6E,1,17)=3.E0*RDT*(PTEN1(IQ2W6E,1)+PTEN2(IQ2W6E,1))
         VT(IQ2W6E,1,18)=3.E0*(VT(IQ2W6E,1,12)+VT(IQ2W6E,1,13))
         VT(IQ2W6E,1,19)=3.E0*(VT(IQ2W6E,1,14)+VT(IQ2W6E,1,15))
         VT(IQ2W6E,1,20)=SIGDOT(IQ2W6E,1,1)*BTHICH+VT(IQ2W6E,1,17)+(VT
     *   (IQ2W6E,1,KL+1)*VT(IQ2W6E,1,18)+VT(IQ2W6E,1,KL+3)*VT(IQ2W6E,1
     *   ,19))*VT(IQ2W6E,1,23)
88920 CONTINUE
1      CONTINUE
       GO TO 100
20     CONTINUE
      DO 88960 IQ2W6E=1,NIJ
         VT(IQ2W6E,1,21)=BTHK3/VT(IQ2W6E,1,10)*SIGDOT(IQ2W6E,1,1)+SIGD
     *   OT(IQ2W6E,1,2)
         VT(IQ2W6E,1,22)=2.5E0
88960 CONTINUE
2      CONTINUE
       GO TO 21
30     CONTINUE
      DO 88980 IQ2W6E=1,NIJ
         VT(IQ2W6E,1,21)=SIGDOT(IQ2W6E,1,2)+SIGDOT(IQ2W6E,1,3)
         VT(IQ2W6E,1,22)=1.5E0
88980 CONTINUE
3      CONTINUE
       GO TO 21
40     CONTINUE
      DO 89000 IQ2W6E=1,NIJ
         VT(IQ2W6E,1,21)=SIGDOT(IQ2W6E,1,3)
         VT(IQ2W6E,1,22)=0.5E0
89000 CONTINUE
4      CONTINUE
21     CONTINUE
      DO 89020 IQ2W6E=1,NIJ
         VT(IQ2W6E,1,20)=VT(IQ2W6E,1,21)*VT(IQ2W6E,1,10)*1.5E0+VT
     *   (IQ2W6E,1,22)*(RDT*PTEN1(IQ2W6E,1)+(VT(IQ2W6E,1,KL+1)*VT
     *   (IQ2W6E,1,12)+VT(IQ2W6E,1,KL+3)*VT(IQ2W6E,1,14))*VT(IQ2W6E,1,
     *   23))+RDT*3.E0*PTEN2(IQ2W6E,1)+(VT(IQ2W6E,1,KL+1)*3.E0*VT
     *   (IQ2W6E,1,13)+VT(IQ2W6E,1,KL+3)*3.E0*VT(IQ2W6E,1,15))*VT
     *   (IQ2W6E,1,23)
89020 CONTINUE
5      CONTINUE
       GO TO 100
50     CONTINUE
      DO 89030 IQ2W6E=1,NIJ
         VT(IQ2W6E,1,21)=SIGDOT(IQ2W6E,1,4)
         VT(IQ2W6E,1,22)=2.5E0
89030 CONTINUE
6      CONTINUE
       GO TO 51
60     CONTINUE
      DO 89050 IQ2W6E=1,NIJ
         VT(IQ2W6E,1,21)=SIGDOT(IQ2W6E,1,4)+SIGDOT(IQ2W6E,1,5)
         VT(IQ2W6E,1,22)=1.5E0
89050 CONTINUE
7      CONTINUE
       GO TO 51
70     CONTINUE
      DO 89070 IQ2W6E=1,NIJ
         VT(IQ2W6E,1,21)=SIGDOT(IQ2W6E,1,5)
         VT(IQ2W6E,1,22)=0.5E0
89070 CONTINUE
8      CONTINUE
51     CONTINUE
      DO 89090 IQ2W6E=1,NIJ
         VT(IQ2W6E,1,20)=VT(IQ2W6E,1,21)*VT(IQ2W6E,1,11)*1.5E0+VT
     *   (IQ2W6E,1,22)*(RDT*PTEN2(IQ2W6E,1)+(VT(IQ2W6E,1,KL+1)*VT
     *   (IQ2W6E,1,13)+VT(IQ2W6E,1,KL+3)*VT(IQ2W6E,1,15))*VT(IQ2W6E,1,
     *   23))
89090 CONTINUE
9      CONTINUE
100    CONTINUE
       CALL TENXY(VT(1,1,17),VT(1,1,20))
      DO 89100 IQ2W6E=1,NIJ
         IVVEL(IQ2W6E,1,K)=IVVEL(IQ2W6E,1,K)+VVCNST*VT(IQ2W6E,1,17)
89100 CONTINUE
       RETURN
       END
