       SUBROUTINE MODU2SIG(UMODE,USIG,S,NV,NMODIN)
C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C                .      .    .                                       .
C SUBPROGRAM:    MODU2SIG    VERT MODE TO SIGMA TRANSFORM
C   PRGMMR: PARRISH          ORG: W/NMC22    DATE: 88-09-08
C
C ABSTRACT: TRANSFORM FROM VERTICAL MODE AMPLITUDES TO SIGMA
C   COORDINATES FOR WIND OR MOISTURE.  USE ONLY WITH COEFFICIENTS!
C
C PROGRAM HISTORY LOG:
C   88-09-08  PARRISH
C
C USAGE:    CALL MODU2SIG(UMODE,USIG,S,NV,NMODIN)
C   INPUT ARGUMENT LIST:
C     UMODE    - INTEGER POINTERS FOR INPUT MODE VARIABLES
C     USIG     - INTEGER POINTERS FOR OUTPUT SIGMA VARIABLES
C     NV       - NUMBER OF POINTS TO TRANSFORM
C     NMODIN   - NUMBER OF VERTICAL MODES
C
C   OUTPUT ARGUMENT LIST:
C     S        - ARRAY CONTAINING ALL COEFFICIENT STUFF (POINTERS
C              - ARE USED TO IDENTIFY WHAT IS WHAT).
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN200
C   MACHINE:  CYBER
C
C$$$
         include "myparam"
C--------
         INTEGER UMODE(1),USIG(1)
         REAL S(INCOEFS,1)
C--------
         COMMON/FIXSP03/NSIG,NMODES,
     *      DELSIG(INSIG),
     *      HEINVT(INSIG),HEINV(INSIG,INSIG),
     *      HEINVG(INSIG,INSIG),
     *      HPIBINVE(INSIG),HTBINVE(INSIG,INSIG),
     *      HE(INSIG,INSIG),HDEPTHS(INMODES)
C--------
C-------- INITIALIZE ALL INTERNAL VARIABLES IF NOT ALREADY DONE
         IF(NSIG.NE.INSIG) CALL SETSP03
C--------
         DO 550 K=1,NSIG
           DO 548 I=1,NV
             S(I,USIG(K))=0.
548        CONTINUE
550      CONTINUE
         DO 575 K=1,NMODIN
           DO 570 KKR=1,NSIG
             KK=NSIG+1-KKR
             DO 568 I=1,NV
               S(I,USIG(KKR))=S(I,USIG(KKR))
     *            +HE(KK,K)*S(I,UMODE(K))
568          CONTINUE
570        CONTINUE
575      CONTINUE
       RETURN
       END
