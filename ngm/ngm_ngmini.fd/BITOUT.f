      SUBROUTINE BITOUT(BITH,BITU,BITV,IM,JM,NG)
C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C
C SUBPROGRAM:    BITOUT      INSERT .T. INTO BIT VECTORS FOR FCST POINTS
C   PRGMMR:  JIM TUCCILLO        ORG: W/NMC4    DATE: 90/06/13
C
C ABSTRACT: INSERTS 'TRUE' INTO THE  VECTORS
C   .       BITH,BITU, BITV FOR VALID FORECAST POINTS ON A GRID
C   .       OTHER THAN GRID A,  HOWEVER IGNORING THE POSSIBLE
C   .       PRESENCE OF A HOLE( FOR THIS USE SR BITHOLE).
C   .
C   .       ZEROS ARE TO BE PUT IN THE FOLLOWING PLACES:
C   FOR NPAIR = 1:
C   .    J           BITU           BITH           BITV
C   .    -           ----           ----           ----
C   .    JM          1-IM           1-IM           1-IM
C   .   JM-1         1-IM       1,2 AND IM     1,2 AND (IM-1),IM
C   3 TO (JM-2)  1,2 AND IM     1,2 AND IM     1,2 AND (IM-1),IM
C   . 1 AND 2        1-IM           1-IM           1-IM
C   .
C   FOR NPAIR = 2:
C   .    J           BITU           BITH           BITV
C   .    -           ----           ----           ----
C   JM-2 TO JM       1-IM           1-IM           1-IM
C   .  JM-3          1-IM       1,2,3,4,IM-2,  1,2,3,4,IM-3,IM-2,
C   .                              IM-1,IM        IM-1,IM
C   5 TO (JM-4)  1,2,3,4,IM-2,  1,2,3,4,IM-2,  1,2,3,4,IM-3,IM-2,
C   .               IM-1,IM        IM-1,IM        IM-1,IM
C   . 1 TO 4         1-IM           1-IM           1-IM
C   .
C   .          ZEROS ARE ALSO PUT IN ANY BIT LOCATIONS BETWEEN
C   .          IM*JM AND IJMAX.
C
C PROGRAM HISTORY LOG:
C   90-06-13  J TUCCILLO
C
C USAGE: CALL BITOUT(BITH,BITU,BITV,IM,JM,NG)
C   INPUT ARGUMENT LIST:
C     BITH,    - CONTROL STORE BIT VECTORS
C     BITU,
C     BITV
C     .
C     IM,JM,   - DIMENSIONS OF THE I ROWS AND
C     NG         THE J ROWS OF GRID NG
C
C   OUTPUT ARGUMENT LIST:
C     BITH,    - CONTROL STORE BIT VECTORS
C     BITU,
C     BITV
C
C   OUTPUT FILES:
C     IOUTUPRT - FOR PRINTOUT
C
C   SUBPROGRAMS CALLED:
C     UNIQUE:
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN
C   MACHINE:  CRAY Y-MP
C
C$$$
C
      include 'parmodel'
C
C...TRANSLATED BY FPP 3.00Z36 11/09/90  14:44:53
C...SWITCHES: OPTON=I47,OPTOFF=VAE0
C
C              (BITS IS A SCRATCH BIT VECTOR FOR AN I-PATTERN.)
      LOGICAL BITH(IIJMAX,2), BITU(IIJMAX,2), BITV(IIJMAX,2)
      LOGICAL BITSTRUH(512), BITSTRV(512), BITSZERO(512)
C
C              SPECIFY THE UNIT NUMBER OF THE PRINTER.
      IOUTUPRT = 6
C
C              REFUSE TO DO GRID A ( DONE BY SHEMPRE)
      IF( NG .GT. 1 ) GO TO 10
      WRITE (IOUTUPRT, 5) NG
    5 FORMAT(1H1,2X,'*****SUBR. BITOUT WAS ASKED TO DO GRID A.NG=',I12)
C
      CALL EXIT(16)
C
   10 CONTINUE
C
C              ENSURE THAT NO MORE THAN 512 POINTS, THE DIMENSION OF
C              SEVERAL BIT STRINGS, IS NOT EXCEEDED.  IF IT IS,
C              SIMPLY INCREASE ALL REFERENCES TO 512 IN THIS
C              SUBROUTINE TO SOME SATISFACTORY VALUE.
        IF (IM .LE. 512) GO TO 18
        WRITE (IOUTUPRT, 14) IM
   14   FORMAT ('1', 2X,'***** SUBROUTINE BITOUT WAS ASKED ',
     1                  'TO HANDLE A FIELD OF', I4, ' POINTS IN ',
     2      'THE I DIRECTION.'/
     3          ' ', 8X,'THIS IS MORE THAN THE 512 LIMIT ',
     4                  'HARDWIRED TO SAVE SPACE IN THIS SUBROUTINE.')
C
        CALL EXIT(16)
C
   18   CONTINUE
C
C            INITIALIZE LOGICAL VECTORS
CMIC$ PARALLEL SHARED(BITSZERO, BITSTRUH, BITSTRV, BITH, BITU, BITV)
CMIC$1    PRIVATE(I, J)
C
C            INITIALIZE LOGICAL VECTORS
CMIC$ DO PARALLEL
      DO 57 J = 1, 20568
         BITH(J,1) = .FALSE.
         BITU(J,1) = .FALSE.
         BITV(J,1) = .FALSE.
   57 CONTINUE
CMIC$ DO PARALLEL VECTOR
        DO 58 I = 1, 512
           BITSZERO ( I ) = .FALSE.
           BITSTRUH ( I ) = .TRUE.
           BITSTRV ( I )  = .TRUE.
58      CONTINUE
CMIC$ END PARALLEL
C
C
      NPAIR = 1
C
C              SET BIT STRINGS OF NONFORECAST POINTS FOR U/H AND V
C              POINTS AFTER THE FIRST TIME STEP OF A PAIR.
      BITSTRUH(1)    = .FALSE.
      BITSTRUH(2)    = .FALSE.
      BITSTRUH(IM)   = .FALSE.
      BITSTRV (1)    = .FALSE.
      BITSTRV (2)    = .FALSE.
      BITSTRV (IM-1) = .FALSE.
      BITSTRV (IM)   = .FALSE.
C
      IADD  = IM + 1
      JM2   = JM - 2
C
      IF (JM2 - 2 .GT. 0) THEN
CMIC$    DO ALL SHARED(JM2, IADD, IM, BITSTRUH, BITU, BITH, BITSTRV,
CMIC$1      BITV) PRIVATE(J, IQ2W6E)
         DO 200 J = 1, JM2 - 2
            DO 77001 IQ2W6E = 1, IM
               BITU(IADD+IQ2W6E-1+J*IM,1) = BITSTRUH(IQ2W6E)
               BITH(IADD+IQ2W6E-1+J*IM,1) = BITSTRUH(IQ2W6E)
               BITV(IADD+IQ2W6E-1+J*IM,1) = BITSTRV(IQ2W6E)
77001       CONTINUE
  200    CONTINUE
         IADD = (JM2-2)*IM + IADD
      ENDIF
C
C              NOW JM-1 ROW.
      IADD = IADD + IM
CMIC$ DO ALL VECTOR SHARED(IM, IADD, BITSZERO, BITU, BITSTRUH, BITH,
CMIC$1   BITSTRV, BITV) PRIVATE(IQ2W6E)
      DO 88920 IQ2W6E = 1, IM
         BITU(IADD+IQ2W6E-1,1) = BITSZERO(IQ2W6E)
         BITH(IADD+IQ2W6E-1,1) = BITSTRUH(IQ2W6E)
         BITV(IADD+IQ2W6E-1,1) = BITSTRV(IQ2W6E)
88920 CONTINUE
C
C
      NPAIR = 2
C
C              ADD ADDITIONAL NONFORECAST POINTS FOR U/H AND V POINTS
C              AFTER THE SECOND TIME STEP OF A PAIR.
      BITSTRUH(3)    = .FALSE.
      BITSTRUH(4)    = .FALSE.
      BITSTRUH(IM-2) = .FALSE.
      BITSTRUH(IM-1) = .FALSE.
      BITSTRV (3)    = .FALSE.
      BITSTRV (4)    = .FALSE.
      BITSTRV (IM-3) = .FALSE.
      BITSTRV (IM-2) = .FALSE.
      IADD = 3 * IM + 1
      JM4  = JM - 4
C
      IF (JM4 - 4 .GT. 0) THEN
CMIC$    DO ALL SHARED(JM4, IADD, IM, BITSTRUH, BITU, BITH, BITSTRV,
CMIC$1      BITV) PRIVATE(J, IQ2W6E)
         DO 300 J = 1, JM4 - 4
            DO 77002 IQ2W6E = 1, IM
               BITU(IADD+IQ2W6E-1+J*IM,2) = BITSTRUH(IQ2W6E)
               BITH(IADD+IQ2W6E-1+J*IM,2) = BITSTRUH(IQ2W6E)
               BITV(IADD+IQ2W6E-1+J*IM,2) = BITSTRV(IQ2W6E)
77002       CONTINUE
  300    CONTINUE
         IADD = (JM4-4)*IM + IADD
      ENDIF
C
C              NOW THE JM-3 ROW.
      IADD = IADD + IM
CMIC$ DO ALL VECTOR SHARED(IM, IADD, BITSZERO, BITU, BITSTRUH, BITH,
CMIC$1   BITSTRV, BITV) PRIVATE(IQ2W6E)
      DO 88980 IQ2W6E = 1, IM
         BITU(IADD+IQ2W6E-1,2) = BITSZERO(IQ2W6E)
         BITH(IADD+IQ2W6E-1,2) = BITSTRUH(IQ2W6E)
         BITV(IADD+IQ2W6E-1,2) = BITSTRV(IQ2W6E)
88980 CONTINUE
C
      RETURN
C
      END
