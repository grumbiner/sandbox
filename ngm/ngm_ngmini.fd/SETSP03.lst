IBM XL Fortran Enterprise Edition V10.1 for AIX (5724-M13)  Version 10.01.0000.0002 --- /gpfs/m/nco/ops/nwprod/sorc/ngm_ngmini.fd/SETSP03.f 09/30/06 19:43:55
 
>>>>> OPTIONS SECTION <<<<<
***   Options In Effect   ***
  
         ==  On / Off Options  ==
         CR              DBG             DDIM            ESCAPE
         FULLPATH        I4              INLGLUE         NOLIBESSL
         NOLIBPOSIX      OBJECT          SOURCE          STDFRAMEWORK
         STRICT          SWAPOMP         THREADED        UNWIND
         NOZEROSIZE
  
         ==  Options Of Integer Type ==
         FIXED(72)             MAXMEM(-1)            OPTIMIZE(2)
         SPILLSIZE(548)        STACKTEMP(0)
  
         ==  Options Of Character Type  ==
         64(LARGETYPE)         ALIAS(STD,INTPTR)     ALIGN(BINDC(POWER),STRUCT(NATURAL))
         ARCH(PWR5X)           ATTR()                AUTODBL(NONE)
         DIRECTIVE(IBM*,IBMT)  ENUM()                FLAG(I,I)
         FLOAT(RNDSNGL,MAF,FOLD,RNGCHK)
         HALT(S)               IEEE(NEAR)            INTSIZE(4)
         LANGLVL(EXTENDED)     POSITION(APPENDOLD)   REALSIZE(4)
         SAVE(ALL)             TUNE(PWR5)            UNROLL(AUTO)
         XREF(FULL)            XLF77(NOLEADZERO,GEDIT77,NOBLANKPAD,OLDBOZ,INTARG,INTXOR,PERSISTENT,SOFTEOF)
         XLF90(NOSIGNEDZERO,NOAUTODEALLOC)
  
>>>>> SOURCE SECTION <<<<<
          1 |       SUBROUTINE SETSP03
          2 |C$$$  SUBPROGRAM DOCUMENTATION BLOCK
          3 |C                .      .    .                                       .
          4 |C SUBPROGRAM:    SETSP03     SET ALL VERT MODE INTERNAL VARIABLES
          5 |C   PRGMMR: PARRISH          ORG: W/NMC22    DATE: 88-09-08
          6 |C
          7 |C ABSTRACT: SET UP ALL VERTICAL MODE INTERNAL VARIABLES IN
          8 |C   COMMON/FIXSP03/.
          9 |C
         10 |C PROGRAM HISTORY LOG:
         11 |C   88-09-08  PARRISH
         12 |C
         13 |C USAGE:    CALL SETSP03
         14 |C
         15 |C ATTRIBUTES:
         16 |C   LANGUAGE: FORTRAN200
         17 |C   MACHINE:  CYBER
         18 |C
         19 |C$$$
         20 |         include "myparam"
  1       1 |        INCLUDE 'parmodel'
  2       1 |C     PARAMETER FILE
  2       2 |C
  2       3 |C     SETUP FOR IBM SINGLE PRECISION REPRESENTATION
  2       4 |C     ON OUTPUT
  2       5 |C                      THIS VERSION 21 February 1991 (DiMego)
  2       6 |C
  2       7 |      PARAMETER (
  2       8 |     *      IBPW      =      4,
  2       9 |     *      IBPOR     = 120000,
  2      10 |     *      INUMREC   = IBPOR / IBPW,
  2      11 |     *      INSPECS   =    700,
  2      12 |     *      ILATG2    =    120,
  2      13 |     *      ILEVH     =     12,
  2      14 |     *      ILEVS     =     16,
  2      15 |     *      ILONF     =    360,
  2      16 |     *      INLATSH   =      5,
  2      17 |     *      IIJMAX    =  23668,
  2      18 |     *      IIJMAXB   =  25536,
  2      19 |     *      IIJRAD    =    892,
  2      20 |     *      IJCAP     =     80,
  2      21 |     *      IWPCPL    =     80,
  2      22 |     *      IKM       =     16 )
  2      23 |      PARAMETER (
  2      24 |     *      ILBCH     =   7*(147+111-7),
  2      25 |     *      ILBHI     =    (147+111-26),
  2      26 |     *      ILBUI     =    (2*147+111-39),
  2      27 |     *      ILBUO     =   (8*147+7*111-56),
  2      28 |     *      ILBVI     =    (147+2*111-39),
  2      29 |     *      ILBVO     =   (7*147+8*111-56),
  2      30 |     *      ILMOUT    =     20 )
  2      31 |      PARAMETER (
  2      32 |     *      IMAXOUTF  =     17,
  2      33 |     *      IMAXOUTT  =      3,
  2      34 |     *      IMAXOUTV  =    100,
  2      35 |     *      IMAXPROF  =      6,
  2      36 |     *      INFILLER  =  10000,
  2      37 |     *      INH       =     65,
  2      38 |     *      INGRDUSE  =      2,
  2      39 |     *      INGRDUS1  =      1,
  2      40 |     *      INIADDRS  =     44,
  2      41 |     *      INSCR     =     23,
  2      42 |     *      INSCRGEO  =     12,
  2      43 |     *      INSCR3    =     10,
  2      44 |     *      INSOIL    =      2,
  2      45 |     *      INSUMG    =  42164,
  2      46 |     *      INSIGSTP  = ILONF * (3 * ILEVS + ILEVH + 2),
  2      47 |     *      INLAT     = ILATG2 + INLATSH + 1,
  2      48 |     *      INSHEM    = 13 * INH + 23,
  2      49 |     *      IIJKMAX   = IKM * IIJMAX )
  2      50 |      PARAMETER (
  2      51 |     *  IIWORDSB  = IIJMAXB / 64,
  2      52 |     *  IKMP1     = IKM + 1,
  2      53 |     *  ILVLTOT   = 7 * IKM + 37,
  2      54 |     *  ILONFP1   = ILONF + 1,
  2      55 |     *  INVBL     = ILVLTOT * INSUMG,
  2      56 |     *  IMAXSCR   = IIJMAX*(INSCR+INSCRGEO) + IIJKMAX*INSCR3+INFILLER,
  2      57 |     *  IRADWRK   = IWPCPL * IIJRAD * IKM,
  2      58 |     *  IBLK1D    =  2 * IKM + 14,
  2      59 |     *  IBLK2D    = 16 * IKM + 36,
  2      60 |     *  IBLK1WRK  = IIJMAX * IBLK1D,
  2      61 |     *  IBLK2WRK  = IIJRAD * IBLK2D )
  2      62 |C
  1       2 |C-------
  1       3 |C------- FOLLOWING IS EXTRA STUFF FOR INITIALIZATION
  1       4 |C-------
  1       5 |         PARAMETER (INLATH=101,INUMCOEF=3*INLATH+35,
  1       6 |     *        INUMGRID=4,IJCAPDP=80,INLON=300,INKLON=2,INKLAT=2,
  1       7 |     *        IIORBPL=3,IIORDPL=3,IIORBLP=3,IIORDLP=3,IMCUBIC=1,
  1       8 |     *        INUMVERT=2,INSIG=IKM,INMODES=18,INGMAX=3000,
  1       9 |     *        INKSIG=2,INSIGP1=INSIG+1,INLONEX=INLON+INKLON,
  1      10 |     *        INLATDP=2*INLATH,INLOLA=INLATDP*INLONEX,
  1      11 |     *        IJCAP1DP=IJCAPDP+1,IJCAP12=2*IJCAP1DP,
  1      12 |     *        INCOEFS=IJCAP1DP*(IJCAPDP+2),
  1      13 |     *     IDPFILLR=(4*IKM+1)*INSUMG+       3*(IIJKMAX*4+IIJMAX) )
  1      14 |C    *     IDPFILLR=(4*IKM+1)*INSUMG+INGRDUSE*(IIJKMAX*4+IIJMAX) )
         21 |C--------
         22 |         COMMON/FIXSP03/NSIG,NMODES,
         23 |     *      DELSIG(INSIG),
         24 |     *      HEINVT(INSIG),HEINV(INSIG,INSIG),
         25 |     *      HEINVG(INSIG,INSIG),
         26 |     *      HPIBINVE(INSIG),HTBINVE(INSIG,INSIG),
         27 |     *      HE(INSIG,INSIG),HDEPTHS(INMODES)
         28 |C--------
         29 |         REAL DSIG(INSIG),SIGHAT(INSIG),SIGINT(INSIGP1)
         30 |         REAL PR(INSIG),TBAR(INSIG)
         31 |         REAL PRESSMB,STDHIGH,STDTEMP,STDTHETA,CKAPPAP1,ONEMSIG
         32 |C--------
         33 |         NSIG=INSIG
         34 |         NMODES=INMODES
         35 |C--------
         36 |C-------- SET UP DELSIG IF NOT ALREADY SPECIFIED
         37 |C--------
         38 |         IF(DELSIG(1).GT.10.) DELSIG=1./NSIG
         39 |         GASCON=287.04
         40 |         CP=1004.6
         41 |         RKAPPA=GASCON/CP
         42 |         CKAPPAP1=RKAPPA+1.
         43 |C              CALCULATE THE INTERFACE VALUES OF SIGMA.
         44 |      SIGINT(1) = 0.0
         45 |C
         46 |      DO 1800 K=1, NSIG
         47 |         SIGINT(K+1) = SIGINT(K) + DELSIG(K)
         48 | 1800 CONTINUE
         49 |C
         50 |      SIGINT(NSIG+1) = 1.
         51 |C
         52 |C              COMPUTE PR(K), WHICH WHEN MULTIPLIED BY 2 TIMES
         53 |C              H ** KAPPA YIELDS PI, THE EXNER FUNCTION.
         54 |      PR(1) = 1.
         55 |C
         56 |      DO 1900 K=2, NSIG
         57 |         ONEMSIG = 1.E0 -  SIGINT(K)
         58 |         PR(K) = ONEMSIG**CKAPPAP1
         59 | 1900 CONTINUE
         60 |C
         61 |      C1 = 1./(2.*CKAPPAP1)
         62 |C
         63 |      DO 2000 K=1, NSIG-1
         64 |         PR(K) = C1 * (PR(K) - PR(K+1) ) / DELSIG(K)
         65 | 2000 CONTINUE
         66 |C
         67 |      PR(NSIG) = C1 * PR(NSIG) / DELSIG(NSIG)
         68 |C--------
         69 |         DO 300 K=1,NSIG
         70 |           KR=NSIG+1-K
         71 |           DSIG(K)=DELSIG(KR)
         72 |300      CONTINUE
         73 |         SIGOLD=0.
         74 |         DO 312 I=1,NSIG
         75 |           SIGNEW=SIGOLD+DSIG(I)
         76 |           SIGHAT(I)=.5*(SIGNEW+SIGOLD)
         77 |           SIGOLD=SIGNEW
         78 |312      CONTINUE
         79 |         DO 314 K=1,NSIG
         80 |C          PRESSMB=1000.*(2.*PR(K))**CKAPPAI
         81 |           PRESSMB=1000.*SIGHAT(K)
         82 |           PRESSMB=MAX(PRESSMB,8.7)
         83 |           CALL W3FA03(PRESSMB,STDHIGH,STDTEMP,STDTHETA)
         84 |           TBAR(K)=STDTEMP
         85 |c          WRITE(6,313)PRESSMB,TBAR(K),K
         86 |313        FORMAT(' PRESSURE = ',F8.1,' TBAR(K) = ',F8.1,' K=',I3)
         87 |314      CONTINUE
         88 |         CALL VMATHS(TBAR,DSIG,PR,CP,RKAPPA,GASCON,
         89 |     *                   SIGHAT,HDEPTHS,HEINVT,HEINV,HEINVG,
         90 |     *                   HPIBINVE,HTBINVE,HE)
         91 |       RETURN
         92 |       END
 
>>>>> ATTRIBUTE AND CROSS REFERENCE SECTION <<<<<
 
 
 
IDENTIFIER NAME                  CROSS REFERENCE AND ATTRIBUTES
 
c1                               Static, Real(4), Offset: 0, Alignment: full word
                                 0-61.7@  0-64.18  0-67.18
 
ckappap1                         Static, Real(4), Offset: 0, Alignment: full word
                                 0-31.48$  0-42.10@  0-58.27  0-61.19
 
cp                               Static, Real(4), Offset: 0, Alignment: full word
                                 0-40.10@  0-41.24  0-88.35
 
delsig                           Common member, Real(4) (1:16), Offset: 8, Alignment: double word
                                 0-23.13$  0-38.13  0-38.31@  0-47.36  0-64.44  0-67.34  0-71.20
 
dsig                             Static, Real(4) (1:16), Offset: 0, Alignment: full word
                                 0-29.15$  0-71.12@  0-75.26  0-88.27
 
fixsp03                          Common Block, Alignment: double word
                                 0-22.17$
 
gascon                           Static, Real(4), Offset: 0, Alignment: full word
                                 0-39.10@  0-41.17  0-88.45
 
hdepths                          Common member, Real(4) (1:18), Offset: 4296, Alignment: double word
                                 0-27.29$  0-89.33
 
he                               Common member, Real(4) (1:16, 1:16), Offset: 3272, Alignment: double word
                                 0-27.13$  0-90.43
 
heinv                            Common member, Real(4) (1:16, 1:16), Offset: 136, Alignment: double word
                                 0-24.27$  0-89.48
 
heinvg                           Common member, Real(4) (1:16, 1:16), Offset: 1160, Alignment: double word
                                 0-25.13$  0-89.54
 
heinvt                           Common member, Real(4) (1:16), Offset: 72, Alignment: double word
                                 0-24.13$  0-89.41
 
hpibinve                         Common member, Real(4) (1:16), Offset: 2184, Alignment: double word
                                 0-26.13$  0-90.26
 
htbinve                          Common member, Real(4) (1:16, 1:16), Offset: 2248, Alignment: double word
                                 0-26.29$  0-90.35
 
i                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-74.17@  0-75.31  0-76.19
 
iblk1d                           Parameter, Integer(4)
                                 2-58.9$  2-60.30
 
iblk1wrk                         Parameter, Integer(4)
                                 2-60.9$
 
iblk2d                           Parameter, Integer(4)
                                 2-59.9$  2-61.30
 
iblk2wrk                         Parameter, Integer(4)
                                 2-61.9$
 
ibpor                            Parameter, Integer(4)
                                 2-9.13$  2-10.25
 
ibpw                             Parameter, Integer(4)
                                 2-8.13$  2-10.33
 
idpfillr                         Parameter, Integer(4)
                                 1-13.12$
 
iijkmax                          Parameter, Integer(4)
                                 2-49.13$  1-13.48  2-56.47
 
iijmax                           Parameter, Integer(4)
                                 2-17.13$  1-13.58  2-49.31  2-56.21  2-60.21
 
iijmaxb                          Parameter, Integer(4)
                                 2-18.13$  2-51.21
 
iijrad                           Parameter, Integer(4)
                                 2-19.13$  2-57.30  2-61.21
 
iiorblp                          Parameter, Integer(4)
                                 1-7.35$
 
iiorbpl                          Parameter, Integer(4)
                                 1-7.15$
 
iiordlp                          Parameter, Integer(4)
                                 1-7.45$
 
iiordpl                          Parameter, Integer(4)
                                 1-7.25$
 
iiwordsb                         Parameter, Integer(4)
                                 2-51.9$
 
ijcap                            Parameter, Integer(4)
                                 2-20.13$
 
ijcap12                          Parameter, Integer(4)
                                 1-11.34$
 
ijcap1dp                         Parameter, Integer(4)
                                 1-11.15$  1-11.44  1-12.23
 
ijcapdp                          Parameter, Integer(4)
                                 1-6.26$  1-11.24  1-12.33
 
ikm                              Parameter, Integer(4)
                                 2-22.13$  1-8.32  1-13.24  2-49.25  2-52.21  2-53.25  2-57.39  2-58.26  2-59.26
 
ikmp1                            Parameter, Integer(4)
                                 2-52.9$
 
ilatg2                           Parameter, Integer(4)
                                 2-12.13$  2-47.25
 
ilbch                            Parameter, Integer(4)
                                 2-24.13$
 
ilbhi                            Parameter, Integer(4)
                                 2-25.13$
 
ilbui                            Parameter, Integer(4)
                                 2-26.13$
 
ilbuo                            Parameter, Integer(4)
                                 2-27.13$
 
ilbvi                            Parameter, Integer(4)
                                 2-28.13$
 
ilbvo                            Parameter, Integer(4)
                                 2-29.13$
 
ilevh                            Parameter, Integer(4)
                                 2-13.13$  2-46.46
 
ilevs                            Parameter, Integer(4)
                                 2-14.13$  2-46.38
 
ilmout                           Parameter, Integer(4)
                                 2-30.13$
 
ilonf                            Parameter, Integer(4)
                                 2-15.13$  2-46.25  2-54.21
 
ilonfp1                          Parameter, Integer(4)
                                 2-54.9$
 
ilvltot                          Parameter, Integer(4)
                                 2-53.9$  2-55.21
 
imaxoutf                         Parameter, Integer(4)
                                 2-32.13$
 
imaxoutt                         Parameter, Integer(4)
                                 2-33.13$
 
imaxoutv                         Parameter, Integer(4)
                                 2-34.13$
 
imaxprof                         Parameter, Integer(4)
                                 2-35.13$
 
imaxscr                          Parameter, Integer(4)
                                 2-56.9$
 
imcubic                          Parameter, Integer(4)
                                 1-7.55$
 
incoefs                          Parameter, Integer(4)
                                 1-12.15$
 
infiller                         Parameter, Integer(4)
                                 2-36.13$  2-56.62
 
ingmax                           Parameter, Integer(4)
                                 1-8.47$
 
ingrdus1                         Parameter, Integer(4)
                                 2-39.13$
 
ingrduse                         Parameter, Integer(4)
                                 2-38.13$
 
inh                              Parameter, Integer(4)
                                 2-37.13$  2-48.30
 
iniaddrs                         Parameter, Integer(4)
                                 2-40.13$
 
inklat                           Parameter, Integer(4)
                                 1-6.56$
 
inklon                           Parameter, Integer(4)
                                 1-6.47$  1-9.54
 
inksig                           Parameter, Integer(4)
                                 1-9.15$
 
inlat                            Parameter, Integer(4)
                                 2-47.13$
 
inlatdp                          Parameter, Integer(4)
                                 1-10.15$  1-10.39
 
inlath                           Parameter, Integer(4)
                                 1-5.21$  1-5.43  1-10.25
 
inlatsh                          Parameter, Integer(4)
                                 2-16.13$  2-47.34
 
inlola                           Parameter, Integer(4)
                                 1-10.32$
 
inlon                            Parameter, Integer(4)
                                 1-6.37$  1-9.48
 
inlonex                          Parameter, Integer(4)
                                 1-9.40$  1-10.47
 
inmodes                          Parameter, Integer(4)
                                 1-8.36$  0-27.37  0-34.17
 
inscr                            Parameter, Integer(4)
                                 2-41.13$  2-56.29
 
inscr3                           Parameter, Integer(4)
                                 2-43.13$  2-56.55
 
inscrgeo                         Parameter, Integer(4)
                                 2-42.13$  2-56.35
 
inshem                           Parameter, Integer(4)
                                 2-48.13$
 
insig                            Parameter, Integer(4)
                                 1-8.26$  0-23.20  0-24.20  0-24.33  0-24.39  0-25.20  0-25.26  0-26.22  0-26.37  0-26.43  0-27.16
                                 0-27.22  0-29.20  0-29.34  0-30.18  0-30.30  0-33.15  1-9.32
 
insigp1                          Parameter, Integer(4)
                                 1-9.24$  0-29.48
 
insigstp                         Parameter, Integer(4)
                                 2-46.13$
 
insoil                           Parameter, Integer(4)
                                 2-44.13$
 
inspecs                          Parameter, Integer(4)
                                 2-11.13$
 
insumg                           Parameter, Integer(4)
                                 2-45.13$  1-13.31  2-55.31
 
inumcoef                         Parameter, Integer(4)
                                 1-5.32$
 
inumgrid                         Parameter, Integer(4)
                                 1-6.15$
 
inumrec                          Parameter, Integer(4)
                                 2-10.13$
 
inumvert                         Parameter, Integer(4)
                                 1-8.15$
 
invbl                            Parameter, Integer(4)
                                 2-55.9$
 
iradwrk                          Parameter, Integer(4)
                                 2-57.9$
 
iwpcpl                           Parameter, Integer(4)
                                 2-21.13$  2-57.21
 
k                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-46.15@  0-47.17  0-47.31  0-47.43  0-56.15@  0-57.35  0-58.13  0-63.15@  0-64.13  0-64.27
                                 0-64.35  0-64.51  0-69.17@  0-70.22  0-71.17  0-79.17@  0-81.33  0-84.17
 
kr                               Static, Integer(4), Offset: 0, Alignment: full word
                                 0-70.12@  0-71.27
 
max                              Pure Intrinsic
                                 0-82.20
 
nmodes                           Common member, Integer(4), Offset: 4, Alignment: full word
                                 0-22.30$  0-34.10@
 
nsig                             Common member, Integer(4), Offset: 0, Alignment: quadruple word
                                 0-22.25$  0-33.10@  0-38.41  0-46.20  0-50.14  0-56.20  0-63.20  0-67.10  0-67.26  0-67.41  0-69.21
                                 0-70.15  0-74.21  0-79.21
 
onemsig                          Static, Real(4), Offset: 0, Alignment: full word
                                 0-31.57$  0-57.10@  0-58.18
 
pr                               Static, Real(4) (1:16), Offset: 0, Alignment: full word
                                 0-30.15$  0-54.7@  0-58.10@  0-64.10@  0-64.24  0-64.32  0-67.7@  0-67.23  0-88.32
 
pressmb                          Static, Real(4), Offset: 0, Alignment: full word
                                 0-31.15$  0-81.12@  0-82.12@  0-82.24  0-83.24
 
rkappa                           Static, Real(4), Offset: 0, Alignment: full word
                                 0-41.10@  0-42.19  0-88.38
 
setsp03                          Subroutine
                                 0-1.19$
 
sighat                           Static, Real(4) (1:16), Offset: 0, Alignment: full word
                                 0-29.27$  0-76.12@  0-81.26  0-89.26
 
sigint                           Static, Real(4) (1:17), Offset: 0, Alignment: full word
                                 0-29.41$  0-44.7@  0-47.10@  0-47.24  0-50.7@  0-57.28
 
signew                           Static, Real(4), Offset: 0, Alignment: full word
                                 0-75.12@  0-76.26  0-77.19
 
sigold                           Static, Real(4), Offset: 0, Alignment: full word
                                 0-73.10@  0-75.19  0-76.33  0-77.12@
 
stdhigh                          Static, Real(4), Offset: 0, Alignment: full word
                                 0-31.23$  0-83.32
 
stdtemp                          Static, Real(4), Offset: 0, Alignment: full word
                                 0-31.31$  0-83.40  0-84.20
 
stdtheta                         Static, Real(4), Offset: 0, Alignment: full word
                                 0-31.39$  0-83.48
 
tbar                             Static, Real(4) (1:16), Offset: 0, Alignment: full word
                                 0-30.25$  0-84.12@  0-88.22
 
vmaths                           External Subroutine
                                 0-88.15
 
w3fa03                           External Subroutine
                                 0-83.17
 
** setsp03   === End of Compilation 1 ===
 
>>>>> FILE TABLE SECTION <<<<<
 
 
                                       FILE CREATION        FROM
FILE NO   FILENAME                    DATE       TIME       FILE    LINE
     0    SETSP03.f                   10/09/02   12:45:08
     1    /gpfs/m/nco/ops/nwprod/sorc/ngm_ngmini.fd/myparam
                                      02/09/00   18:27:58      0      20
     2    /gpfs/m/nco/ops/nwprod/sorc/ngm_ngmini.fd/parmodel
                                      02/09/00   18:27:59      1       1
 
 
>>>>> COMPILATION EPILOGUE SECTION <<<<<
 
 
FORTRAN Summary of Diagnosed Conditions
 
TOTAL   UNRECOVERABLE  SEVERE       ERROR     WARNING    INFORMATIONAL
               (U)       (S)         (E)        (W)          (I)
    0           0         0           0          0            0
 
 
    Source records read.......................................     168
1501-510  Compilation successful for file SETSP03.f.
1501-543  Object file created.
