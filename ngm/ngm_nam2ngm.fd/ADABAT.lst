IBM XL Fortran Enterprise Edition V10.1 for AIX (5724-M13)  Version 10.01.0000.0002 --- /gpfs/m/nco/ops/nwprod/sorc/ngm_nam2ngm.fd/ADABAT.f 09/30/06 19:44:07
 
>>>>> OPTIONS SECTION <<<<<
***   Options In Effect   ***
  
         ==  On / Off Options  ==
         CR              DBG             DDIM            ESCAPE
         FULLPATH        I4              INLGLUE         NOLIBESSL
         NOLIBPOSIX      OBJECT          SOURCE          STDFRAMEWORK
         STRICT          SWAPOMP         THREADED        UNWIND
         NOZEROSIZE
  
         ==  Options Of Integer Type ==
         FIXED(72)             MAXMEM(-1)            OPTIMIZE(2)
         SPILLSIZE(548)        STACKTEMP(0)
  
         ==  Options Of Character Type  ==
         64(LARGETYPE)         ALIAS(STD,INTPTR)     ALIGN(BINDC(POWER),STRUCT(NATURAL))
         ARCH(PWR5X)           ATTR()                AUTODBL(NONE)
         DIRECTIVE(IBM*,IBMT)  ENUM()                FLAG(I,I)
         FLOAT(RNDSNGL,MAF,FOLD,RNGCHK)
         HALT(S)               IEEE(NEAR)            INTSIZE(4)
         LANGLVL(EXTENDED)     POSITION(APPENDOLD)   REALSIZE(4)
         NOSAVE()              TUNE(PWR5)            UNROLL(AUTO)
         XREF(FULL)            XLF77(NOLEADZERO,GEDIT77,NOBLANKPAD,OLDBOZ,INTARG,INTXOR,PERSISTENT,SOFTEOF)
         XLF90(NOSIGNEDZERO,NOAUTODEALLOC)
  
>>>>> SOURCE SECTION <<<<<
          1 |      SUBROUTINE ADABAT(TS,PS,ISTO)
          2 |C$$$  SUBPROGRAM DOCUMENTATION BLOCK
          3 |C                .      .    .                                       .
          4 |C SUBPROGRAM:    ADABAT      PERFORM ADIABATIC CHECK OF TEMPS
          5 |C   PRGMMR: DIMEGO           ORG: W/NMC22    DATE: 86-03-31
          6 |C
          7 |C ABSTRACT: PERFORMS A CHECK OF TEMPERATURE PROFILES FOR LAYERS
          8 |C   WHICH ARE SUPER-ADIABATIC.  A CORRECTION IS CALCULATED AND
          9 |C   APPLIED IF THE SWITCH IS SET TO DO SO.  BASED ON RALPH JONES
         10 |C   CODE FROM THE ISENTROPIC.
         11 |C
         12 |C PROGRAM HISTORY LOG:
         13 |C   86-03-31  DIMEGO
         14 |C   88-06-30  DIMEGO      HALF PRECISION / PL1 / FTN200
         15 |C   99-05-20  ROGERS      CHANGED TO DO ONE PROFILE AT A TIME
         16 |C
         17 |C USAGE:    CALL ADABAT(TS,PS,ISTO)
         18 |C   INPUT ARGUMENT LIST:
         19 |C     TS       - ARRAY OF TEMPERATURES (ANALYSIS STRIP)
         20 |C     PS       - ARRAY OF PRESSURES (ANALYSIS STRIP)
         21 |C     ISTO     - SWITCH FOR STORING CORRECTED/ADJUSTED VALUE:
         22 |C              - 0 DO NOT STORE ; NON ZERO STORE NEW VALUE.
         23 |C
         24 |C   OUTPUT ARGUMENT LIST:
         25 |C     TS       - WHEN ISTO IS NON-ZERO, THE ADJUSTED VALUES
         26 |C              - ARE WRITTEN IN PLACE OF ORIGINAL VALUES.
         27 |C
         28 |C REMARKS: LAYERS ARE SIMPLY MIXED TO RELIEVE SUPER-ADIABAT
         29 |C
         30 |C ATTRIBUTES:
         31 |C   LANGUAGE: STANDARD FORTRAN
         32 |C   MACHINE:
         33 |C
         34 |C$$$
         35 |      IMPLICIT REAL (A-H,O-Z)
         36 |      INCLUDE "parmodel"
  1       1 |C     PARAMETER FILE
  1       2 |C
  1       3 |C     SETUP FOR IBM SINGLE PRECISION REPRESENTATION
  1       4 |C     ON OUTPUT
  1       5 |C                      THIS VERSION 1 May 1991 (DiMego)
  1       6 |C
  1       7 |      PARAMETER (
  1       8 |     *      IBPW      =      4,
  1       9 |     *      IBPOR     = 120000,
  1      10 |     *      INUMREC   = IBPOR / IBPW,
  1      11 |     *      INSPECS   =    700,
  1      12 |     *      ILATG2    =    120,
  1      13 |     *      ILEVH     =     12,
  1      14 |     *      ILEVS     =     16,
  1      15 |     *      ILONF     =    360,
  1      16 |     *      INLATSH   =      5,
  1      17 |     *      IIJMAX    =  23668,
  1      18 |     *      IIJMAXB   =  25536,
  1      19 |     *      IIJRAD    =    892,
  1      20 |     *      IJCAP     =     80,
  1      21 |     *      IWPCPL    =     80,
  1      22 |     *      IKM       =     16 )
  1      23 |      PARAMETER (
  1      24 |     *      ILBCH     =   7*(147+111-7),
  1      25 |     *      ILBHI     =    (147+111-26),
  1      26 |     *      ILBUI     =    (2*147+111-39),
  1      27 |     *      ILBUO     =   (8*147+7*111-56),
  1      28 |     *      ILBVI     =    (147+2*111-39),
  1      29 |     *      ILBVO     =   (7*147+8*111-56),
  1      30 |     *      ILMOUT    =     20 )
  1      31 |      PARAMETER (
  1      32 |     *      IMAXOUTF  =     17,
  1      33 |     *      IMAXOUTT  =      5,
  1      34 |     *      IMAXOUTV  =    100,
  1      35 |     *      IMAXPROF  =      6,
  1      36 |     *      INFILLER  =2500000,
  1      37 |     *      INH       =     65,
  1      38 |     *      INGRDUSE  =      2,
  1      39 |     *      INGRDUS1  =      1,
  1      40 |     *      INIADDRS  =     44,
  1      41 |     *      INSCR     =     23,
  1      42 |     *      INSCRGEO  =     12,
  1      43 |     *      INSCR3    =     10,
  1      44 |     *      INSOIL    =      2,
  1      45 |     *      INSUMG    =  42164,
  1      46 |     *      INSIGSTP  = ILONF * (3 * ILEVS + ILEVH + 2),
  1      47 |     *      INLAT     = ILATG2 + INLATSH + 1,
  1      48 |     *      INSHEM    = 13 * INH + 23,
  1      49 |     *      IIJKMAX   = IKM * IIJMAX )
  1      50 |      PARAMETER (
  1      51 |     *  IIWORDSB  = IIJMAXB / 64,
  1      52 |     *  IKMP1     = IKM + 1,
  1      53 |     *  ILVLTOT   = 7 * IKM + 37,
  1      54 |     *  ILONFP1   = ILONF + 1,
  1      55 |     *  INVBL     = ILVLTOT * INSUMG,
  1      56 |     *  IMAXSCR   = IIJMAX*(INSCR+INSCRGEO) + IIJKMAX*INSCR3+INFILLER,
  1      57 |     *  IRADWRK   = IWPCPL * IIJRAD * IKM,
  1      58 |     *  IBLK1D    =  2 * IKM + 14,
  1      59 |     *  IBLK2D    = 16 * IKM + 36,
  1      60 |     *  IBLK1WRK  = IIJMAX * IBLK1D,
  1      61 |     *  IBLK2WRK  = IIJRAD * IBLK2D )
  1      62 |C
         37 |      PARAMETER(LMAX=IKM)
         38 |      DIMENSION TS( LMAX ),PS( LMAX )
         39 |      DIMENSION PT( LMAX ),PI( LMAX ),NCOUNT( LMAX )
         40 |      DIMENSION DMEAN( LMAX ),RMSTD( LMAX ),TDMAX( LMAX )
         41 |      DATA NCOUNT,DMEAN/ LMAX *0, LMAX *0.0/
         42 |      DATA RMSTD,TDMAX/ LMAX *0.0, LMAX *0.0/
         43 |      LMAXM1= LMAX - 1
         44 |      ROCP = 287.05 / 1005.
         45 |      XSTO = 0.0
         46 |      IF( ISTO.GT.0 )  XSTO = 1.0
         47 |C  COMPUTE PI & THETA AND ADJUST ANY SUPERADIABATIC LAPSE RATES
         48 |      DO 2 L=1, LMAX
         49 |      PI(L) = (.001*PS(L)) ** ROCP
         50 |      PT(L) = TS(L)/PI(L)
         51 |    2 CONTINUE
         52 |      ITER = 0
         53 |      ITX = 50
         54 |      CMAX = 0.0
         55 |      CMEAN = 0.0
         56 |      NCNT = 0
         57 |      LEVMAX = 0
         58 |      DO 4 N=1,ITX
         59 |      NHS = 0
         60 |      DO 3 L=1,LMAXM1
         61 |      DPT = PT(L+1)-PT(L)
         62 |      IF(DPT.GT.0.0) GO TO 3
         63 |      NHS = NHS+1
         64 |      NCNT = NCNT + 1
         65 |      COR = 0.5*DPT-0.05
         66 |      TCOR = ABS(COR*0.5*(PI(L)+PI(L+1)))
         67 |      CMAX = MAX(CMAX,TCOR)
         68 |      CMEAN = CMEAN + TCOR
         69 |      IF(NCNT.EQ.1) LEVMAX = L
         70 |      PT(L+1) = PT(L+1)-COR
         71 |      PT(L) = PT(L)+COR
         72 |    3 CONTINUE
         73 |      IF(NHS.EQ.0) GO TO 5
         74 |      ITER = N
         75 |    4 CONTINUE
         76 |    5 CONTINUE
         77 |      IF(ITER.EQ.0) GO TO 7
         78 |      IF( NCNT.GT.1 )  CMEAN = CMEAN / FLOAT(NCNT)
         79 |C     IF(ITER.GT.3.OR.CMAX.GE.1.0.OR.CMEAN.GT.0.5)
         80 |C    + WRITE(6,101) I,J,ITER,NCNT,LEVMAX,CMAX,CMEAN
         81 |C 101 FORMAT('  ADIABATIC ADJUSTMENT AT POINT (',I3,',',I2,')',
         82 |C    1        ' NEEDED ',I3,' ITERATIONS',2I5,2F10.3)
         83 |C  NOW RE-COMPUTE ADJUSTED TEMPERATURES
         84 |      DO 6 L=1,LMAX
         85 |      TNEW = PT(L) * PI(L)
         86 |      TDIF = TNEW - TS(L)
         87 |      IF(ABS(TDIF).LE.0.01) GO TO 6
         88 |      NCOUNT(L) = NCOUNT(L) + 1
         89 |      DMEAN(L) = DMEAN(L) + TDIF
         90 |      RMSTD(L) = RMSTD(L) + TDIF*TDIF
         91 |      TS(L) = TS(L) + TDIF * XSTO
         92 |      IF(ABS(TDIF).LE.TDMAX(L)) GO TO 6
         93 |      TDMAX(L) = ABS(TDIF)
         94 |    6 CONTINUE
         95 |    7 CONTINUE
         96 |      RETURN
         97 |      END
 
>>>>> ATTRIBUTE AND CROSS REFERENCE SECTION <<<<<
 
 
 
IDENTIFIER NAME                  CROSS REFERENCE AND ATTRIBUTES
 
abs                              Pure Intrinsic
                                 0-66.14  0-87.10  0-92.10  0-93.18
 
adabat                           Subroutine
                                 0-1.18$
 
cmax                             Automatic, Real(4), Offset: 0, Alignment: full word
                                 0-54.7@  0-67.7@  0-67.18
 
cmean                            Automatic, Real(4), Offset: 0, Alignment: full word
                                 0-55.7@  0-68.7@  0-68.15  0-78.24@  0-78.32
 
cor                              Automatic, Real(4), Offset: 0, Alignment: full word
                                 0-65.7@  0-66.18  0-70.25  0-71.21
 
dmean                            Static, Real(4) (1:16), Offset: 0, Alignment: full word
                                 0-40.17$  0-41.19*  0-89.7@  0-89.18
 
dpt                              Automatic, Real(4), Offset: 0, Alignment: full word
                                 0-61.7@  0-62.10  0-65.17
 
float                            Pure Intrinsic
                                 0-78.40
 
iblk1d                           Parameter, Integer(4)
                                 1-58.9$  1-60.30
 
iblk1wrk                         Parameter, Integer(4)
                                 1-60.9$
 
iblk2d                           Parameter, Integer(4)
                                 1-59.9$  1-61.30
 
iblk2wrk                         Parameter, Integer(4)
                                 1-61.9$
 
ibpor                            Parameter, Integer(4)
                                 1-9.13$  1-10.25
 
ibpw                             Parameter, Integer(4)
                                 1-8.13$  1-10.33
 
iijkmax                          Parameter, Integer(4)
                                 1-49.13$  1-56.47
 
iijmax                           Parameter, Integer(4)
                                 1-17.13$  1-49.31  1-56.21  1-60.21
 
iijmaxb                          Parameter, Integer(4)
                                 1-18.13$  1-51.21
 
iijrad                           Parameter, Integer(4)
                                 1-19.13$  1-57.30  1-61.21
 
iiwordsb                         Parameter, Integer(4)
                                 1-51.9$
 
ijcap                            Parameter, Integer(4)
                                 1-20.13$
 
ikm                              Parameter, Integer(4)
                                 1-22.13$  0-37.22  1-49.25  1-52.21  1-53.25  1-57.39  1-58.26  1-59.26
 
ikmp1                            Parameter, Integer(4)
                                 1-52.9$
 
ilatg2                           Parameter, Integer(4)
                                 1-12.13$  1-47.25
 
ilbch                            Parameter, Integer(4)
                                 1-24.13$
 
ilbhi                            Parameter, Integer(4)
                                 1-25.13$
 
ilbui                            Parameter, Integer(4)
                                 1-26.13$
 
ilbuo                            Parameter, Integer(4)
                                 1-27.13$
 
ilbvi                            Parameter, Integer(4)
                                 1-28.13$
 
ilbvo                            Parameter, Integer(4)
                                 1-29.13$
 
ilevh                            Parameter, Integer(4)
                                 1-13.13$  1-46.46
 
ilevs                            Parameter, Integer(4)
                                 1-14.13$  1-46.38
 
ilmout                           Parameter, Integer(4)
                                 1-30.13$
 
ilonf                            Parameter, Integer(4)
                                 1-15.13$  1-46.25  1-54.21
 
ilonfp1                          Parameter, Integer(4)
                                 1-54.9$
 
ilvltot                          Parameter, Integer(4)
                                 1-53.9$  1-55.21
 
imaxoutf                         Parameter, Integer(4)
                                 1-32.13$
 
imaxoutt                         Parameter, Integer(4)
                                 1-33.13$
 
imaxoutv                         Parameter, Integer(4)
                                 1-34.13$
 
imaxprof                         Parameter, Integer(4)
                                 1-35.13$
 
imaxscr                          Parameter, Integer(4)
                                 1-56.9$
 
infiller                         Parameter, Integer(4)
                                 1-36.13$  1-56.62
 
ingrdus1                         Parameter, Integer(4)
                                 1-39.13$
 
ingrduse                         Parameter, Integer(4)
                                 1-38.13$
 
inh                              Parameter, Integer(4)
                                 1-37.13$  1-48.30
 
iniaddrs                         Parameter, Integer(4)
                                 1-40.13$
 
inlat                            Parameter, Integer(4)
                                 1-47.13$
 
inlatsh                          Parameter, Integer(4)
                                 1-16.13$  1-47.34
 
inscr                            Parameter, Integer(4)
                                 1-41.13$  1-56.29
 
inscr3                           Parameter, Integer(4)
                                 1-43.13$  1-56.55
 
inscrgeo                         Parameter, Integer(4)
                                 1-42.13$  1-56.35
 
inshem                           Parameter, Integer(4)
                                 1-48.13$
 
insigstp                         Parameter, Integer(4)
                                 1-46.13$
 
insoil                           Parameter, Integer(4)
                                 1-44.13$
 
inspecs                          Parameter, Integer(4)
                                 1-11.13$
 
insumg                           Parameter, Integer(4)
                                 1-45.13$  1-55.31
 
inumrec                          Parameter, Integer(4)
                                 1-10.13$
 
invbl                            Parameter, Integer(4)
                                 1-55.9$
 
iradwrk                          Parameter, Integer(4)
                                 1-57.9$
 
isto                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-1.31  0-46.11
 
iter                             Automatic, Integer(4), Offset: 0, Alignment: full word
                                 0-52.7@  0-74.7@  0-77.10
 
itx                              Automatic, Integer(4), Offset: 0, Alignment: full word
                                 0-53.7@  0-58.16
 
iwpcpl                           Parameter, Integer(4)
                                 1-21.13$  1-57.21
 
l                                Automatic, Integer(4), Offset: 0, Alignment: full word
                                 0-48.12@  0-49.10  0-49.24  0-50.10  0-50.18  0-50.24  0-60.12@  0-61.16  0-61.24  0-66.30  0-66.36
                                 0-69.30  0-70.10  0-70.20  0-71.10  0-71.18  0-84.12@  0-85.17  0-85.25  0-86.24  0-88.14  0-88.26
                                 0-89.13  0-89.24  0-90.13  0-90.24  0-91.10  0-91.18  0-92.29  0-93.13
 
levmax                           Automatic, Integer(4), Offset: 0, Alignment: full word
                                 0-57.7@  0-69.21@
 
lmax                             Parameter, Integer(4)
                                 0-37.17$  0-38.21  0-38.32  0-39.21  0-39.32  0-39.47  0-40.24  0-40.38  0-40.52  0-41.26  0-41.35
                                 0-42.25  0-42.36  0-43.15  0-48.17  0-84.16
 
lmaxm1                           Automatic, Integer(4), Offset: 0, Alignment: full word
                                 0-43.7@  0-60.16
 
max                              Pure Intrinsic
                                 0-67.14
 
n                                Automatic, Integer(4), Offset: 0, Alignment: full word
                                 0-58.12@  0-74.14
 
ncnt                             Automatic, Integer(4), Offset: 0, Alignment: full word
                                 0-56.7@  0-64.7@  0-64.14  0-69.10  0-78.11  0-78.46
 
ncount                           Static, Integer(4) (1:16), Offset: 0, Alignment: full word
                                 0-39.39$  0-41.12*  0-88.7@  0-88.19
 
nhs                              Automatic, Integer(4), Offset: 0, Alignment: full word
                                 0-59.7@  0-63.7@  0-63.13  0-73.10
 
pi                               Automatic, Real(4) (1:16), Offset: 0, Alignment: full word
                                 0-39.28$  0-49.7@  0-50.21  0-66.27  0-66.33  0-85.22
 
ps                               Reference argument, Real(4) (1:16), Offset: 0, Alignment: full word
                                 0-38.28$  0-1.28  0-49.21
 
pt                               Automatic, Real(4) (1:16), Offset: 0, Alignment: full word
                                 0-39.17$  0-50.7@  0-61.13  0-61.21  0-70.7@  0-70.17  0-71.7@  0-71.15  0-85.14
 
rmstd                            Static, Real(4) (1:16), Offset: 0, Alignment: full word
                                 0-40.31$  0-42.12*  0-90.7@  0-90.18
 
rocp                             Automatic, Real(4), Offset: 0, Alignment: full word
                                 0-44.7@  0-49.31
 
tcor                             Automatic, Real(4), Offset: 0, Alignment: full word
                                 0-66.7@  0-67.23  0-68.23
 
tdif                             Automatic, Real(4), Offset: 0, Alignment: full word
                                 0-86.7@  0-87.14  0-89.29  0-90.29  0-90.34  0-91.23  0-92.14  0-93.22
 
tdmax                            Static, Real(4) (1:16), Offset: 0, Alignment: full word
                                 0-40.45$  0-42.18*  0-92.23  0-93.7@
 
tnew                             Automatic, Real(4), Offset: 0, Alignment: full word
                                 0-85.7@  0-86.14
 
ts                               Reference argument, Real(4) (1:16), Offset: 0, Alignment: full word
                                 0-38.17$  0-1.25  0-50.15  0-86.21  0-91.7@  0-91.15
 
xsto                             Automatic, Real(4), Offset: 0, Alignment: full word
                                 0-45.7@  0-46.24@  0-91.30
 
** adabat   === End of Compilation 1 ===
 
>>>>> FILE TABLE SECTION <<<<<
 
 
                                       FILE CREATION        FROM
FILE NO   FILENAME                    DATE       TIME       FILE    LINE
     0    ADABAT.f                    10/09/02   12:46:05
     1    /gpfs/m/nco/ops/nwprod/sorc/ngm_nam2ngm.fd/parmodel
                                      02/09/00   18:03:04      0      36
 
 
>>>>> COMPILATION EPILOGUE SECTION <<<<<
 
 
FORTRAN Summary of Diagnosed Conditions
 
TOTAL   UNRECOVERABLE  SEVERE       ERROR     WARNING    INFORMATIONAL
               (U)       (S)         (E)        (W)          (I)
    0           0         0           0          0            0
 
 
    Source records read.......................................     159
1501-510  Compilation successful for file ADABAT.f.
1501-543  Object file created.
