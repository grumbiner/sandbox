IBM XL Fortran Enterprise Edition V10.1 for AIX (5724-M13)  Version 10.01.0000.0002 --- /gpfs/m/nco/ops/nwprod/sorc/ngm_rgcinp.fd/GRIBST.f 09/30/06 19:45:36
 
>>>>> OPTIONS SECTION <<<<<
***   Options In Effect   ***
  
         ==  On / Off Options  ==
         CR              DBG             DDIM            ESCAPE
         FULLPATH        I4              NOLIBESSL       NOLIBPOSIX
         OBJECT          SOURCE          STDFRAMEWORK    STRICT
         SWAPOMP         THREADED        UNWIND          NOZEROSIZE
  
         ==  Options Of Integer Type ==
         FIXED(72)             MAXMEM(-1)            OPTIMIZE(2)
         SPILLSIZE(548)        STACKTEMP(0)
  
         ==  Options Of Character Type  ==
         64(LARGETYPE)         ALIAS(STD,INTPTR)     ALIGN(BINDC(POWER),STRUCT(NATURAL))
         ARCH(PWR3)            ATTR()                AUTODBL(NONE)
         DIRECTIVE(IBM*,IBMT)  ENUM()                FLAG(I,I)
         FLOAT(RNDSNGL,MAF,FOLD,RNGCHK)
         FLTTRAP(OVERFLOW,ZERODIVIDE,INVALID,ENABLE)
         HALT(S)               IEEE(NEAR)            INITAUTO(FF      )
         INTSIZE(4)            LANGLVL(EXTENDED)     POSITION(APPENDOLD)
         REALSIZE(4)           SAVE(ALL)             SIGTRAP()
         TUNE(PWR3)            UNROLL(AUTO)          XREF(FULL)
         XLF77(NOLEADZERO,GEDIT77,NOBLANKPAD,OLDBOZ,INTARG,INTXOR,PERSISTENT,SOFTEOF)
         XLF90(NOSIGNEDZERO,NOAUTODEALLOC)
  
>>>>> SOURCE SECTION <<<<<
          1 |C$$$  sub  PROGRAM DOCUMENTATION BLOCK
          2 |C                .      .    .                                       .
          3 |C sub  PROGRAM:  gribst      UNPACK GLOBAL Grib SST
          4 |C   PRGMMR: GERALD           ORG: W/NMC21     DATE: 95-08-01
          5 |C
          6 |C ABSTRACT: DECODES GLOBAL AVN, FNL, OR MRF GRIB GRIDDED FIELDS.
          7 |C
          8 |C PROGRAM HISTORY LOG:
          9 |C   95-08-01  GERALD
         10 |C   96-07-23  PETERS - UPDATED FOR USE WITH ETA MODEL, GETS
         11 |C                      REYNOLDS 1X1 OISST
         12 |C
         13 |C
         14 |C USAGE:
         15 |C   INPUT FILES:
         16 |C     DDNAME1  - GENERIC NAMES & USAGE
         17 |C     FTNNF001 - START IN COL 7
         18 |C              - BUT TAB CONTINUATIONS TO LINE UP LIKE THIS
         19 |C     FXN      - LINE UP DASHES WHEN DESCRIBING FILES
         20 |C     TAPENN   - CRAY TYPE DESIGNATION
         21 |C     UNITNN   - CRAY TYPE DESIGNATION
         22 |C     PARM     - IF PARM FIELD IS USED, DESCRIBE HERE
         23 |C
         24 |C   OUTPUT FILES:  (INCLUDING SCRATCH FILES)
         25 |C     FTMMF001 - NAMES & USAGE AS ABOVE IN THE INPUT SECTION
         26 |C     FT06F001 - INCLUDE IF ANY PRINTOUT
         27 |C
         28 |C   SUBPROGRAMS CALLED: (LIST ALL CALLED FROM ANYWHERE IN CODES)
         29 |C     UNIQUE:    - ROUTINES THAT ACCOMPANY SOURCE FOR COMPILE
         30 |C     LIBRARY:
         31 |C       COMMON   - LIST COMMON LIBRARY ROUTINES, E.G., CONSOL
         32 |C       W3LIB    -
         33 |C       W4LIB    - DELETE THE CORRESPONDING LINE OR LINES
         34 |C       GRAPHICS - IF LIBRARY IS UNNEEDED
         35 |C
         36 |C   EXIT STATES:
         37 |C     COND =   0 - SUCCESSFUL RUN
         38 |C          =NNNN - TROUBLE OR SPECIAL FLAG - SPECIFY NATURE
         39 |C
         40 |C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
         41 |C
         42 |C ATTRIBUTES:
         43 |C   LANGUAGE: INDICATE EXTENSIONS, COMPILER OPTIONS
         44 |C   MACHINE:  CRAY
         45 |C
         46 |C$$$
         47 |C
         48 |      subroutine gribst(insst,indxst,gsst,ierr)
         49 |c
         50 |      Parameter(jf=360*180)
         51 |      INTEGER PDS,GDS,GRID
         52 |      INTEGER JPDS(25),JGDS(22),IGRD(5,3)
         53 |      INTEGER KPDS(25),KGDS(22)
         54 |      REAl FLD(jf),out(360,180)
         55 |      dimension gsst(361,180)
         56 |      logical lb(jf)
         57 |      equivalence(out(1,1),fld(1))
         58 |c
         59 |C
         60 |C                sst
         61 |      DATA IGRD/ 11, 34,  2, 52, 11,
         62 |     *            1,105,102,105,105,
         63 |     *            0, 10,  0,  2,  2/
         64 |c
         65 |C            INPUT UNITS FOR DECODING GRIB FILE
         66 |C
         67 |          LUGB=INSST
         68 |          LUGI=INDXST
         69 |          ierr = 0
         70 |          j = 0
         71 |C
         72 |C........    DECODE THE FIELDS
         73 |C
         74 |        DO 30 GRID = 1,1
         75 |C
         76 |          DO 10 PDS=1,25
         77 |          JPDS(PDS) = -1
         78 |   10      CONTINUE
         79 |C
         80 |             DO 20 GDS = 1,22
         81 |           JGDS(GDS) = -1
         82 |   20     CONTINUE
         83 |C
         84 |C........   GET SELECT FIELDS
         85 |C
         86 |           jPDS(5) = IGRD(GRID,1)
         87 |           jPDS(6) = IGRD(GRID,2)
         88 |           jPDS(7) = IGRD(GRID,3)
         89 |C
         90 |             print *,'call getgb'
         91 |           LUGI = 0
         92 |           CALL GETGB(LUGB,LUGI,JF,j,JPDS,JGDS,
         93 |     *                          KF,K,KPDS,KGDS,LB,Fld,IRET)
         94 |C
         95 |          IF(IRET.NE.0) THEN
         96 |            ierr = 1
         97 |            WRITE(6,60)IRET
         98 |            GO TO 999
         99 |          ENDIF
        100 |   60  FORMAT(1X,' IRET =',I5)
        101 |C
        102 |c..   flip grid to PT(1,1) =(0e,-90.0)
        103 |c
        104 |              do  jj= 1,180
        105 |                do  kk= 1,360
        106 |                 gsst(kk,180-jj+1) = out(kk,jj)
        107 |                end do
        108 |              end do
        109 |c
        110 |c...   add greenich to right side of grid
        111 |c
        112 |             do jj = 1,180
        113 |               gsst(361,jj) = gsst(1,jj)
        114 |             end do
        115 |c
        116 |            WRITE(6,61)KPDS,KF,KGDS
        117 |   61  FORMAT(2(/,2X,'PDS=',13I7),2(/,2X,' GDS=',11I7 ))
        118 |C
        119 |   30        CONTINUE
        120 |C
        121 |  999           CONTINUE
        122 |             return
        123 |             END
 
>>>>> ATTRIBUTE AND CROSS REFERENCE SECTION <<<<<
 
 
 
IDENTIFIER NAME                  CROSS REFERENCE AND ATTRIBUTES
 
fld                              Static, Real(4) (1:64800), Offset: 0, Alignment: quadruple word
                                 0-54.12$  0-57.28  0-93.51
 
gds                              Static, Integer(4), Offset: 0, Alignment: full word
                                 0-51.19$  0-80.20@  0-81.17
 
getgb                            External Subroutine
                                 0-92.17
 
gribst                           Subroutine
                                 0-48.18$
 
grid                             Static, Integer(4), Offset: 0, Alignment: full word
                                 0-51.23$  0-74.15@  0-86.27  0-87.27  0-88.27
 
gsst                             Reference argument, Real(4) (1:361, 1:180), Offset: 0, Alignment: full word
                                 0-55.17$  0-48.38  0-106.18@  0-113.16@  0-113.31
 
ierr                             Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-48.43  0-69.11@  0-96.13@
 
igrd                             Static, Integer(4) (1:5, 1:3), Offset: 0, Alignment: full word
                                 0-52.33$  0-61.12*  0-86.22  0-87.22  0-88.22
 
indxst                           Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-48.31  0-68.16
 
insst                            Reference argument, Integer(4), Offset: 0, Alignment: full word
                                 0-48.25  0-67.16
 
iret                             Static, Integer(4), Offset: 0, Alignment: full word
                                 0-93.55  0-95.14  0-97.24
 
j                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-70.11@  0-92.36
 
jf                               Parameter, Integer(4)
                                 0-50.17$  0-54.16  0-56.18  0-92.33
 
jgds                             Static, Integer(4) (1:22), Offset: 0, Alignment: full word
                                 0-52.24$  0-81.12@  0-92.43
 
jj                               Static, Integer(4), Offset: 0, Alignment: full word
                                 0-104.19@  0-106.30  0-106.45  0-112.17@  0-113.25  0-113.38
 
jpds                             Static, Integer(4) (1:25), Offset: 0, Alignment: full word
                                 0-52.15$  0-77.11@  0-86.12@  0-87.12@  0-88.12@  0-92.38
 
k                                Static, Integer(4), Offset: 0, Alignment: full word
                                 0-93.36
 
kf                               Static, Integer(4), Offset: 0, Alignment: full word
                                 0-93.33  0-116.29
 
kgds                             Static, Integer(4) (1:22), Offset: 0, Alignment: full word
                                 0-53.24$  0-93.43  0-116.32
 
kk                               Static, Integer(4), Offset: 0, Alignment: full word
                                 0-105.21@  0-106.23  0-106.42
 
kpds                             Static, Integer(4) (1:25), Offset: 0, Alignment: full word
                                 0-53.15$  0-93.38  0-116.24
 
lb                               Static, Logical(4) (1:64800), Offset: 0, Alignment: full word
                                 0-56.15$  0-93.48
 
lugb                             Static, Integer(4), Offset: 0, Alignment: full word
                                 0-67.11@  0-92.23
 
lugi                             Static, Integer(4), Offset: 0, Alignment: full word
                                 0-68.11@  0-91.12@  0-92.28
 
out                              Static, Real(4) (1:360, 1:180), Offset: 0, Alignment: quadruple word
                                 0-54.20$  0-57.19  0-106.38
 
pds                              Static, Integer(4), Offset: 0, Alignment: full word
                                 0-51.15$  0-76.17@  0-77.16
 
** gribst   === End of Compilation 1 ===
 
>>>>> FILE TABLE SECTION <<<<<
 
 
                                       FILE CREATION        FROM
FILE NO   FILENAME                    DATE       TIME       FILE    LINE
     0    GRIBST.f                    10/10/02   16:14:55
 
 
>>>>> COMPILATION EPILOGUE SECTION <<<<<
 
 
FORTRAN Summary of Diagnosed Conditions
 
TOTAL   UNRECOVERABLE  SEVERE       ERROR     WARNING    INFORMATIONAL
               (U)       (S)         (E)        (W)          (I)
    0           0         0           0          0            0
 
 
    Source records read.......................................     123
1501-510  Compilation successful for file GRIBST.f.
1501-543  Object file created.
