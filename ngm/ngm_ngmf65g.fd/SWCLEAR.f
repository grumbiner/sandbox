      SUBROUTINE SWCLEAR
C
C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C
C SUBPROGRAM:    SWCLEAR     TO COMPUTE CLEAR SKY SW RADIATION
C   PRGMMR: J TUCCILLO       ORG: W/NMC4     DATE: 90-06-17
C
C ABSTRACT:    COMPUTES CLEAR SKY SHORTWAVE RADIATION
C   .
C PROGRAM HISTORY LOG:
C   90-06-17  J TUCCILLO
C
C USAGE:  CALL SWCLEAR
C   SUBPROGRAMS CALLED:
C     LIBRARY:
C       COMMON   - BLANK COMMON
C
C REMARKS:
C   - - - - - - - - I N P U T   V A R I A B L E S  - - - - - - - - -
C   .
C   NAMES       MEANING/CONTENT/PURPOSE/UNITS/TYPE        INTERFACE
C   -----       ----------------------------------        ---------
C   .
C   .             INFORMATION PASSED THROUGH COMMON
C   .
C   - - - - - - - - O U T P U T   V A R I A B L E S - - - - - - - - - -
C   .
C   NAMES       MEANING/CONTENT/PURPOSE/UNITS/TYPE        INTERFACE
C   -----       ----------------------------------        ---------
C   .
C   .             INFORMATION PASSED THROUGH COMMON
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN
C   MACHINE:  CRAY Y-MP
C
C$$$
C
      INCLUDE 'parmodel'
C
      PARAMETER (NIM= IIJRAD, NJM=46, NLM= IKM, NLS=02)
      PARAMETER (NNQFDS=5, NOFDS=2, NQIFDS=5, NOIFDS=8
     *,      NNQP3=21, NNQP2=59, N2DFDS=29, NEQO3O=01)
      PARAMETER (NIMP1=NIM+1,NIMP2=NIM+2,NIMP3=NIM+3,NIMD2=NIM/2+1/NIM
     *,     NLMM2=NLM-2, NLSP1=NLS+1, LMM1T2=(NLM-1)*2
     *,     IMD2P1=NIM/2+1, NJMM2=NJM-2, NLMP1=NLM+1, NLMM1=NLM-1
     *,     N1=NLM*NQIFDS+NOIFDS
     *,     N2=NLM*NNQFDS+NOFDS, N3=NIMP2*N2
     *,     NIMT2=NIM*2,N6=NIMP2*N1,NILPT=NIM*NLM
     *,     NNQPFD = NNQP3 + (NNQP2-1)/NLM + 1
     *,     NN5= NNQP3+ (NNQP2+(N2DFDS*NIM-1)/NIMP2)/NLM + 3
     *,     NN6 = NN5*NLM,NN1 = N1 - 1
     *,     N5= NIMP2*NN6, NTDSG =NLM-NLSP1
     *,     NNBITX=NIM*NLM
     *,     NPG=(NN1*NIMP2*NJMM2-1)/131072 + 1
     *,     N55=N5-2*NLM*NIMP2
     *,     NTL=(N55*NJMM2-1)/131072 + 1)
C
      PARAMETER (NNP=NLMP1+1,IMLMP1=NIM*NLMP1,IMNNP=NIM*NNP
     *,          ILP1=NIM*NLMP1)
C...TRANSLATED BY FPP 3.00Z36 11/09/90  14:57:33  
C...SWITCHES: OPTON=I47,OPTOFF=VAE0
C
      DIMENSION FK(5),XK(5)
C
      LOGICAL BITX(ILP1), BITC(IMNNP), BITD(IMNNP)
C
      COMMON  IM,NP,NPP1,LMP1,LS1,LS,NSOL,NSOLP1,NSLMP1,NSOLNP,DOOZ
     *,       SQRT3,GG,GGP,GGSQ,NCLD,NCLDP1,NCLMP1,NCLDNP,RCN1
     *,       ATHRD,TTHRD,RCN2
     *,       PU(IMNNP),TA(IMLMP1),WA(IMLMP1),OA(IMLMP1),E0(IMLMP1)
     *,       DP(IMLMP1),DPC(IMLMP1),W(IMNNP),DN(IMNNP),UP(IMNNP)
     *,       AG(NIM),RSURF(NIM),AGCD(NIM),RSRCD(NIM),VM(IMNNP)
     *,       SCOSZ(NIM),CMU(NIM),COSMAG(NIM),CSMCLD(NIM),SCZCD(NIM)
     *,       CMUC(NIM),SCOSC(NIM),CSS(IMLMP1),CCU(IMLMP1),VP(IMNNP)
     *,       SL(NIM),ACLR(IMLMP1),DSCLR(NIM),SC(NIM),ACLD(ILP1)
     *,       TAUC(IMLMP1),TAUT(NIM),RCO(NIM),RCG(NIM),CM(IMNNP)
     *,       OZALE(IMNNP),OZCD(IMNNP),RLO(NIM),RLG(NIM),DL(IMNNP)
     *,       SWIL(IMLMP1),SWALE(IMNNP),SWILC(IMLMP1),DEN(IMLMP1)
     *,       F2(IMLMP1),CR(IMNNP),E2(IMLMP1)
     *,       U1(IMLMP1),AK(IMLMP1),DA(IMLMP1),DB(IMLMP1)
     *,       ALF1(IMLMP1),ALF2(IMLMP1)
     *,       UL(IMNNP)
     *,       SOL(IMNNP),DSCLD(NIM),BITX,BITC,BITD
C
      LOGICAL DOOZ
C
      INTEGER ISYS,I,I1X
      REAL TMP,V,TMP1X,V1X
      PARAMETER (ISYS = 1)
C
      DATA FK/0.107E0,0.104E0,0.073E0,0.044E0,0.025E0/
      DATA XK/0.005E0,0.041E0,0.416E0,4.752E0,72.459E0/
C
      LP = LMP1 * NSOL + 1
CMIC$ PARALLEL SHARED(LMP1, NSOL, SCOSZ, DEN, NSLMP1, ACLR, SL, DN)
CMIC$1    PRIVATE(L, L0, IQ2W6E)
CMIC$ DO PARALLEL VECTOR
      DO 88890 IQ2W6E=1,NSOL
         SL(IQ2W6E)=0.0E0
         DN(IQ2W6E)=0.0E0
88890 CONTINUE
C
CMIC$ DO PARALLEL VECTOR
      DO 88910 IQ2W6E=1,NSLMP1
         ACLR(IQ2W6E)=0.0E0
88910 CONTINUE
C
CMIC$ DO PARALLEL
      DO 10 L=1,LMP1
      L0 = (L-1) * NSOL + 1
      DO 88920 IQ2W6E=1,NSOL
         DEN(L0+IQ2W6E-1)=SCOSZ(IQ2W6E)
88920 CONTINUE
   10 CONTINUE
CMIC$ END PARALLEL
C
      IF (DOOZ) THEN
CMIC$ PARALLEL SHARED(NSLMP1, W, E0, VP, NP, NSOL, OZALE, COSMAG)
CMIC$1    PRIVATE(IQ2W6E, L, L0, L1)
CMIC$ DO PARALLEL
         DO 40 L=2,NP
         L0 = (L-2) * NSOL + 1
         L1 = (L-1) * NSOL + 1
      DO 88930 IQ2W6E=1,NSOL
         W(L0+IQ2W6E-1)=OZALE(L1+IQ2W6E-1)*COSMAG(IQ2W6E)
88930 CONTINUE
   40    CONTINUE
C
CMIC$ DO PARALLEL VECTOR
      DO 88940 IQ2W6E=1,NSLMP1
         E0(IQ2W6E)=(103.63E0*W(IQ2W6E)) ** 3
         VP(IQ2W6E)=1.0E0+138.57E0*W(IQ2W6E)
88940 CONTINUE
CMIC$ END PARALLEL
C*****  Code Expanded From Routine:  RDEXP805
CMIC$ DO ALL VECTOR SHARED(NSLMP1, VP, CM) PRIVATE(I)
      DO 77002 I = 1, NSLMP1
         CM(I) = VP(I)**0.8046875
77002 CONTINUE
C*****  End of Code Expanded From Routine:  RDEXP805
CMIC$ PARALLEL SHARED(NSLMP1,NSOLP1,DN,DEN,ACLR,W,CM,E0)PRIVATE(IQ2W6E)
CMIC$ DO PARALLEL VECTOR
      DO 88970 IQ2W6E=1,NSLMP1
         DN(NSOLP1+IQ2W6E-1)=0.02118E0*W(IQ2W6E)/(1.0E0+0.042E0*W
     *   (IQ2W6E)+0.000323E0*W(IQ2W6E)*W(IQ2W6E))+1.08173E0*W(IQ2W6E)/
     *   CM(IQ2W6E)+0.0658E0*W(IQ2W6E)/(1.0E0+E0(IQ2W6E))
88970 CONTINUE
C
C        COMPUTE OZONE HEATING ON THE WAY DOWN
C
CMIC$ DO PARALLEL VECTOR
      DO 88980 IQ2W6E=1,NSLMP1
         ACLR(IQ2W6E)=(DN(NSOLP1+IQ2W6E-1)-DN(IQ2W6E))*DEN(IQ2W6E)
88980 CONTINUE
CMIC$ END PARALLEL
      ELSE
CMIC$ DO ALL VECTOR SHARED(NSOL, LP, DN) PRIVATE(IQ2W6E)
      DO 88990 IQ2W6E=1,NSOL
         DN(LP+IQ2W6E-1)=0.0E0
88990 CONTINUE
      END IF
C
C     GROUND ABSORPTION FOR WAVELENGTHS UNDER 0.9 MICRONS
C
CMIC$ DO ALL VECTOR SHARED(NSOL, LP, DN, RLG, SCOSZ, SL) PRIVATE(IQ2W6E)
      DO 89000 IQ2W6E=1,NSOL
         SL(IQ2W6E)=(0.647E0-DN(LP+IQ2W6E-1))*(1.0E0-RLG(IQ2W6E))*SCOS
     *   Z(IQ2W6E)
89000 CONTINUE
C
      IF (DOOZ) THEN
CMIC$ PARALLEL SHARED(NSLMP1, OZALE, W, NSOL, LP, DN, UP, COSMAG)
CMIC$1    PRIVATE(IQ2W6E)
CMIC$ DO PARALLEL VECTOR
      DO 89010 IQ2W6E=1,NSOL
         UP(LP+IQ2W6E-1)=DN(LP+IQ2W6E-1)
         W(LP+IQ2W6E-1)=OZALE(LP+IQ2W6E-1)*(1.90E0+COSMAG(IQ2W6E))
89010 CONTINUE
C
CMIC$ DO PARALLEL VECTOR
      DO 89030 IQ2W6E=1,NSLMP1
         W(IQ2W6E)=1.9E0*OZALE(IQ2W6E)
89030 CONTINUE
CMIC$ END PARALLEL
C
         DO 80 L=1,LMP1
         L0 = (L-1) * NSOL + 1
CMIC$ DO ALL VECTOR IF (ABS(LP-L0).GE.NSOL .OR. LP-L0.EQ.0) SHARED(NSOL
CMIC$1   , LP, L0, W) PRIVATE(IQ2W6E)
      DO 89040 IQ2W6E=1,NSOL
         W(L0+IQ2W6E-1)=W(LP+IQ2W6E-1)-W(L0+IQ2W6E-1)
89040 CONTINUE
   80    CONTINUE
C
CMIC$ DO ALL VECTOR SHARED(NSLMP1, W, E0, VP) PRIVATE(IQ2W6E)
      DO 89050 IQ2W6E=1,NSLMP1
         E0(IQ2W6E)=(103.63E0*W(IQ2W6E)) ** 3
         VP(IQ2W6E)=1.0E0+138.57E0*W(IQ2W6E)
89050 CONTINUE
C*****  Code Expanded From Routine:  RDEXP805
CMIC$ DO ALL VECTOR SHARED(NSLMP1, VP, CM) PRIVATE(I1X)
      DO 77004 I1X = 1, NSLMP1
         CM(I1X) = VP(I1X)**0.8046875
77004 CONTINUE
C*****  End of Code Expanded From Routine:  RDEXP805
CMIC$ PARALLEL SHARED(NSLMP1, ACLR, LMP1, NSOL, W, RLO, SCOSZ, NSOLP1, 
CMIC$1   UP, CM, E0) PRIVATE(IQ2W6E, L, L0)
CMIC$ DO PARALLEL VECTOR
      DO 89080 IQ2W6E=1,NSLMP1
         UP(IQ2W6E)=0.02118E0*W(IQ2W6E)/(1.0E0+0.042E0*W(IQ2W6E)+0.000
     *   323E0*W(IQ2W6E)*W(IQ2W6E))+1.08173E0*W(IQ2W6E)/CM(IQ2W6E)+0.0
     *   658E0*W(IQ2W6E)/(1.0E0+E0(IQ2W6E))
89080 CONTINUE
C
C     COMPUTE OZONE HEATING ON THE WAY UP
C
CMIC$ DO PARALLEL VECTOR
      DO 89090 IQ2W6E=1,NSLMP1
         W(IQ2W6E)=UP(IQ2W6E)-UP(NSOLP1+IQ2W6E-1)
89090 CONTINUE
CMIC$ DO PARALLEL
         DO 90 L=1,LMP1
         L0 = (L-1) * NSOL + 1
      DO 89100 IQ2W6E=1,NSOL
         ACLR(L0+IQ2W6E-1)=ACLR(L0+IQ2W6E-1)+W(L0+IQ2W6E-1)*RLO(IQ2W6E
     *   )*SCOSZ(IQ2W6E)
89100 CONTINUE
   90    CONTINUE
C
CMIC$ DO PARALLEL VECTOR
      DO 89110 IQ2W6E=1,NSLMP1
         IF (ACLR(IQ2W6E).LT.0.0E0) THEN
             ACLR(IQ2W6E) = 0.0E0
         END IF
89110 CONTINUE
CMIC$ END PARALLEL
      END IF
C
C     CYCLE OVER FIVE BANDS
C
      DO 170 IK=1,5
C
CMIC$ PARALLEL SHARED(NSLMP1, SQRT3, IK, SWALE, XK, W, NSOL, LP, SL, DN
CMIC$1   , RSURF, SCOSZ, FK, UP, COSMAG, NSOLP1, ACLR, DEN, NSOLNP, NP)
CMIC$2    PRIVATE(IQ2W6E, L, L0)
CMIC$ DO PARALLEL
      DO 110 L=1,NP
      L0 = (L-1) * NSOL + 1
      DO 89120 IQ2W6E=1,NSOL
         W(L0+IQ2W6E-1)=SWALE(L0+IQ2W6E-1)*COSMAG(IQ2W6E)
89120 CONTINUE
  110 CONTINUE
CMIC$ DO PARALLEL VECTOR
      DO 89130 IQ2W6E=1,NSOLNP
         DN(IQ2W6E)=EXP(-W(IQ2W6E)*XK(IK))
89130 CONTINUE
C
C     COMPUTE WATER VAPOR HEATING ON THE WAY DOWN
C
CMIC$ DO PARALLEL VECTOR
      DO 89150 IQ2W6E=1,NSLMP1
         ACLR(IQ2W6E)=ACLR(IQ2W6E)+
     *       (DN(IQ2W6E)-DN(NSOLP1+IQ2W6E-1))*FK(IK)*DEN(IQ2W6E)
89150 CONTINUE
C
C     GROUND ABSORPTION FOR WAVELENGTHS OVER 0.9 MICRONS
C
CMIC$ DO PARALLEL VECTOR
      DO 89180 IQ2W6E = 1, NSOL
         SL(IQ2W6E) = SL(IQ2W6E) + DN(LP+IQ2W6E-1)*(1.0E0-RSURF(IQ2W6E))
     1      *SCOSZ(IQ2W6E)*FK(IK)
         UP(LP+IQ2W6E-1) = DN(LP+IQ2W6E-1)
         W(LP+IQ2W6E-1) = SWALE(LP+IQ2W6E-1)*(SQRT3+COSMAG(IQ2W6E))*XK(
     1      IK)
89180 CONTINUE
C
CMIC$ DO PARALLEL VECTOR
      DO 89210 IQ2W6E=1,NSLMP1
         W(IQ2W6E)=SQRT3*SWALE(IQ2W6E)*XK(IK)
89210 CONTINUE
CMIC$ END PARALLEL
      DO 150 L=1,LMP1
      L0 = (L-1) * NSOL + 1
CMIC$ DO ALL VECTOR IF (ABS(L0-LP).GE.NSOL .OR. L0-LP.EQ.0) SHARED(NSOL
CMIC$1   , L0, LP, W) PRIVATE(IQ2W6E)
      DO 89220 IQ2W6E=1,NSOL
         W(L0+IQ2W6E-1)=W(L0+IQ2W6E-1)-W(LP+IQ2W6E-1)
89220 CONTINUE
  150 CONTINUE
CMIC$ PARALLEL SHARED(LMP1, NSOL, ACLR, W, RSURF, SCOSZ, NSLMP1, NSOLP1
CMIC$1   , IK, UP, FK) PRIVATE(L, L0, IQ2W6E)
CMIC$ DO PARALLEL VECTOR
      DO 89230 IQ2W6E=1,NSLMP1
         UP(IQ2W6E)=EXP(W(IQ2W6E))
89230 CONTINUE
C
C     COMPUTE WATER VAPOR HEATING ON THE WAY UP
C
CMIC$ DO PARALLEL VECTOR
      DO 89240 IQ2W6E=1,NSLMP1
         W(IQ2W6E)=(UP(NSOLP1+IQ2W6E-1)-UP(IQ2W6E))*FK(IK)
89240 CONTINUE
CMIC$ DO PARALLEL
      DO 160 L=1,LMP1
      L0 = (L-1) * NSOL + 1
      DO 89250 IQ2W6E=1,NSOL
         ACLR(L0+IQ2W6E-1)=ACLR(L0+IQ2W6E-1)+W(L0+IQ2W6E-1)*RSURF
     *   (IQ2W6E)*SCOSZ(IQ2W6E)
89250 CONTINUE
  160 CONTINUE
CMIC$ END PARALLEL
C
  170 CONTINUE
C
CMIC$ DO ALL VECTOR SHARED(NSOL, SL, DSCLR) PRIVATE(IQ2W6E)
      DO 89260 IQ2W6E=1,NSOL
         DSCLR(IQ2W6E)=SL(IQ2W6E)
89260 CONTINUE
C
      DO 190 L=1,LMP1
      L0 = (L-1) * NSOL + 1
CMIC$ DO ALL VECTOR SHARED(NSOL, L0, DSCLR, ACLR) PRIVATE(IQ2W6E)
      DO 89270 IQ2W6E=1,NSOL
         DSCLR(IQ2W6E)=DSCLR(IQ2W6E)+ACLR(L0+IQ2W6E-1)
89270 CONTINUE
  190 CONTINUE
C
      RETURN
      END
