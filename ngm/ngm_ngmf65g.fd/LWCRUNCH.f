      SUBROUTINE LWCRUNCH(INDX1,INDX2)
C
C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C
C SUBPROGRAM:    LWCRUNCH    TO PERFORM LW CALCULATIONS
C   PRGMMR: J TUCCILLO       ORG: W/NMC22    DATE: 90-06-13
C
C ABSTRACT:    PERFORMS LW CALCULATIONS
C   .
C
C PROGRAM HISTORY LOG:
C   90-06-13  J TUCCILLO
C   99-05-20  J TUCCILLO IBM SP VERSION, OPENMP THREADING
C
C USAGE:  CALL LWCRUNCH ( INDX1, INDX2 )
C   INPUT ARGUMENT LIST:
C     INDX1 - FIRST INDICE FOR LW CALCULATIONS
C     INDX2 - SECOND INDICE FOR LW CALCULATIONS
C
C   SUBPROGRAMS CALLED:
C     LIBRARY:
C       COMMON   - H2O
C                  BLANK
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN
C   MACHINE:  CRAY Y-MP
C
C$$$
C
      INCLUDE 'parmodel'
C
      PARAMETER (NIM= IIJRAD, NJM=46, NLM= IKM, NLS=02)
      PARAMETER (NNQFDS=5, NOFDS=2, NQIFDS=5, NOIFDS=8
     *,      NNQP3=21, NNQP2=59, N2DFDS=29, NEQO3O=01)
      PARAMETER (NIMP1=NIM+1,NIMP2=NIM+2,NIMP3=NIM+3,NIMD2=NIM/2+1/NIM
     *,     NLMM2=NLM-2, NLSP1=NLS+1, LMM1T2=(NLM-1)*2
     *,     IMD2P1=NIM/2+1, NJMM2=NJM-2, NLMP1=NLM+1, NLMM1=NLM-1
     *,     N1=NLM*NQIFDS+NOIFDS
     *,     N2=NLM*NNQFDS+NOFDS, N3=NIMP2*N2
     *,     NIMT2=NIM*2,N6=NIMP2*N1,NILPT=NIM*NLM
     *,     NNQPFD = NNQP3 + (NNQP2-1)/NLM + 1
     *,     NN5= NNQP3+ (NNQP2+(N2DFDS*NIM-1)/NIMP2)/NLM + 3
     *,     NN6 = NN5*NLM,NN1 = N1 - 1
     *,     N5= NIMP2*NN6, NTDSG =NLM-NLSP1
     *,     NNBITX=NIMP2*NLM
     *,     NPG=(NN1*NIMP2*NJMM2-1)/131072 + 1
     *,     N55=N5-2*NLM*NIMP2
     *,     NTL=(N55*NJMM2-1)/131072 + 1)
C
      PARAMETER (NNP=NLM+2, NNPP1=NNP+1, NNPBIT=NIM*NNPP1)
C...TRANSLATED BY FPP 3.00Z36 11/09/90  14:48:55  
C...SWITCHES: OPTON=I47,OPTOFF=VAE0
C
      COMMON  TXUF(NIM,NNP,NNP),CS(NIM,NNP,NNP)
     *,X1(NIM,NNPP1),X2(NIM,NNPP1),TV1(NIM,NNPP1),DP(NIM,NNP)
     *,CSS(NIM,NNP),CCU(NIM,NNP),CH(NIM,NNP),WDEL(NIM,NLMP1)
     *,ZW(NIM,NLMP1),IT(NIM,NNPP1),X4(NIM,NNP),X3(NIM,NNP)
     *,CC(NIM,NNPP1),TV2(NIM,NNPP1),TUI2(NIM,NNPP1),SHI(NIM,NNP)
     *,RAWI(NIM,NNPP1),WV(NIM,NLMP1),YV(NIM,NLMP1),TUI(NIM,NNPP1)
     *,ZV(NIM,NLMP1),WW(NIM,NLMP1),YW(NIM,NLMP1),SHU(NIM,NLMP1)
     *,SHH(NIM,NNP),SUM(NIM),FU(NIM,NLMP1),FW(NIM,NLMP1)
     *,ADEL(NIM,NLMP1),BDEL(NIM,NLMP1),SUMSAV(NIM)
C
      DIMENSION PAI(NIM,NNP),FLUXU(NIM,NNP),UBAR(NIM,NNP),VBAR(NIM,NNP)
     *,WBAR(NIM,NNP),UBARM(NIM,NNP),OZAI(NIM,NNP),WBARM(NIM,NNP)
     *,TAI(NIM,NNP),FLUXD(NIM,NNP),VBARM(NIM,NNP)
C
      EQUIVALENCE (PAI(1,1)  ,CS(1,1,1)),    (FLUXU(1,1),CS(1,1,2))
     *,           (UBAR(1,1) ,CS(1,1,3)),    (VBAR(1,1) ,CS(1,1,4))
     *,           (WBAR(1,1) ,CS(1,1,5)),    (UBARM(1,1),CS(1,1,6))
     *,           (OZAI(1,1) ,CS(1,1,7)),    (WBARM(1,1),CS(1,1,8))
     *,           (TAI(1,1)  ,CS(1,1,9)),    (FLUXD(1,1),CS(1,1,10))
     *,           (VBARM(1,1),CS(1,1,11))
C
      COMMON /H2O/ NP,LM,IM,LMP1,LS,IMNP,IMLMP1,H1P,H0P,H1P5,HP5
     *,IMLM,IMNPNP,NPP1,IMNPP1,NTM1,DTB,DTBINV,PR(2),OZONE,DUM
C
      LOGICAL OZONE
C
      PARAMETER (
     *     H9P8 =-9.79E0,    H27P =-27.0E0,    HP61=6.15384615E-1,
     *     H15P1 =15.1E0,    H3P1 =-3.1E0,     HP9 =0.9E0,
     *     HP04 =-0.04E0,    H16P =16.0E0,     H6P7 =-6.7E0,
     *     H1013 =1013.25E0, H1381 =1381.12E0, HP88 =0.8796E0,
     *     HP677 =6.7675E-1, H4P4 =-4.398E0,   HP38=3.84615384E-1)
C
      INTEGER ISYS,I,I1X,I2X,I3X
      REAL TMP,V,TMP1X,V1X,TMP2X,V2X,TMP3X,V3X
      PARAMETER (ISYS = 1)
      DO 1000 IP=INDX1,INDX2
C
      IF (INDX1 .EQ. INDX2) THEN
C
      IF (INDX2 .EQ. 1) THEN
C
!$OMP PARALLEL DO
      DO 88890 IQ2W6E=1,IMLMP1
         X1(IQ2W6E,1)=ABS(UBAR(IQ2W6E,2))
         X2(IQ2W6E,1)=ABS(VBAR(IQ2W6E,2))
         X3(IQ2W6E,1)=ABS(WBAR(IQ2W6E,2))
         ADEL(IQ2W6E,1)=ABS(TAI(IQ2W6E,2))
         BDEL(IQ2W6E,1)=ABS(CH(IQ2W6E,2))
88890 CONTINUE
C
      ELSE
C
!$OMP PARALLEL DO
      DO 50 IX=1,LMP1
      DO 88940 IQ2W6E=1,IM
         X1(IQ2W6E,IX)=UBAR(IQ2W6E,NP)-UBAR(IQ2W6E,IX)
         X2(IQ2W6E,IX)=VBAR(IQ2W6E,NP)-VBAR(IQ2W6E,IX)
         X3(IQ2W6E,IX)=WBAR(IQ2W6E,NP)-WBAR(IQ2W6E,IX)
         ADEL(IQ2W6E,IX)=TAI(IQ2W6E,NP)-TAI(IQ2W6E,IX)
         BDEL(IQ2W6E,IX)=CH(IQ2W6E,NP)-CH(IQ2W6E,IX)
88940 CONTINUE
C
      IF (OZONE) THEN
C
      DO 88990 IQ2W6E=1,IM
         WDEL(IQ2W6E,IX)=FLUXU(IQ2W6E,NP)-FLUXU(IQ2W6E,IX)
         FW(IQ2W6E,IX)=FLUXD(IQ2W6E,NP)-FLUXD(IQ2W6E,IX)
88990 CONTINUE
C
      	END IF
   50 CONTINUE
C
!$OMP PARALLEL DO
      DO 89010 IQ2W6E=1,IMLMP1
         X1(IQ2W6E,1)=ABS(X1(IQ2W6E,1))
         X2(IQ2W6E,1)=ABS(X2(IQ2W6E,1))
         X3(IQ2W6E,1)=ABS(X3(IQ2W6E,1))
         ADEL(IQ2W6E,1)=ABS(ADEL(IQ2W6E,1))
         BDEL(IQ2W6E,1)=ABS(BDEL(IQ2W6E,1))
89010 CONTINUE
C
      IF (OZONE) THEN
C
!$OMP PARALLEL DO
      DO 89060 IQ2W6E=1,IMLMP1
         WDEL(IQ2W6E,1)=ABS(WDEL(IQ2W6E,1))
         FW(IQ2W6E,1)=ABS(FW(IQ2W6E,1))
89060 CONTINUE
C
      	END IF
   60 CONTINUE
C
      END IF
C
      IMTN = IMLMP1
C
      ELSE
C
      IF (INDX2 .EQ. NP) THEN
C
      IP1 = IP
      N   = IP - 1
      I0  = 0
      I1  = 1
      I2  = 2
C
      ELSE
C
      IP1 = NP - IP
      N   = IP1
      I0  = IP
      I1  = 0
      I2  = 0
C
      END IF
C
!$OMP PARALLEL DO
      DO 100 IX=INDX1,IP1
      DO 89080 IQ2W6E=1,IM
         X1(IQ2W6E,IX-I1)=UBAR(IQ2W6E,IP)-UBARM(IQ2W6E,IX+I0)
         X2(IQ2W6E,IX-I1)=VBAR(IQ2W6E,IP)-VBARM(IQ2W6E,IX+I0)
         X3(IQ2W6E,IX-I1)=WBAR(IQ2W6E,IP)-WBARM(IQ2W6E,IX+I0)
         ADEL(IQ2W6E,IX-I1)=TAI(IQ2W6E,IP)-CSS(IQ2W6E,IX+I0)
         BDEL(IQ2W6E,IX-I1)=CH(IQ2W6E,IP)-CCU(IQ2W6E,IX+I0)
89080 CONTINUE
C
      IF (OZONE) THEN
C
      DO 89130 IQ2W6E=1,IM
         WDEL(IQ2W6E,IX-I1)=FLUXU(IQ2W6E,IP)-OZAI(IQ2W6E,IX+I0)
         FW(IQ2W6E,IX-I1)=FLUXD(IQ2W6E,IP)-PAI(IQ2W6E,IX+I0)
89130 CONTINUE
C
      END IF
  100 CONTINUE
C
      IMTN = IM * N
!$OMP PARALLEL DO
      DO 89150 IQ2W6E=1,IMTN
         X1(IQ2W6E,1)=ABS(X1(IQ2W6E,1))
         X2(IQ2W6E,1)=ABS(X2(IQ2W6E,1))
         X3(IQ2W6E,1)=ABS(X3(IQ2W6E,1))
         ADEL(IQ2W6E,1)=ABS(ADEL(IQ2W6E,1))
         BDEL(IQ2W6E,1)=ABS(BDEL(IQ2W6E,1))
89150 CONTINUE
C
      IF (OZONE) THEN
C
!$OMP PARALLEL DO
      DO 89200 IQ2W6E=1,IMTN
         WDEL(IQ2W6E,1)=ABS(WDEL(IQ2W6E,1))
         FW(IQ2W6E,1)=ABS(FW(IQ2W6E,1))
89200 CONTINUE
C
      END IF
  150 CONTINUE
C
      END IF
C
C*****  Code Expanded From Routine:  RDEXP83
cibm  DO 77002 I = 1, IMTN
cibm     YW(I,1) = X1(I,1)**0.830078125
77002 CONTINUE
      CALL VSLOG(YW,X1,IMTN)
      CALL SSCAL(IMTN,0.830078125,YW,1)
      CALL VSEXP(YW,YW,IMTN)
C*****  End of Code Expanded From Routine:  RDEXP83
C*****  Code Expanded From Routine:  RDEXP6
cibm  DO 77004 I1X = 1, IMTN
CB       VECT ( I ) = ARRAY ( I ) ** 0.568359375
cibm     WW(I1X,1) = X3(I1X,1)**0.599609375
77004 CONTINUE
      CALL VSLOG(WW,X3,IMTN)
      CALL SSCAL(IMTN,0.599609375,WW,1)
      CALL VSEXP(WW,WW,IMTN)
C*****  End of Code Expanded From Routine:  RDEXP6
!$OMP PARALLEL DO
      DO 89230 IQ2W6E=1,IMTN
         FU(IQ2W6E,1)=H9P8*X1(IQ2W6E,1)
         WW(IQ2W6E,1)=H27P*YW(IQ2W6E,1)+
     *   H6P7*X3(IQ2W6E,1)/
     *   (H1P+H16P*WW(IQ2W6E,1))
89230 CONTINUE
C*****  Code Expanded From Routine:  RDEXP56
cibm  DO 77006 I2X = 1, IMTN
cibm     YW(I2X,1) = ADEL(I2X,1)**0.560546875
77006 CONTINUE
      CALL VSLOG(YW,ADEL,IMTN)
      CALL SSCAL(IMTN,0.560546875,YW,1)
      CALL VSEXP(YW,YW,IMTN)
C*****  End of Code Expanded From Routine:  RDEXP56
!$OMP PARALLEL DO
      DO 89260 IQ2W6E=1,IMTN
         YV(IQ2W6E,1)=WW(IQ2W6E,1)+
     *                H3P1*ADEL(IQ2W6E,1)/
     *               ( H1P+H15P1*YW(IQ2W6E,1))
89260 CONTINUE
C*****  Code Expanded From Routine:  RDEXP57
cibm  DO 77008 I3X = 1, IMTN
cibm     YW(I3X,1) = BDEL(I3X,1)**0.57031250
77008 CONTINUE
      CALL VSLOG(YW,BDEL,IMTN)
      CALL SSCAL(IMTN,0.57031250,YW,1)
      CALL VSEXP(YW,YW,IMTN)
C*****  End of Code Expanded From Routine:  RDEXP57
!$OMP PARALLEL DO
      DO 89290 IQ2W6E=1,IMTN
         WV(IQ2W6E,1)=WW(IQ2W6E,1)+
     *                HP04*BDEL(IQ2W6E,1)/
     *               ( H1P+HP9*YW(IQ2W6E,1))
89290 CONTINUE
C
      IF (OZONE) THEN
C
!$OMP PARALLEL DO
      DO 89320 IQ2W6E=1,IMTN
         FWX         =FW(IQ2W6E,1)/(WDEL(IQ2W6E,1)*H1013)
         ZVX         =H1381*WDEL(IQ2W6E,1)/(HP88*FWX         )
C
         FW(IQ2W6E,1)=H1P-HP677*(H1P-
     *                EXP(H4P4*FWX         *
     *                (SQRT(H1P+ZVX         )-H1P)))
89320 CONTINUE
C
      ELSE
C
!$OMP PARALLEL DO
      DO 89380 IQ2W6E=1,IMTN
         FW(IQ2W6E,1)=H1P
89380 CONTINUE
C
      END IF
C
C
      CALL VSEXP(ADEL,YV,IMTN)
      CALL VSEXP(BDEL,WV,IMTN)
      CALL VSEXP(WDEL,FU,IMTN)
      CALL VSSQRT(YW,X2,IMTN)
      CALL VSSQRT(ZW,X3,IMTN)
!$OMP PARALLEL DO
      DO 5991 IQ2W6E = 1, IMTN
cibm     ADEL(IQ2W6E,1) = EXP(YV(IQ2W6E,1))
cibm     BDEL(IQ2W6E,1) = EXP(WV(IQ2W6E,1))
cibm     WDEL(IQ2W6E,1) = EXP(FU(IQ2W6E,1))
cibm     YW(IQ2W6E,1) = SQRT(X2(IQ2W6E,1))
cibm     ZW(IQ2W6E,1) = SQRT(X3(IQ2W6E,1))
         WW(IQ2W6E,1) = AMAX1(((H1P+32.2095E0*X1(IQ2W6E,1))/(H1P+52.85E0
     1      *X1(IQ2W6E,1))+(0.534874E0+199.0E0*X1(IQ2W6E,1)-1990.63E0*X1
     2      (IQ2W6E,1)*X1(IQ2W6E,1))*ZW(IQ2W6E,1)/(H1P+333.244E0*X1(
     3      IQ2W6E,1)))/((H1P+74.144E0*X1(IQ2W6E,1))/(0.43368E0+
     4      24.7442E0*X1(IQ2W6E,1))*ZW(IQ2W6E,1)+H1P),H0P)
C
         WV(IQ2W6E,1) = AMAX1(H1P/(H1P+9.22411E0*YW(IQ2W6E,1)+33.1236E0*
     1      X2(IQ2W6E,1)+176.396E0*X2(IQ2W6E,1)*X2(IQ2W6E,1)),H0P)
         X1(IQ2W6E,1) = AMIN1(0.06E0,X1(IQ2W6E,1))
         X2(IQ2W6E,1) = AMIN1(2.0E0,X2(IQ2W6E,1))
         X3(IQ2W6E,1) = AMIN1(8.0E0,X3(IQ2W6E,1))
         YW(IQ2W6E,1) = SQRT(X2(IQ2W6E,1))
         ZW(IQ2W6E,1) = SQRT(X3(IQ2W6E,1))
         FU(IQ2W6E,1) = X1(IQ2W6E,1)*X1(IQ2W6E,1)
         YV(IQ2W6E,1) = (0.0851069E0*YW(IQ2W6E,1)-0.187096E0*X2(IQ2W6E,1
     1      )*YW(IQ2W6E,1)+0.323105E0*X2(IQ2W6E,1))*0.1E0
         ZV(IQ2W6E,1) = (0.239186E0*X2(IQ2W6E,1)-0.0922289E0*X2(IQ2W6E,1
     1      )*YW(IQ2W6E,1)-0.0167413E0*X2(IQ2W6E,1)*X2(IQ2W6E,1))*1.0E-3
 5991 CONTINUE
C
!$OMP PARALLEL DO
      DO 89550 IQ2W6E = 1, IMTN
         YW(IQ2W6E,1) = ((5.6383E-4+1.05173E0*X1(IQ2W6E,1)-39.0722E0*FU(
     1      IQ2W6E,1))/(H1P+202.357E0*X1(IQ2W6E,1))+(0.0779555E0+
     2      4.40720E0*X1(IQ2W6E,1)+3.15851E0*FU(IQ2W6E,1))*ZW(IQ2W6E,1)/
     3      (H1P+40.2298E0*X1(IQ2W6E,1))+(-0.0381305E0-3.63684E0*X1(
     4      IQ2W6E,1)+7.98951E0*FU(IQ2W6E,1))*X3(IQ2W6E,1)/(H1P+
     5      62.5692E0*X1(IQ2W6E,1))+(6.21039E-3+0.710061E0*X1(IQ2W6E,1)-
     6      2.85241E0*FU(IQ2W6E,1))*X3(IQ2W6E,1)/(H1P+70.2912E0*X1(
     7      IQ2W6E,1))*ZW(IQ2W6E,1))*0.1E0
         ZW(IQ2W6E,1) = ((-2.99542E-4+0.238219E0*X1(IQ2W6E,1)+0.519264E0
     1      *FU(IQ2W6E,1))/(H1P+10.7775E0*X1(IQ2W6E,1))+(-2.91325E-2-
     2      2.30007E0*X1(IQ2W6E,1)+10.946E0*FU(IQ2W6E,1))*ZW(IQ2W6E,1)/(
     3      H1P+63.519E0*X1(IQ2W6E,1))+(1.43812E-2+1.80265E0*X1(IQ2W6E,1
     4      )-10.1311E0*FU(IQ2W6E,1))*X3(IQ2W6E,1)/(H1P+98.4758E0*X1(
     5      IQ2W6E,1))+(-2.39016E-3-3.71427E-1*X1(IQ2W6E,1)+2.35443E0*FU
     6      (IQ2W6E,1))*X3(IQ2W6E,1)/(H1P+120.228E0*X1(IQ2W6E,1))*ZW(
     7      IQ2W6E,1))*1.0E-3
89550 CONTINUE
C
      IF (INDX1 .EQ. INDX2) THEN
C
!$OMP PARALLEL DO
      DO 89590 IQ2W6E=1,IMLMP1
         ADEL(IQ2W6E,1)=HP38*ADEL(IQ2W6E,1)+HP61*BDEL(IQ2W6E,1)
         FW(IQ2W6E,1)=FW(IQ2W6E,1)*WDEL(IQ2W6E,1)
89590 CONTINUE
C
      IF (INDX2 .EQ. 1) THEN
C
!$OMP PARALLEL DO
      DO 200 IX=2,NP
      DO 89610 IQ2W6E=1,IM
         X1(IQ2W6E,IX)=WV(IQ2W6E,IX-1)*TV1(IQ2W6E,1)
         X2(IQ2W6E,IX)=YV(IQ2W6E,IX-1)*TUI(IQ2W6E,1)+H1P+ZV(IQ2W6E,IX-
     *   1)*TUI2(IQ2W6E,1)
         X3(IQ2W6E,IX)=WW(IQ2W6E,IX-1)*TV2(IQ2W6E,1)
         X4(IQ2W6E,IX)=YW(IQ2W6E,IX-1)*TUI(IQ2W6E,1)+H1P+ZW(IQ2W6E,IX-
     *   1)*TUI2(IQ2W6E,1)
         FW(IQ2W6E,IX-1)=ADEL(IQ2W6E,IX-1)*CC(IQ2W6E,1)+FW(IQ2W6E,IX-1
     *   )*RAWI(IQ2W6E,1)
89610 CONTINUE
  200 CONTINUE
C
!$OMP PARALLEL DO
      DO 89660 IQ2W6E=1,IMLMP1
         SHI(IQ2W6E,2)=X1(IQ2W6E,2)*X2(IQ2W6E,2)+X3(IQ2W6E,2)*X4(
     *   IQ2W6E,2)+FW(IQ2W6E,1)
89660 CONTINUE
C
      ELSE
C
!$OMP PARALLEL DO
      DO 300 IX=1,LMP1
      DO 89670 IQ2W6E=1,IM
         X1(IQ2W6E,IX)=WV(IQ2W6E,IX)*TV1(IQ2W6E,NPP1)*(YV(IQ2W6E,IX)*T
     *   UI(IQ2W6E,NPP1)+H1P+ZV(IQ2W6E,IX)*TUI2(IQ2W6E,NPP1))
         X2(IQ2W6E,IX)=WW(IQ2W6E,IX)*TV2(IQ2W6E,NPP1)*(YW(IQ2W6E,IX)*T
     *   UI(IQ2W6E,NPP1)+H1P+ZW(IQ2W6E,IX)*TUI2(IQ2W6E,NPP1))
         X3(IQ2W6E,IX)=WV(IQ2W6E,IX)*TV1(IQ2W6E,NP)*(YV(IQ2W6E,IX)*TUI
     *   (IQ2W6E,NP)+H1P+ZV(IQ2W6E,IX)*TUI2(IQ2W6E,NP))
         X4(IQ2W6E,IX)=WW(IQ2W6E,IX)*TV2(IQ2W6E,NP)*(YW(IQ2W6E,IX)*TUI
     *   (IQ2W6E,NP)+H1P+ZW(IQ2W6E,IX)*TUI2(IQ2W6E,NP))
89670 CONTINUE
  300 CONTINUE
C
!$OMP PARALLEL DO
      DO 350 IX=1,LMP1
      DO 89710 IQ2W6E=1,IM
         SHU(IQ2W6E,IX)=(CC(IQ2W6E,NPP1)-CC(IQ2W6E,NP))*ADEL(IQ2W6E,IX
     *   )+(RAWI(IQ2W6E,NPP1)-RAWI(IQ2W6E,NP))*FW(IQ2W6E,IX)
89710 CONTINUE
  350 CONTINUE
C
!$OMP PARALLEL DO
      DO 89720 IQ2W6E=1,IMLMP1
         SHU(IQ2W6E,1)=X1(IQ2W6E,1)+X2(IQ2W6E,1)-X3(IQ2W6E,1)-X4(
     *   IQ2W6E,1)+SHU(IQ2W6E,1)
89720 CONTINUE
C
      END IF
C
      ELSE
C
!$OMP PARALLEL DO
      DO 89730 IQ2W6E = 1, IMTN
         X1(IQ2W6E,1) = WV(IQ2W6E,1)*TV1(IQ2W6E,I0+1)*(YV(IQ2W6E,1)*TUI(
     1      IQ2W6E,I0+1)+H1P+ZV(IQ2W6E,1)*TUI2(IQ2W6E,I0+1))
         X2(IQ2W6E,1) = WW(IQ2W6E,1)*TV2(IQ2W6E,I0+1)*(YW(IQ2W6E,1)*TUI(
     1      IQ2W6E,I0+1)+H1P+ZW(IQ2W6E,1)*TUI2(IQ2W6E,I0+1))
         X3(IQ2W6E,1) = WV(IQ2W6E,1)*TV1(IQ2W6E,I0+I2)*(YV(IQ2W6E,1)*TUI
     1      (IQ2W6E,I0+I2)+H1P+ZV(IQ2W6E,1)*TUI2(IQ2W6E,I0+I2))
         X4(IQ2W6E,1) = WW(IQ2W6E,1)*TV2(IQ2W6E,I0+I2)*(YW(IQ2W6E,1)*TUI
     1      (IQ2W6E,I0+I2)+H1P+ZW(IQ2W6E,1)*TUI2(IQ2W6E,I0+I2))
         TXUF(IQ2W6E,I0+1,IP) = X1(IQ2W6E,1) + X2(IQ2W6E,1) - X3(IQ2W6E,
     1      1) - X4(IQ2W6E,1) + (CC(IQ2W6E,I0+1)-CC(IQ2W6E,I0+I2))*(
     2      3.84615384E-1*ADEL(IQ2W6E,1)+6.15384615E-1*BDEL(IQ2W6E,1))
     3       + (RAWI(IQ2W6E,I0+1)-RAWI(IQ2W6E,I0+I2))*FW(IQ2W6E,1)*WDEL(
     4      IQ2W6E,1)
89730 CONTINUE
C
      END IF
C
1000  CONTINUE
C
      RETURN
      END
      subroutine SSCAL(IMTN,x,YW,ii)
      real yw(imtn)
      do i = 1, imtn
         yw(i) = yw(i) * x
      end do
      return
      end
