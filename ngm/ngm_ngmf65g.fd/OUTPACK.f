      SUBROUTINE OUTPACK (FIELD, IJOUT, PACKED, DDESCRIP, LABEL84,
     1                    IOUTUNIT)
C$$$  SUBPROGRAM  DOCUMENTATION  BLOCK
C
C SUBPROGRAM:    OUTPACK      PACK INTO ON84 FORMAT AND WRITE TO DISK
C   PRGMMR: J. TUCCILLO       ORG: W/NMC4     DATE: 90-10-30
C
C ABSTRACT:  CREATE AND WRITE A ON84 RECORD TO DISK
C
C PROGRAM HISTORY LOG:
C   90-10-30  JIM TUCCILLO
C   98-09-14  HANN-MING HENRY JUANG for Y2K
C
C USAGE:  CALL OUTPACK (FIELD, IJOUT,  PACKED, DDESCRIP,
C                       LABEL84, IOUTUNIT)
C   INPUT ARGUMENT LIST:
C     FIELD    - THE FIELD TO BE PACKED WITH LENGTH OF IJOUT.
C     IJOUT    - THE LENGTH OF THE FIELD TO BE PACKED.
C     PACKED   - SCRATCH SPACE WITH LENGTH AT LEAST IJOUT.
C     DDESCRIP - A 20-CHARACTER DESCRIPTION OF THE FIELD
C                      TO BE PACKED.
C     LABEL84  - ARRAY OF THE 27 PARAMETERS SPECIFIED IN A
C                LABEL
C
C   OUTPUT FILES:
C     IOUTUNIT - UNIT TO WHICH THE ON84 FIELD IS WRITTEN
C
C   SUBPROGRAMS CALLED:
C     UNIQUE:    - PARITY
C     LIBRARY:
C       COMMON   - COMPARIT
C       W3LIB    - W3FP06 W3YMDH4 W3FI32 W3AI00
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN
C   MACHINE:  CRAY Y-MP
C
C$$$
C
      COMMON /COMPARIT/ IPARITY, KOUNTPAR
C
      CHARACTER*20 DDESCRIP
      CHARACTER*48 LAB84PAK
      DIMENSION FIELD(1), LABEL84(27)
      DIMENSION LABPAK(6)
      CHARACTER*4 PACKED(1), TITLE(82)
      CHARACTER*1 KBUF ( 48+2*IJOUT )
      DIMENSION IFLD ( IJOUT )
      CHARACTER*1 PDS ( 28 )
 
      LOGICAL DEBUG
C
      EQUIVALENCE ( LABPAK(1), LAB84PAK )
C
      DATA KOUNT /0/
      DATA DEBUG / .TRUE. /
cibm  DATA DEBUG / .FALSE. /
C
      IF (KOUNT .EQ. 0) THEN
         KOUNT    = 1
         IPARITY  = 0
         KOUNTPAR = 0
      END IF
C
      KOUNTPAR   = KOUNTPAR + 1
C
C              INCREMENT THE PARITY COUNTER.
      CALL PARITY (FIELD, IJOUT, PACKED, IPARITY)
C
CHMHJ --------------------------------------------------- 
C          SAVE THE DATE TO HAVE FULL DIGITS OF YEAR
C          PACK AS USUAL WITH TWO DIGITS OF YEAR
C          THEN RESTORE FULL DIGIT OF YEAR AND REPACK
      IYR4=LABEL84(21)
      LABEL84(21)=MOD(LABEL84(21),100)
      CALL W3FI32 (LABEL84, LAB84PAK)
      LABEL84(21)=IYR4
C ------------------------------------------------------ HMHJ 
      CALL W3FP06 (LAB84PAK, TITLE, 1)
      IF ( DEBUG ) THEN
          WRITE (6, 300) DDESCRIP, (TITLE(L), L=1, 18)
  300     FORMAT (' ', A20, / , 18A4)
      END IF
C
C     DO OFFICE NOTE 84 PACKING
C
      CALL W3AI00 (FIELD, PACKED, LAB84PAK)
      LENGTH = 12 + (IJOUT + 1) / 2
      WRITE (IOUTUNIT) (PACKED(I), I=1, LENGTH)
C
      RETURN
      END
