      SUBROUTINE OUTCLOSE (DATASET1, IOUTUOUT, DISPNAME,
     1                     IRUNMARK, IOUTUPRT, ITIME, NSTEPS)
C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C                .      .    .                                       .
C SUBPROGRAM:    OUTCLOSE    ENDS OUTPUT FILE AND DISPOSES TO FRONT END
C   PRGMMR: JIM TUCCILLO     ORG: W/NMC4     DATE: 90-06-19
C
C ABSTRACT: ENDS THE POSTPROCESSED OUTPUT FILE AND
C           DISPOSES THE FILE TO THE FRONTEND
C
C PROGRAM HISTORY LOG:
C   90-06-22  JIM TUCCILLO
C
C USAGE:    CALL OUTCLOSE (DATASET1, IOUTUOUT, DISPNAME,
C                          IRUNMARK, IOUTUPRT, ITIME, NSTEPS)
C   INPUT ARGUMENT LIST:
C     DATASET1 - NAME OF THE PROCESSED OUTPUT FILE
C     IOUTUOUT - UNIT NUMBER OF THE PROCESSED OUTPUT FILE
C     DISPNAME - NAME OF FRONT END DATASET TO RECEIVE DATA
C     IRUNMARK - VARIABLE THAT DESCRIBES THE TYPE OF JOB
C                =2; MEANS IT IS AN OPERATIONAL JOB
C     IOUTUPRT - UNIT NUMBER OF THE OUTPUT PRINT FILE
C     ITIME    - MODEL TIME IN SECONDS WHEN THE POSTPROCESSING
C                IS BEING DONE
C     NSTEPS   - NUMBER OF MODEL TIME STEPS AT WHICH THE POST
C                IS BEING RUN
C
C   OUTPUT FILES:
C     IOUTUOUT - THE PROCESSED OUTPUT FILE
C     IOUTUPRT - FOR PRINTOUT
C
C   SUBPROGRAMS CALLED:
C     UNIQUE:
C     LIBRARY:
C       COMMON   - COMPARIT
C
C REMARKS:
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN
C   MACHINE:  CRAY Y-MP
C
C$$$
C
C     COMMON BLOCK /COMPARIT/ CONTAINS QUANTITIES ASSOCIATED WITH
C          PARITY CHECKING.
      COMMON /COMPARIT/ IPARITY, KOUNTPAR
C
      CHARACTER*6  DATASET1
      CHARACTER*39 DISPNAME
      CHARACTER*1  DISPNL ( 39 )
      CHARACTER*39 DISPNLE
      CHARACTER*100 DISPOSE
      CHARACTER*65  AFORMAT
      CHARACTER*1 DISPOSEA(100)
      CHARACTER*3 AFORM
C
      EQUIVALENCE ( DISPOSE, DISPOSEA )
      EQUIVALENCE ( DISPNL, DISPNLE )
C
C              IF THIS IS AN OPERATIONAL JOB
C               DISPOSE TO THE FRONT-END
C
      CLOSE(IOUTUOUT)
      IF ( 1 .EQ. 2 ) THEN
      IF (IRUNMARK .EQ. 2) THEN
         DISPNLE = DISPNAME
         DO 100 I = 1, 100
            DISPOSEA(I) = ' '
100      CONTINUE
         ICNUM = 0
         DO 56 I = 1, 39
            IF ( DISPNL(I) .EQ. ' ' ) GOTO 57
            ICNUM = ICNUM + 1
56       CONTINUE
57       CONTINUE
         IF ( ICNUM .EQ. 0 ) THEN
            PRINT 3882
3882        FORMAT(' *** THERE IS NO FILE TO DISPOSE')
            RETURN
         END IF
         WRITE(AFORM,497) ICNUM
497      FORMAT('A',I2)
         WRITE(AFORMAT,499)  AFORM
         WRITE(DISPOSE,AFORMAT)  DATASET1, DISPNAME
         ISTAT =ISHELL(DISPOSE)
         PRINT 498, ISTAT, DATASET1
498      FORMAT(' ISTAT = ',2X,I4,' FOR DATASET =',2X,A6)
499      FORMAT('("dispose ",A6," -mvs -fTB -t''dsn=",',A3,
     *          ',",dcb=lrecl=x,disp=shr''")')
      END IF
      END IF
C
C              PRINT THE FACT THAT WE ARE DONE POSTPROCESSING
C              THIS OUTPUT FILE.
C
      TIMEHRS = FLOAT(ITIME) / 3600.0E0
C
      WRITE (IOUTUPRT, 500) NSTEPS, ITIME, TIMEHRS,
     1                      DATASET1,
     2                      IOUTUOUT, KOUNTPAR, IPARITY
C
  500       FORMAT('0', 'FOR NSTEPS =', I5,
     1                  ', ITIME =', I8, ' S, TIMEHRS =',
     2                  F8.4, ' H AFTER I.C.:' /
     3             ' ', 4X, 'DATA SET ', A6,
     4                  ' WAS CLOSED ON OUTPUT UNIT',
     5                  I3,  ' AFTER POSTPROCESSING.',
     6                  '  TOTAL NO. OF PACKED FIELDS =', I5,
     7                  ',  PARITY CHECK =', I8, '.')
C
C
      RETURN
      END
