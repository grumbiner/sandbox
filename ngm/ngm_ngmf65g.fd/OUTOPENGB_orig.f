      SUBROUTINE OUTOPENGB (ITUOUT, DATSET, ITUPRT)
C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C                .      .    .                                       .
C SUBPROGRAM:    OUTOPENGB        ASSIGNS AND OPENS UNIT FOR GRIB FILE
C   PRGMMR: RUSS TREADON          ORG: W/NMC22    DATE: 93-12-21
C
C ABSTRACT:  INTERNALLY ASSIGNS AND OPENS A UNIT TO RECEIVE GRIB DATA
C
C PROGRAM HISTORY LOG:
C   93-12-21  RUSS TREADON - CODED ROUTINE BASED ON SUBROUTINE OUTOPEN
C
C USAGE:    CALL OUTOPENGB (ITUOUT, DATSET, ITUPRT)
C   INPUT ARGUMENT LIST:
C     ITUOUT   - UNIT NUMBER OF THE DISK THAT THE GRIB DATA
C                IS BEING WRITTEN
C     DATSET   - DATA SET NAME
C     ITUPRT   - UNIT TO RECEIVE RUN-TIME MESSAGES
C
C   OUTPUT FILES:
C     ITUOUT   - UNIT FOR OUTPUT DATA SET THAT THIS ROUTINE
C                IS WRITING GRIB TO
C     ITUPRT   - STANDARD OUT
C
C   SUBPROGRAMS CALLED:
C     LIBRARY:
C
C ATTRIBUTES:
C   LANGUAGE: STANDARD FORTRAN
C   MACHINE:
C
C$$$
C
C
      CHARACTER*6  DATSET
      CHARACTER*8  NMCGR
      CHARACTER*9  NMCGRI
      CHARACTER*50 ENVAR
      CHARACTER*61 FILGRB, filgrbi
      common /comgrb/ filgrb, filgrbi
C
C
C
C     INITIALIZE GRIB1 DECIMAL SCALINGS.
c     CALL IDSDEF(1,IDS)
C
C     SET STANDARD NMC GRIB DATA FILE NAME.
C
c     K = INDEX(DATSET,' ') - 1
c     IF (K.LE.0) K = LEN(DATSET)	
c     NMCGR = DATSET(1:K) // '.PGRB'
      NMCGR = 'pgrb.f' // DATSET(3:4)
      NMCGRI = 'pgrbi.f' // DATSET(3:4)
C     
C     CONSTRUCT FULL PATH-FILENAME TO OUTPUT GRIB FILE.
C     THE PATH IS SET IN ENVIRONEMNT VARIABLE COMSP WHICH
C     IS SET IN THE SCRIPT RUNNING THE NGM. 
      ENVAR = ' '
      CALL GETENV ("COMSP",ENVAR)
      K = INDEX(ENVAR,' ') - 1
      IF (K.LE.0) K = LEN(ENVAR)
      FILGRB = ENVAR(1:K) // NMCGR
      FILGRBI = ENVAR(1:K) // NMCGRI
C
C     ASSIGN AND OPEN UNIT FOR GRIB DATA FILE.
C     
C     ***WARNING*** THE ATTRIBUTE '-s unblocked' MUST BE IN LOWER CASE!!!
C
      CLOSE(ITUOUT)
      CALL ASNUNIT(ITUOUT,'-s unblocked',IER)
      IF (IER.NE.0) WRITE(ITUPRT,*)
     X     'OUTOPENGB:  ASNUNIT ERROR FOR GRIB DATA ',
     X     'FILE.  IER=',IER
      OPEN(ITUOUT,FILE=FILGRB,FORM='UNFORMATTED')
      REWIND(ITUOUT)
C     
C     ECHO MESSAGE TO ITUPRT.
C
      WRITE(ITUPRT,*)'GRIBIT:  OPENED ',ITUOUT,
     X     ' FOR GRIB DATA ',FILGRB
C
      RETURN
      END
