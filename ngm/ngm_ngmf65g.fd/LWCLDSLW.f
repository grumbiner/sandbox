      SUBROUTINE LWCLDSLW
C
C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C
C SUBPROGRAM:   LWCLDSLW     COMPUTES A PORTION OF THE LW RAD.
C   PRGMMR: J TUCCILLO       ORG: W/NMC22    DATE: 90-06-13
C
C ABSTRACT: COMPUTES A PORTION OF THE LW RADIATION
C   .
C
C PROGRAM HISTORY LOG:
C   90-06-13  J TUCCILLO
C
C USAGE:  CALL LWCLDSLW
C   SUBPROGRAM CALLED:
C     LIBRARY:
C       COMMON  - H2O
C                 BLANK
C
C REMARKS:
C   .
C   - - - - - - - - I N P U T   V A R I A B L E S  - - - - - - - - -
C   .
C   NAMES       MEANING/CONTENT/PURPOSE/UNITS/TYPE        INTERFACE
C   -----       ----------------------------------        ---------
C   .
C   INFORMATION COMMUNICATED THROUGH COMMON
C   .
C   - - - - - - - - O U T P U T   V A R I A B L E S - - - - - - - - - -
C   .
C   NAMES       MEANING/CONTENT/PURPOSE/UNITS/TYPE        INTERFACE
C   -----       ----------------------------------        ---------
C   .
C   INFORMATION COMMUNICATED THROUGH COMMON
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN
C   MACHINE:  CRAY Y-MP
C
C$$$
C
      INCLUDE 'parmodel'
C
      PARAMETER (NIM= IIJRAD, NJM=46, NLM= IKM, NLS=02)
      PARAMETER (NNQFDS=5, NOFDS=2, NQIFDS=5, NOIFDS=8
     *,      NNQP3=21, NNQP2=59, N2DFDS=29, NEQO3O=01)
      PARAMETER (NIMP1=NIM+1,NIMP2=NIM+2,NIMP3=NIM+3,NIMD2=NIM/2+1/NIM
     *,     NLMM2=NLM-2, NLSP1=NLS+1, LMM1T2=(NLM-1)*2
     *,     IMD2P1=NIM/2+1, NJMM2=NJM-2, NLMP1=NLM+1, NLMM1=NLM-1
     *,     N1=NLM*NQIFDS+NOIFDS
     *,     N2=NLM*NNQFDS+NOFDS, N3=NIMP2*N2
     *,     NIMT2=NIM*2,N6=NIMP2*N1,NILPT=NIM*NLM
     *,     NNQPFD = NNQP3 + (NNQP2-1)/NLM + 1
     *,     NN5= NNQP3+ (NNQP2+(N2DFDS*NIM-1)/NIMP2)/NLM + 3
     *,     NN6 = NN5*NLM,NN1 = N1 - 1
     *,     N5= NIMP2*NN6, NTDSG =NLM-NLSP1
     *,     NNBITX=NIMP2*NLM
     *,     NPG=(NN1*NIMP2*NJMM2-1)/131072 + 1
     *,     N55=N5-2*NLM*NIMP2
     *,     NTL=(N55*NJMM2-1)/131072 + 1)
C
      PARAMETER (NNP=NLM+2, NNPP1=NNP+1, NNPBIT=NIM*NNPP1)
C...TRANSLATED BY FPP 3.00Z36 11/09/90  14:48:16  
C...SWITCHES: OPTON=I47,OPTOFF=VAE0
C
      COMMON  TXUF(NIM,NNP,NNP),CS(NIM,NNP,NNP)
     *,X1(NIM,NNPP1),X2(NIM,NNPP1),TV1(NIM,NNPP1),DP(NIM,NNP)
     *,CSS(NIM,NNP),CCU(NIM,NNP),CH(NIM,NNP),WDEL(NIM,NLMP1)
     *,ZW(NIM,NLMP1),IT(NIM,NNPP1),X4(NIM,NNP),X3(NIM,NNP)
     *,CC(NIM,NNPP1),TV2(NIM,NNPP1),TUI2(NIM,NNPP1),SHI(NIM,NNP)
     *,RAWI(NIM,NNPP1),WV(NIM,NLMP1),YV(NIM,NLMP1),TUI(NIM,NNPP1)
     *,ZV(NIM,NLMP1),WW(NIM,NLMP1),YW(NIM,NLMP1),SHU(NIM,NLMP1)
     *,SHH(NIM,NNP),SUM(NIM),FU(NIM,NLMP1),FW(NIM,NLMP1)
     *,ADEL(NIM,NLMP1),BDEL(NIM,NLMP1),SUMSAV(NIM)
C
      COMMON /H2O/ NP,LM,IM,LMP1,LS,IMNP,IMLMP1,H1P,H0P,H1P5,HP5
     *,IMLM,IMNPNP,NPP1,IMNPP1,NTM1,DTB,DTBINV,PR(2),OZONE,DUM
C
      LOGICAL OZONE
C
CMIC$ PARALLEL SHARED(IMNPNP, H1P, CS, IMNP, CH, CC, X1, X2, X3)
CMIC$1    PRIVATE(IQ2)
CMIC$ DO PARALLEL VECTOR
      DO 88890 IQ2=1,IMNP
         CH(IQ2,1)=H1P
         CC(IQ2,1)=H1P
         X1(IQ2,1)=H1P
         X2(IQ2,1)=H1P
         X3(IQ2,1)=H1P
88890 CONTINUE
CMIC$ DO PARALLEL VECTOR
      DO 88940 IQ2=1,IMNPNP
         CS(IQ2,1,1)=H1P
88940 CONTINUE
C
CMIC$ END PARALLEL
CMIC$ PARALLEL SHARED(IM, H1P, CCU, X1, CH, CSS, NP) PRIVATE(IQ2, IP)
      DO 20 IP=2,NP
CMIC$ DO PARALLEL VECTOR
      DO 88950 IQ2 = 1, IM
         X1(IQ2,IP) = H1P - CCU(IQ2,IP-1)
         IF (X1(IQ2,IP) .GT. X1(IQ2,IP-1)) X1(IQ2,IP) = X1(IQ2,IP-1)
         CH(IQ2,IP) = CH(IQ2,IP-1)*(H1P-CSS(IQ2,IP-1))
88950 CONTINUE
   20 CONTINUE
CMIC$ END PARALLEL
CMIC$ DO ALL VECTOR SHARED(IMLMP1, CH, X1) PRIVATE(IQ2)
      DO 88980 IQ2=1,IMLMP1
         CH(IQ2,2)=CH(IQ2,2)*X1(IQ2,2)
88980 CONTINUE
      DO 40 I=1,LMP1
      IP=NP-I
CMIC$ DO ALL VECTOR SHARED(IM, H1P, IP, CCU, X2, CC, CSS) PRIVATE(IQ2)
      DO 88990 IQ2 = 1, IM
         X2(IQ2,IP) = H1P - CCU(IQ2,IP)
         IF (X2(IQ2,IP) .GT. X2(IQ2,IP+1)) X2(IQ2,IP) = X2(IQ2,IP+1)
         CC(IQ2,IP) = CC(IQ2,IP+1)*(H1P-CSS(IQ2,IP))
88990 CONTINUE
   40 CONTINUE
CMIC$ DO ALL VECTOR SHARED(IMLMP1, CC, X2) PRIVATE(IQ2)
      DO 89020 IQ2=1,IMLMP1
         CC(IQ2,1)=CC(IQ2,1)*X2(IQ2,1)
89020 CONTINUE
      DO 70 IP=2,NP
      IPM1   = IP - 1
CMIC$ DO ALL SHARED(IPM1,IM,H1P,IP,CCU,X4,CS,CSS)PRIVATE(IX,IQ2)
      DO 60 IX=1,IPM1
      DO 89030 IQ2=1,IM
         X4(IQ2,IX)=H1P-CCU(IQ2,IP-1)
         CS(IQ2,IX,IP)=CS(IQ2,IX,IP-1)*(H1P-CSS(IQ2,IP-1))
89030 CONTINUE
   60 CONTINUE
      IF (IP.GT.2)THEN
CMIC$ DO ALL VECTOR SHARED(IMIPM1, IP, CS, X3) PRIVATE(IQ2)
      DO 89050 IQ2=1,IMIPM1
         CS(IQ2,1,IP-1)=CS(IQ2,1,IP-1)*X3(IQ2,1)
89050 CONTINUE
      END IF
      IMIPM1 = IM * IPM1
CMIC$ DO ALL VECTOR SHARED(IMIPM1, X4, X3) PRIVATE(IQ2)
      DO 89060 IQ2 = 1, IMIPM1
         IF (X4(IQ2,1) .GT. X3(IQ2,1)) X4(IQ2,1) = X3(IQ2,1)
         X3(IQ2,1) = X4(IQ2,1)
89060 CONTINUE
   70 CONTINUE
CMIC$ PARALLEL SHARED(IMNP, H1P, X3, IMIPM1, NP, CS, X4) PRIVATE(IQ2)
CMIC$ DO PARALLEL VECTOR
      DO 89080 IQ2=1,IMIPM1
         CS(IQ2,1,NP)=CS(IQ2,1,NP)*X4(IQ2,1)
89080 CONTINUE
CMIC$ DO PARALLEL VECTOR
      DO 89090 IQ2=1,IMNP
         X3(IQ2,1)=H1P
89090 CONTINUE
CMIC$ END PARALLEL
      DO 90 I=1,LMP1
      IP   = NP - I
      IPP1 = IP + 1
CMIC$ DO ALL SHARED(NP,IPP1,IM,H1P,IP,CCU,X4,CS,CSS)PRIVATE(IX,IQ2)
      DO 80 IX=IPP1,NP
      DO 89100 IQ2=1,IM
         X4(IQ2,IX)=H1P-CCU(IQ2,IP)
         CS(IQ2,IX,IP)=CS(IQ2,IX,IP+1)*(H1P-CSS(IQ2,IP))
89100 CONTINUE
   80 CONTINUE
      IF (I.GT.1)THEN
CMIC$ DO ALL VECTOR SHARED(IPNP, IP, CS, X3) PRIVATE(IQ2)
      DO 89120 IQ2=1,IPNP
         CS(IQ2,IP+2,IP+1)=CS(IQ2,IP+2,IP+1)*X3(IQ2,IP+2)
89120 CONTINUE
      END IF
      IPNP = IM * (NP - IP )
CMIC$ DO ALL VECTOR SHARED(IPNP, IPP1, X4, X3) PRIVATE(IQ2)
      DO 89130 IQ2 = 1, IPNP
         IF (X4(IQ2,IPP1) .GT. X3(IQ2,IPP1)) X4(IQ2,IPP1) = X3(IQ2,IPP1)
         X3(IQ2,IPP1) = X4(IQ2,IPP1)
89130 CONTINUE
   90 CONTINUE
CMIC$ DO ALL VECTOR SHARED(IPNP, IPP1, IP, CS, X4) PRIVATE(IQ2)
      DO 89150 IQ2=1,IPNP
         CS(IQ2,IPP1,IP)=CS(IQ2,IPP1,IP)*X4(IQ2,IPP1)
89150 CONTINUE
C
C
      RETURN
      END
